(()=>{var e={};e.id=9562,e.ids=[9562],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},7450:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>d,routeModule:()=>p,tree:()=>c});var r=s(7096),a=s(6132),i=s(7284),l=s.n(i),n=s(2564),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let c=["",{children:["properties",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,3728)),"E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\properties\\[id]\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,1604)),"E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\properties\\[id]\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,8010)),"E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\properties\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,9851)),"E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],d=["E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\properties\\[id]\\page.tsx"],m="/properties/[id]/page",x={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/properties/[id]/page",pathname:"/properties/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},1700:(e,t,s)=>{Promise.resolve().then(s.bind(s,6916))},6761:(e,t,s)=>{Promise.resolve().then(s.bind(s,8512))},6916:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>PropertyDetailLayout});var r=s(784);function PropertyDetailLayout({children:e}){return r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e})}},8512:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>PropertyDetail});var r=s(784),a=s(9885),i=s(7114),l=s(1332),n=s(2308),o=s(5105),c=s(7686);function PropertyGallery({images:e,featuredImage:t,title:s}){let[i,n]=(0,a.useState)(0),[d,m]=(0,a.useState)(!1),x=t?[t,...e.filter(e=>e!==t)]:e,p=x.length>0?x:["/api/placeholder/800/500"],handlePrevious=()=>{n(e=>0===e?p.length-1:e-1)},handleNext=()=>{n(e=>e===p.length-1?0:e+1)},toggleFullscreen=()=>{m(!d)};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("div",{className:"relative h-64 md:h-96 rounded-xl overflow-hidden bg-gray-100",children:[r.jsx("img",{src:p[i],alt:`${s} - Image ${i+1}`,className:"w-full h-full object-cover"}),r.jsx("button",{onClick:handlePrevious,className:"absolute left-4 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-80 rounded-full p-2 shadow-md hover:bg-opacity-100 transition-all","aria-label":"Previous image",children:r.jsx(o.YFh,{size:20})}),r.jsx("button",{onClick:handleNext,className:"absolute right-4 top-1/2 transform -translate-y-1/2 bg-white bg-opacity-80 rounded-full p-2 shadow-md hover:bg-opacity-100 transition-all","aria-label":"Next image",children:r.jsx(o.Tfp,{size:20})}),r.jsx("button",{onClick:toggleFullscreen,className:"absolute right-4 bottom-4 bg-white bg-opacity-80 rounded-full p-2 shadow-md hover:bg-opacity-100 transition-all","aria-label":"Toggle fullscreen",children:r.jsx(o.D7o,{size:20})}),(0,r.jsxs)("div",{className:"absolute left-4 bottom-4 bg-black bg-opacity-70 text-white px-3 py-1 rounded-full text-xs",children:[i+1," / ",p.length]})]}),p.length>1&&r.jsx("div",{className:"mt-4 flex space-x-2 overflow-x-auto py-2",children:p.map((e,t)=>r.jsx("button",{onClick:()=>n(t),className:`flex-shrink-0 h-16 w-24 rounded-md overflow-hidden border-2 transition-all ${t===i?"border-primary-500 opacity-100":"border-gray-200 opacity-70 hover:opacity-100"}`,children:r.jsx("img",{src:e,alt:`${s} - Thumbnail ${t+1}`,className:"h-full w-full object-cover"})},t))}),r.jsx(c.M,{children:d&&(0,r.jsxs)(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black bg-opacity-90 flex items-center justify-center",children:[r.jsx("button",{onClick:toggleFullscreen,className:"absolute top-4 right-4 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-70 transition-all","aria-label":"Close fullscreen",children:r.jsx(o.q5L,{size:24})}),(0,r.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:[r.jsx("img",{src:p[i],alt:`${s} - Fullscreen Image ${i+1}`,className:"max-h-full max-w-full object-contain"}),r.jsx("button",{onClick:handlePrevious,className:"absolute left-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-all text-white","aria-label":"Previous image",children:r.jsx(o.YFh,{size:24})}),r.jsx("button",{onClick:handleNext,className:"absolute right-4 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 rounded-full p-3 hover:bg-opacity-70 transition-all text-white","aria-label":"Next image",children:r.jsx(o.Tfp,{size:24})}),(0,r.jsxs)("div",{className:"absolute left-4 bottom-4 bg-black bg-opacity-70 text-white px-3 py-1 rounded-full",children:[i+1," / ",p.length]})]})]})})]})}function PropertyFeatures({features:e}){let t=e&&e.length>0?e:["Parking","Security","Air Conditioning","Balcony","Garden","Pool"];return(0,r.jsxs)("div",{className:"mb-8",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Features & Amenities"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"p-1 rounded-full bg-primary-50 text-primary-600 mr-3",children:r.jsx(o.UgA,{size:16})}),r.jsx("span",{className:"text-gray-700",children:e})]},t))})]})}function PropertyLocation({location:e}){return(0,r.jsxs)("div",{className:"mb-8",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Location"}),r.jsx("div",{className:"rounded-xl overflow-hidden",children:(0,r.jsxs)("div",{className:"bg-gray-100 h-64 flex items-center justify-center relative",children:[(0,r.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center flex-col",children:[r.jsx(o.i63,{className:"text-primary-600 mb-2",size:32}),r.jsx("p",{className:"text-gray-700 font-medium",children:e}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Map view is not available in this demo"})]}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-white bg-opacity-90 p-3",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(o.i63,{className:"text-primary-600 mr-2"}),r.jsx("span",{className:"font-medium",children:e})]})})]})})]})}var d=s(1068);async function getPropertyById(e){try{let t=await d.ZP.getPropertyById(e);return t}catch(e){return console.error("Error in getPropertyById:",e),null}}async function getSimilarProperties(e,t=3){try{let s=await d.ZP.getSimilarProperties(e.id,t);return s}catch(e){return console.error("Error in getSimilarProperties:",e),[]}}async function incrementPropertyViews(e){try{let t=getAccessToken();if(!t){console.error("No access token available");return}await d.ZP.incrementPropertyViews(e,t)}catch(e){console.error("Error in incrementPropertyViews:",e)}}s(6454);let getAccessToken=()=>null;var m=s(1440),x=s.n(m),p=s(3500);function PropertyCard({property:e,onScheduleClick:t,showMatchPercentage:s=!1}){return(0,r.jsxs)("div",{className:"bg-white overflow-hidden rounded-xl border border-gray-200 shadow-card hover-lift group transition-all",children:[(0,r.jsxs)("div",{className:"relative h-52 overflow-hidden",children:[s&&e.matchPercentage&&r.jsx("div",{className:"absolute top-2 left-2 z-10",children:(0,r.jsxs)("span",{className:"badge-success flex items-center shadow-sm",children:[r.jsx(p.qvk,{className:"mr-1 h-3 w-3"}),e.matchPercentage,"% Match"]})}),r.jsx("div",{className:"absolute top-2 right-2 z-10",children:r.jsx("span",{className:"badge bg-gray-900 bg-opacity-60 text-white px-2 py-1 text-xs rounded-md shadow-sm",children:e.property_type})}),e.image_url?r.jsx("img",{src:e.image_url,alt:e.title,className:"h-full w-full object-cover transform group-hover:scale-105 transition-transform duration-300"}):r.jsx("div",{className:"h-full w-full bg-gradient-to-br from-primary-100 to-primary-200 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(p.m17,{className:"mx-auto h-12 w-12 text-primary-400"}),r.jsx("p",{className:"mt-2 text-sm text-primary-600 font-medium",children:"No image available"})]})})]}),(0,r.jsxs)("div",{className:"p-5",children:[r.jsx("div",{className:"flex justify-between items-start",children:(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-display text-lg font-semibold text-gray-900 leading-tight line-clamp-1 group-hover:text-primary-700 transition-colors",children:e.title}),(0,r.jsxs)("p",{className:"mt-1 text-sm text-gray-600 flex items-center",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500 mr-1 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),r.jsx("span",{className:"line-clamp-1",children:e.location})]})]})}),r.jsx("div",{className:"mt-4 flex items-center justify-between",children:(0,r.jsxs)("p",{className:"text-xl font-display font-semibold text-primary-700",children:[e.price.toLocaleString()," ",r.jsx("span",{className:"text-sm font-normal text-gray-600",children:"EGP"})]})}),r.jsx("div",{className:"mt-4 flex justify-between items-center",children:(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2 w-full",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center p-2 bg-gray-50 rounded-lg",children:[r.jsx(p.f0S,{className:"text-gray-500 mb-1 h-4 w-4"}),(0,r.jsxs)("span",{className:"text-xs text-gray-700 font-medium",children:[e.bedrooms," ",1===e.bedrooms?"Bed":"Beds"]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center p-2 bg-gray-50 rounded-lg",children:[r.jsx(p.MvV,{className:"text-gray-500 mb-1 h-4 w-4"}),(0,r.jsxs)("span",{className:"text-xs text-gray-700 font-medium",children:[e.bathrooms," ",1===e.bathrooms?"Bath":"Baths"]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center p-2 bg-gray-50 rounded-lg",children:[r.jsx(p.BxQ,{className:"text-gray-500 mb-1 h-4 w-4"}),(0,r.jsxs)("span",{className:"text-xs text-gray-700 font-medium",children:[e.area_size," m\xb2"]})]})]})}),(0,r.jsxs)("div",{className:"mt-5 flex space-x-2",children:[(0,r.jsxs)(x(),{href:`/properties/${e.id}`,className:"btn-outline flex-1 text-center text-sm py-2 flex items-center justify-center",children:["View Details",r.jsx(p.Dli,{className:"ml-2 h-3 w-3"})]}),t&&(0,r.jsxs)("button",{onClick:()=>t(e.id),className:"btn-primary flex-1 text-sm py-2 flex items-center justify-center",children:[r.jsx(p.IiJ,{className:"mr-2 h-3 w-3"}),"Schedule"]})]})]})]})}function SimilarProperties({currentProperty:e}){let[t,s]=(0,a.useState)([]),[i,l]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{let fetchSimilarProperties=async()=>{try{l(!0);let t=await getSimilarProperties(e,3);s(t)}catch(e){console.error("Error fetching similar properties:",e)}finally{l(!1)}};fetchSimilarProperties()},[e]),i)?(0,r.jsxs)("div",{className:"mt-12",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Similar Properties"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[1,2,3].map(e=>(0,r.jsxs)("div",{className:"animate-pulse",children:[r.jsx("div",{className:"bg-gray-200 h-48 rounded-t-xl"}),(0,r.jsxs)("div",{className:"bg-white p-4 rounded-b-xl border border-gray-200",children:[r.jsx("div",{className:"h-6 bg-gray-200 rounded mb-2 w-3/4"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded mb-4 w-1/2"}),r.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"})]})]},e))})]}):0===t.length?null:(0,r.jsxs)("div",{className:"mt-12",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Similar Properties"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>r.jsx(PropertyCard,{property:{id:e.id,title:e.title,location:e.location,price:e.price,bedrooms:e.bedrooms,bathrooms:e.bathrooms,area_size:e.area_size,image_url:e.featured_image||(e.image_urls&&e.image_urls.length>0?e.image_urls[0]:void 0),property_type:e.property_type}},e.id))})]})}var h=s(2522),g=s(3431),u=s(647),y=s(6552);function RequestViewingModal({isOpen:e,onClose:t,property:s}){let{user:i,session:d}=(0,u.a)(),[m,x]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!1),[y,f]=(0,a.useState)(null),[j,b]=(0,a.useState)(""),resetForm=()=>{b(""),g(!1),f(null)},handleSubmit=async()=>{if(!i){f("You must be logged in to request a viewing");return}if(!d?.access_token){f("Authentication error. Please try logging in again.");return}try{x(!0),f(null);let e={property_id:s.id,notes:j};await n.ZP.createScheduledViewing(d.access_token,e),g(!0)}catch(e){console.error("Error scheduling viewing:",e),f("Failed to schedule viewing. Please try again.")}finally{x(!1)}};return r.jsx(c.M,{children:e&&r.jsx(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4 text-center sm:p-0",children:[r.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t}),(0,r.jsxs)(l.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:[(0,r.jsxs)("div",{className:"bg-primary-50 px-4 py-3 sm:px-6 flex justify-between items-center",children:[r.jsx("h3",{className:"text-lg font-medium text-primary-900",children:"Schedule a Property Viewing"}),r.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-500",onClick:()=>{t(),setTimeout(resetForm,300)},children:r.jsx(o.q5L,{className:"h-6 w-6"})})]}),r.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:p?(0,r.jsxs)("div",{className:"text-center py-6",children:[r.jsx("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100",children:r.jsx(o.UgA,{className:"h-6 w-6 text-green-600"})}),r.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"Viewing Request Submitted"}),(0,r.jsxs)("p",{className:"mt-2 text-sm text-gray-500",children:["Your request to view ",s.title," has been submitted successfully. Our sales team will propose available time slots for your viewing soon. You will receive a notification when slots are available for selection."]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-100 flex items-start",children:[r.jsx(o.H33,{className:"text-blue-500 mt-0.5 mr-3 flex-shrink-0"}),(0,r.jsxs)("div",{className:"text-sm text-blue-800",children:[r.jsx("p",{className:"font-medium mb-1",children:"How scheduling works:"}),(0,r.jsxs)("ol",{className:"list-decimal pl-5 space-y-1",children:[r.jsx("li",{children:"Submit your viewing request"}),r.jsx("li",{children:"Our sales team will propose available time slots"}),r.jsx("li",{children:"You'll select your preferred slot"}),r.jsx("li",{children:"Sales team will confirm your appointment"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:["Request a viewing for ",s.title]}),r.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Submit your request to view this property, and our sales team will get back to you with available viewing slots."}),r.jsx("div",{className:"space-y-4",children:(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (optional)"}),(0,r.jsxs)("div",{className:"relative rounded-md shadow-sm",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(o.IC0,{className:"text-gray-400"})}),r.jsx("textarea",{rows:4,className:"block w-full pl-10 sm:text-sm border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500",placeholder:"Any special requests, questions, or preferred days of the week...",value:j,onChange:e=>b(e.target.value)})]})]})})]}),y&&r.jsx("div",{className:"mt-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:y})]})}),r.jsx("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:p?r.jsx(h.Z,{variant:"primary",onClick:()=>{t(),setTimeout(resetForm,300)},children:"Done"}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(h.Z,{variant:"primary",onClick:handleSubmit,loading:m,children:"Submit Request"}),r.jsx(h.Z,{variant:"light",onClick:t,className:"mr-2",children:"Cancel"})]})})]})]})})})}function SelectSlotModal({isOpen:e,onClose:t,viewingId:s,onSuccess:i}){let{session:d}=(0,u.a)(),[m,x]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!0),[y,f]=(0,a.useState)(null),[j,b]=(0,a.useState)(null),[v,N]=(0,a.useState)(null),[w,P]=(0,a.useState)(null),[S,_]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let fetchViewingDetails=async()=>{if(e&&d?.access_token&&s)try{g(!0),P(null);let e=await n.ZP.getScheduledViewingById(d.access_token,s);f(e),e.proposed_dates?.length===1&&b(e.proposed_dates[0]),e.proposed_times?.length===1&&N(e.proposed_times[0])}catch(e){console.error("Error fetching viewing details:",e),P("Failed to load viewing options. Please try again.")}finally{g(!1)}};fetchViewingDetails()},[e,d,s]);let handleSubmit=async()=>{if(!d?.access_token||!s||!j||!v){P("Please select both a date and time.");return}try{x(!0),P(null),await n.ZP.selectViewingSlot(d.access_token,s,{selected_date:j,selected_time:v}),_(!0),setTimeout(()=>{i&&i()},1500)}catch(e){console.error("Error selecting slot:",e),P("Failed to select viewing slot. Please try again.")}finally{x(!1)}},resetForm=()=>{b(null),N(null),P(null),_(!1)},formatDate=e=>new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),formatTime=e=>{let[t,s]=e.split(":"),r=parseInt(t);return`${r%12||12}:${s} ${r>=12?"PM":"AM"}`};return e?r.jsx(c.M,{children:r.jsx(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4 text-center sm:p-0",children:[r.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t}),(0,r.jsxs)(l.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:[(0,r.jsxs)("div",{className:"bg-primary-50 px-4 py-3 sm:px-6 flex justify-between items-center",children:[(0,r.jsxs)("h3",{className:"text-lg font-medium text-primary-900 flex items-center",children:[r.jsx(o.vlc,{className:"mr-2 h-5 w-5 text-primary-600"}),"Select Viewing Slot"]}),r.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-500",onClick:()=>{t(),setTimeout(resetForm,300)},children:r.jsx(o.q5L,{className:"h-6 w-6"})})]}),r.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:p?r.jsx("div",{className:"flex justify-center py-8",children:(0,r.jsxs)("div",{className:"relative h-12 w-12",children:[r.jsx("div",{className:"absolute top-0 left-0 right-0 bottom-0 border-t-4 border-primary-500 border-solid rounded-full animate-spin"}),r.jsx("div",{className:"absolute top-0 left-0 right-0 bottom-0 border-t-4 border-primary-200 border-solid rounded-full opacity-20"})]})}):S?(0,r.jsxs)("div",{className:"text-center py-6",children:[r.jsx("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100",children:r.jsx(o.UgA,{className:"h-6 w-6 text-green-600"})}),r.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"Slot Selected Successfully"}),(0,r.jsxs)("p",{className:"mt-2 text-sm text-gray-500",children:["You have selected ",j&&formatDate(j)," at ",v&&formatTime(v),". Our team will confirm your viewing appointment soon."]})]}):(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Please select your preferred date and time for viewing this property. Our sales team will confirm your appointment shortly after."}),y?.property&&(0,r.jsxs)("div",{className:"mb-6 bg-gray-50 p-3 rounded-lg",children:[r.jsx("h4",{className:"font-medium text-gray-900",children:y.property.title}),r.jsx("p",{className:"text-sm text-gray-600",children:y.property.location})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center",children:[r.jsx(o.vlc,{className:"mr-2 text-primary-500"}),"Select Date"]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:y?.proposed_dates?.map(e=>r.jsx("div",{className:`
                            border rounded-lg p-3 cursor-pointer transition
                            ${j===e?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 hover:border-primary-300 hover:bg-primary-50"}
                          `,onClick:()=>b(e),children:r.jsxs("div",{className:"flex items-center",children:[j===e&&r.jsx(o.UgA,{className:"text-primary-500 mr-2"}),r.jsx("span",{children:formatDate(e)})]})},e))})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center",children:[r.jsx(o.TCC,{className:"mr-2 text-primary-500"}),"Select Time"]}),r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:y?.proposed_times?.map(e=>r.jsx("div",{className:`
                            border rounded-lg p-3 cursor-pointer transition text-center
                            ${v===e?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 hover:border-primary-300 hover:bg-primary-50"}
                          `,onClick:()=>N(e),children:r.jsxs("div",{className:"flex items-center justify-center",children:[v===e&&r.jsx(o.UgA,{className:"text-primary-500 mr-2"}),r.jsx("span",{children:formatTime(e)})]})},e))})]}),w&&(0,r.jsxs)("div",{className:"mt-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md flex items-start",children:[r.jsx(o.bcx,{className:"text-red-500 mt-0.5 mr-2"}),r.jsx("span",{children:w})]})]})}),r.jsx("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:S?r.jsx(h.Z,{variant:"primary",onClick:()=>{t(),setTimeout(resetForm,300)},children:"Done"}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(h.Z,{variant:"primary",onClick:handleSubmit,loading:m,disabled:!j||!v||m,children:"Confirm Selection"}),r.jsx(h.Z,{variant:"light",onClick:()=>{t(),setTimeout(resetForm,300)},className:"mr-2",children:"Cancel"})]})})]})]})})}):null}function PropertyDetail(){let{id:e}=(0,i.useParams)(),t=(0,i.useRouter)(),{user:s,session:c}=(0,u.a)(),{isSaved:d,toggleSaved:m}=(0,y.c)(e),x=s?.role==="customer",[p,f]=(0,a.useState)(null),[j,b]=(0,a.useState)(null),[v,N]=(0,a.useState)(!1),[w,P]=(0,a.useState)(null),[S,_]=(0,a.useState)(!0),[k,C]=(0,a.useState)(null),[E,q]=(0,a.useState)(!1),[V,F]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let fetchPropertyDetails=async()=>{try{_(!0);let t=await getPropertyById(e);if(!t){C("Property not found");return}P(t),await incrementPropertyViews(e)}catch(e){console.error("Error fetching property details:",e),C("Failed to load property details")}finally{_(!1)}};fetchPropertyDetails()},[e]),(0,a.useEffect)(()=>{let fetchViewingStatus=async()=>{if(s&&c?.access_token&&w?.id)try{N(!0);let e=await n.ZP.getScheduledViewings(c.access_token,{propertyId:w.id});if(e?.viewings?.length>0){let t=e.viewings[0];f(t.status),b(t)}else f("none")}catch(e){console.error("Error fetching viewing status:",e),f("none")}finally{N(!1)}};fetchViewingStatus()},[s,c,w]);let handleToggleSave=async()=>{if(!s){t.push("/login?redirect=/properties/"+e);return}try{await m()}catch(e){console.error("Error toggling property save status:",e)}},openViewingModal=()=>{if(!s){t.push("/login?redirect=/properties/"+e);return}q(!0)};return S?r.jsx("div",{className:"flex justify-center items-center min-h-screen",children:(0,r.jsxs)("div",{className:"animate-pulse space-y-8 w-full max-w-3xl",children:[r.jsx("div",{className:"h-60 bg-gray-200 rounded-xl"}),r.jsx("div",{className:"h-8 bg-gray-200 rounded w-3/4"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),r.jsx("div",{className:"h-40 bg-gray-200 rounded"})]})}):k||!w?r.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen",children:(0,r.jsxs)(g.Z,{className:"p-8 text-center max-w-lg",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Property Not Found"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"The property you're looking for doesn't exist or has been removed."}),r.jsx(h.Z,{variant:"primary",onClick:()=>t.push("/properties"),leftIcon:r.jsx(o.Ao2,{}),children:"Browse Properties"})]})}):(0,r.jsxs)("div",{className:"pb-16",children:[r.jsx("div",{className:"mb-4",children:r.jsx(h.Z,{variant:"light",onClick:()=>t.back(),leftIcon:r.jsx(o.Ao2,{}),size:"sm",children:"Back to properties"})}),r.jsx(PropertyGallery,{images:w.image_urls||[],featuredImage:w.featured_image,title:w.title}),(0,r.jsxs)("div",{className:"mt-8 grid grid-cols-1 lg:grid-cols-3 gap-8",children:[r.jsx("div",{className:"lg:col-span-2",children:(0,r.jsxs)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-start justify-between mb-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:w.title}),(0,r.jsxs)("div",{className:"flex items-center mt-2 text-gray-600",children:[r.jsx(o.i63,{className:"mr-1 flex-shrink-0"}),r.jsx("span",{children:w.location})]})]}),r.jsx("div",{className:"mt-2 md:mt-0",children:r.jsx("div",{className:"text-2xl md:text-3xl font-bold text-primary-700",children:w.price.toLocaleString()+" EGP"})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-xl",children:[r.jsx("div",{className:"text-gray-500 text-sm mb-1",children:"Type"}),(0,r.jsxs)("div",{className:"font-medium flex items-center",children:[r.jsx(o.m6D,{className:"mr-2 text-primary-600"}),w.property_type]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-xl",children:[r.jsx("div",{className:"text-gray-500 text-sm mb-1",children:"Bedrooms"}),r.jsx("div",{className:"font-medium",children:w.bedrooms||"N/A"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-xl",children:[r.jsx("div",{className:"text-gray-500 text-sm mb-1",children:"Bathrooms"}),r.jsx("div",{className:"font-medium",children:w.bathrooms||"N/A"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-xl",children:[r.jsx("div",{className:"text-gray-500 text-sm mb-1",children:"Area"}),(0,r.jsxs)("div",{className:"font-medium flex items-center",children:[r.jsx(o.D7o,{className:"mr-2 text-primary-600"}),w.area_size," m\xb2"]})]})]}),(0,r.jsxs)("div",{className:"mb-8",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Description"}),r.jsx("div",{className:"prose prose-sm max-w-none text-gray-600",children:r.jsx("p",{children:w.description||"No description available for this property."})})]}),r.jsx(PropertyFeatures,{features:w.features||[]}),r.jsx(PropertyLocation,{location:w.location})]})}),r.jsx("div",{children:r.jsx(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.2},children:(0,r.jsxs)(g.Z,{className:"p-6",children:[r.jsx("div",{className:"space-y-3",children:x&&(0,r.jsxs)(r.Fragment,{children:["none"===p&&r.jsx(h.Z,{variant:"primary",fullWidth:!0,leftIcon:r.jsx(o.vlc,{}),onClick:openViewingModal,children:"Schedule a Viewing"}),"requested"===p&&r.jsx(h.Z,{variant:"light",fullWidth:!0,leftIcon:r.jsx(o.H33,{}),disabled:!0,children:"Viewing Request Submitted"}),"options_sent"===p&&r.jsx(h.Z,{variant:"primary",fullWidth:!0,leftIcon:r.jsx(o.vlc,{}),onClick:()=>F(!0),children:"Select Viewing Slot"}),"slot_selected"===p&&r.jsx(h.Z,{variant:"light",fullWidth:!0,leftIcon:r.jsx(o.TCC,{}),disabled:!0,children:"Waiting for Confirmation"}),"confirmed"===p&&(0,r.jsxs)(h.Z,{variant:"success",fullWidth:!0,leftIcon:r.jsx(o._rq,{}),onClick:()=>t.push(`/dashboard/scheduled-viewings/${j.id}`),children:["Viewing Confirmed: ",new Date(j.viewing_date).toLocaleDateString()]}),("cancelled"===p||"completed"===p)&&r.jsx(h.Z,{variant:"primary",fullWidth:!0,leftIcon:r.jsx(o.vlc,{}),onClick:openViewingModal,children:"Schedule Another Viewing"}),r.jsx(h.Z,{variant:d?"danger":"outline",fullWidth:!0,leftIcon:r.jsx(o.$aX,{}),onClick:handleToggleSave,children:d?"Remove from Saved":"Save Property"}),r.jsx(h.Z,{variant:"light",fullWidth:!0,leftIcon:r.jsx(o.PMT,{}),onClick:()=>{navigator.clipboard.writeText(window.location.href),alert("Link copied to clipboard!")},children:"Share Property"})]})}),(0,r.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-100",children:[(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[r.jsx(o.bfl,{className:"mr-2 text-primary-600"}),r.jsx("span",{children:"Listed by verified seller"})]}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[r.jsx(o.UgA,{className:"mr-2 text-green-500"}),r.jsx("span",{children:"Property available for viewing"})]})]})]})})})]}),r.jsx(SimilarProperties,{currentProperty:w}),r.jsx(RequestViewingModal,{isOpen:E,onClose:()=>q(!1),property:w}),j&&r.jsx(SelectSlotModal,{isOpen:V,onClose:()=>F(!1),viewingId:j?.id,onSuccess:()=>{F(!1),f("slot_selected")}})]})}},1604:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>i,default:()=>o});var r=s(5153);let a=(0,r.createProxy)(String.raw`E:\bigdealegy\bigdealegy\frontend\src\app\properties\[id]\layout.tsx`),{__esModule:i,$$typeof:l}=a,n=a.default,o=n},3728:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>i,default:()=>o});var r=s(5153);let a=(0,r.createProxy)(String.raw`E:\bigdealegy\bigdealegy\frontend\src\app\properties\[id]\page.tsx`),{__esModule:i,$$typeof:l}=a,n=a.default,o=n}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[657,4043,2076,1332,3500,7686,1407,2070,549,2522,3431,2308,6552,1068,4604],()=>__webpack_exec__(7450));module.exports=s})();