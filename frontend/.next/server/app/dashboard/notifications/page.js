(()=>{var e={};e.id=1258,e.ids=[1258],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},5310:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d});var a=r(7096),s=r(6132),i=r(7284),n=r.n(i),o=r(2564),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d=["",{children:["dashboard",{children:["notifications",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,4607)),"E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\dashboard\\notifications\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,8182)),"E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,9851)),"E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"]}],c=["E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\dashboard\\notifications\\page.tsx"],m="/dashboard/notifications/page",x={require:r,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/dashboard/notifications/page",pathname:"/dashboard/notifications",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1698:(e,t,r)=>{Promise.resolve().then(r.bind(r,6614))},6614:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Notifications});var a=r(784),s=r(9885),i=r(647),n=r(1332),o=r(6405),l=r(3431),d=r(2522),c=r(5105),m=r(1440),x=r.n(m);function Notifications(){let{user:e}=(0,i.a)(),{supabase:t}=(0,o.$)(),[r,m]=(0,s.useState)(!0),[u,p]=(0,s.useState)([]),[y,f]=(0,s.useState)("all");(0,s.useEffect)(()=>{let fetchNotifications=async()=>{if(e){m(!0);try{let{data:r,error:a}=await t.from("notifications").select("id").limit(1);if(a){console.error("Error checking for notifications table:",a),m(!1);return}let s=t.from("notifications").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});"unread"===y?s=s.eq("is_read",!1):"property"===y?s=s.eq("related_entity_type","property"):"viewing"===y?s=s.eq("related_entity_type","viewing"):"system"===y&&(s=s.eq("type","system"));let{data:i,error:n}=await s;if(n)throw n;p(i||[])}catch(e){console.error("Error fetching notifications:",e)}finally{m(!1)}}};fetchNotifications()},[t,e,y]);let markAsRead=async e=>{try{let{error:r}=await t.from("notifications").update({is_read:!0}).eq("id",e);if(r)throw r;p(u.map(t=>t.id===e?{...t,is_read:!0}:t))}catch(e){console.error("Error marking notification as read:",e)}},markAllAsRead=async()=>{try{let{error:r}=await t.from("notifications").update({is_read:!0}).eq("user_id",e.id).eq("is_read",!1);if(r)throw r;p(u.map(e=>({...e,is_read:!0})))}catch(e){console.error("Error marking all notifications as read:",e)}},deleteNotification=async e=>{try{let{error:r}=await t.from("notifications").delete().eq("id",e);if(r)throw r;p(u.filter(t=>t.id!==e))}catch(e){console.error("Error deleting notification:",e)}},formatDate=e=>{let t=new Date(e),r=new Date,a=r.getTime()-t.getTime();if(a<864e5){if(a<36e5){let e=Math.floor(a/6e4);return`${e} ${1===e?"minute":"minutes"} ago`}let e=Math.floor(a/36e5);return`${e} ${1===e?"hour":"hours"} ago`}if(a<6048e5){let e=Math.floor(a/864e5);return`${e} ${1===e?"day":"days"} ago`}return t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},getNotificationIcon=(e,t)=>{switch(e){case"system":default:return a.jsx(c.vWP,{className:"h-4 w-4 text-gray-500"});case"alert":return a.jsx(c.bcx,{className:"h-4 w-4 text-red-500"});case"success":return a.jsx(c._rq,{className:"h-4 w-4 text-green-500"});case"update":if("property"===t)return a.jsx(c.m6D,{className:"h-4 w-4 text-primary-500"});if("viewing"===t)return a.jsx(c.vlc,{className:"h-4 w-4 text-blue-500"});if("request"===t)return a.jsx(c.j4u,{className:"h-4 w-4 text-purple-500"});return a.jsx(c.TCC,{className:"h-4 w-4 text-yellow-500"});case"message":return a.jsx(c.IC0,{className:"h-4 w-4 text-blue-500"})}},getNotificationLink=e=>{if(!e.related_entity_id||!e.related_entity_type)return"#";switch(e.related_entity_type){case"property":return`/properties/${e.related_entity_id}`;case"viewing":return`/dashboard/scheduled-viewings/${e.related_entity_id}`;case"request":return`/dashboard/property-requests/${e.related_entity_id}`;default:return"#"}},g=u.filter(e=>!e.is_read).length;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 gap-2",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Notifications"}),a.jsx("p",{className:"text-xs text-gray-600",children:"Stay updated on your property requests, viewings, and system alerts"})]}),g>0&&a.jsx(d.Z,{variant:"outline",size:"sm",leftIcon:a.jsx(c.UgA,{}),onClick:markAllAsRead,children:"Mark all as read"})]}),(0,a.jsxs)("div",{className:"flex mb-3 overflow-x-auto pb-1",children:[a.jsx("button",{onClick:()=>f("all"),className:`px-3 py-1 text-xs font-medium rounded-full mr-2 ${"all"===y?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All"}),(0,a.jsxs)("button",{onClick:()=>f("unread"),className:`px-3 py-1 text-xs font-medium rounded-full mr-2 flex items-center ${"unread"===y?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Unread",g>0&&a.jsx("span",{className:"ml-1 bg-primary-700 text-white rounded-full h-4 w-4 flex items-center justify-center text-xs",children:g})]}),(0,a.jsxs)("button",{onClick:()=>f("property"),className:`px-3 py-1 text-xs font-medium rounded-full mr-2 flex items-center ${"property"===y?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[a.jsx(c.m6D,{className:"mr-1 h-3 w-3"}),"Properties"]}),(0,a.jsxs)("button",{onClick:()=>f("viewing"),className:`px-3 py-1 text-xs font-medium rounded-full mr-2 flex items-center ${"viewing"===y?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[a.jsx(c.vlc,{className:"mr-1 h-3 w-3"}),"Viewings"]}),(0,a.jsxs)("button",{onClick:()=>f("system"),className:`px-3 py-1 text-xs font-medium rounded-full flex items-center ${"system"===y?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[a.jsx(c.nbt,{className:"mr-1 h-3 w-3"}),"System"]})]}),a.jsx(l.Z,{children:r?a.jsx("div",{className:"flex justify-center items-center h-40",children:(0,a.jsxs)("div",{className:"relative h-10 w-10",children:[a.jsx("div",{className:"absolute top-0 left-0 right-0 bottom-0 border-t-3 border-primary-500 border-solid rounded-full animate-spin"}),a.jsx("div",{className:"absolute top-0 left-0 right-0 bottom-0 border-t-3 border-primary-200 border-solid rounded-full opacity-20"})]})}):u.length>0?a.jsx("div",{className:"divide-y divide-gray-100",children:u.map(e=>a.jsx(n.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2},className:`p-3 hover:bg-gray-50 transition-colors ${e.is_read?"":"bg-blue-50"}`,children:(0,a.jsxs)("div",{className:"flex",children:[a.jsx("div",{className:`p-1.5 rounded-full mr-3 flex-shrink-0 ${"alert"===e.type?"bg-red-100":"success"===e.type?"bg-green-100":"update"===e.type&&"property"===e.related_entity_type?"bg-primary-100":"update"===e.type&&"viewing"===e.related_entity_type?"bg-blue-100":"update"===e.type&&"request"===e.related_entity_type?"bg-purple-100":"message"===e.type?"bg-blue-100":"bg-gray-100"}`,children:getNotificationIcon(e.type,e.related_entity_type)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[a.jsx(x(),{href:getNotificationLink(e),className:`text-sm font-medium ${e.is_read?"text-gray-700":"text-gray-900"}`,children:e.title}),a.jsx("span",{className:"text-xs text-gray-500",children:formatDate(e.created_at)})]}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:e.message}),(0,a.jsxs)("div",{className:"flex justify-end mt-2",children:[!e.is_read&&(0,a.jsxs)("button",{onClick:()=>markAsRead(e.id),className:"text-xs text-primary-600 hover:text-primary-800 mr-3 flex items-center",children:[a.jsx(c.UgA,{className:"h-3 w-3 mr-1"}),"Mark as read"]}),e.related_entity_id&&e.related_entity_type&&(0,a.jsxs)(x(),{href:getNotificationLink(e),className:"text-xs text-primary-600 hover:text-primary-800 mr-3 flex items-center",children:[a.jsx(c.rDJ,{className:"h-3 w-3 mr-1"}),"View details"]}),(0,a.jsxs)("button",{onClick:()=>deleteNotification(e.id),className:"text-xs text-red-600 hover:text-red-800 flex items-center",children:[a.jsx(c.q5L,{className:"h-3 w-3 mr-1"}),"Remove"]})]})]})]})},e.id))}):(0,a.jsxs)("div",{className:"text-center py-10",children:[a.jsx("div",{className:"mx-auto h-16 w-16 rounded-full bg-gray-100 flex items-center justify-center mb-4",children:a.jsx(c.vWP,{className:"h-7 w-7 text-gray-400"})}),a.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-1",children:"No notifications"}),a.jsx("p",{className:"text-xs text-gray-500 max-w-sm mx-auto mb-4",children:"all"!==y?"No notifications match your selected filter.":"You don't have any notifications yet. New notifications will appear here."}),"all"!==y&&a.jsx(d.Z,{variant:"outline",size:"xs",onClick:()=>f("all"),children:"View all notifications"})]})}),!r&&u.length>0&&a.jsx("div",{className:"mt-4 text-center",children:(0,a.jsxs)(x(),{href:"/dashboard/settings",className:"text-xs text-primary-600 hover:text-primary-800 flex items-center justify-center",children:[a.jsx(c.nbt,{className:"h-3 w-3 mr-1"}),"Manage notification settings"]})})]})}},6405:(e,t,r)=>{"use strict";r.d(t,{$:()=>useSupabase}),r(784);let useSupabase=()=>{throw Error("useSupabase has been deprecated. Use the backend API endpoints instead.")}},4607:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>l});var a=r(5153);let s=(0,a.createProxy)(String.raw`E:\bigdealegy\bigdealegy\frontend\src\app\dashboard\notifications\page.tsx`),{__esModule:i,$$typeof:n}=s,o=s.default,l=o}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[657,4043,2076,1332,1407,2070,549,5846,2522,3431,9494],()=>__webpack_exec__(5310));module.exports=r})();