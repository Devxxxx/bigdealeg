(()=>{var e={};e.id=1585,e.ids=[1585],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9146:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>n});var s=t(7096),a=t(6132),i=t(7284),l=t.n(i),o=t(2564),d={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);t.d(r,d);let n=["",{children:["dashboard",{children:["property-requests",{children:["[id]",{children:["edit",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,3418)),"E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\dashboard\\property-requests\\[id]\\edit\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,8182)),"E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,9851)),"E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],c=["E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\dashboard\\property-requests\\[id]\\edit\\page.tsx"],m="/dashboard/property-requests/[id]/edit/page",p={require:t,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/property-requests/[id]/edit/page",pathname:"/dashboard/property-requests/[id]/edit",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},5795:(e,r,t)=>{Promise.resolve().then(t.bind(t,5510))},5510:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>EditPropertyRequest});var s=t(784),a=t(9885),i=t(7114),l=t(647),o=t(6405),d=t(3431),n=t(2522),c=t(2770),m=t(1414),p=t(5105),u=t(1440),h=t.n(u);let x=["Apartment","Villa","Townhouse","Penthouse","Chalet","Duplex","Office","Shop","Land"],f=["Studio","1","2","3","4","5","6+"],b=["1","2","3","4","5+"];function EditPropertyRequest(){let{id:e}=(0,i.useParams)(),r=(0,i.useRouter)(),{user:t}=(0,l.a)(),{supabase:u}=(0,o.$)(),[_,y]=(0,a.useState)(!0),[g,j]=(0,a.useState)(!1),[v,q]=(0,a.useState)(""),[N,C]=(0,a.useState)(!1),[P,w]=(0,a.useState)({title:"",property_type:"",location:"",min_price:"",max_price:"",bedrooms:"",bathrooms:"",area_size:"",additional_features:"",custom_fields:{}}),[S,Z]=(0,a.useState)([]);(0,a.useEffect)(()=>{let fetchData=async()=>{if(t&&e){y(!0);try{let{data:r,error:s}=await u.from("property_requests").select("*").eq("id",e).eq("user_id",t.id).single();if(s)throw s;if(!r){q("Property request not found or you do not have permission to edit it."),y(!1);return}let{data:a,error:i}=await u.from("property_request_fields").select("*").order("order",{ascending:!0});if(i)throw i;Z(a||[]),w({title:r.title||"",property_type:r.property_type||"",location:r.location||"",min_price:r.min_price?.toString()||"",max_price:r.max_price?.toString()||"",bedrooms:r.bedrooms||"",bathrooms:r.bathrooms||"",area_size:r.area_size?.toString()||"",additional_features:r.additional_features||"",custom_fields:r.custom_fields||{}})}catch(e){console.error("Error fetching property request:",e),q("Failed to load property request. Please try again.")}finally{y(!1)}}};fetchData()},[u,t,e]);let handleChange=e=>{let{name:r,value:t,type:s,checked:a}=e.target;if("checkbox"===s){if(r.startsWith("custom_")){let e=r.replace("custom_","");w({...P,custom_fields:{...P.custom_fields,[e]:a}})}}else if(r.startsWith("custom_")){let e=r.replace("custom_","");w({...P,custom_fields:{...P.custom_fields,[e]:t}})}else w({...P,[r]:t})},handleSubmit=async s=>{if(s.preventDefault(),!t||!e)return;if(!P.title||!P.property_type||!P.location){q("Please fill out all required fields.");return}let a=parseFloat(P.min_price),i=parseFloat(P.max_price);if(a>=i){q("Minimum price must be less than maximum price.");return}j(!0),q("");try{let s={title:P.title,property_type:P.property_type,location:P.location,min_price:a,max_price:i,bedrooms:P.bedrooms,bathrooms:P.bathrooms,area_size:P.area_size?parseFloat(P.area_size):null,additional_features:P.additional_features,custom_fields:P.custom_fields,updated_at:new Date().toISOString()},{error:l}=await u.from("property_requests").update(s).eq("id",e).eq("user_id",t.id);if(l)throw l;C(!0),setTimeout(()=>{r.push(`/dashboard/property-requests/${e}`)},1500)}catch(e){console.error("Error updating property request:",e),q("Failed to update property request. Please try again.")}finally{j(!1)}};return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center mb-3",children:[s.jsx(h(),{href:`/dashboard/property-requests/${e}`,className:"text-gray-500 hover:text-gray-700 mr-2",children:s.jsx(p.Ao2,{className:"h-4 w-4"})}),s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Edit Property Request"})]}),v&&s.jsx("div",{className:"mb-3 bg-red-50 border-l-4 border-red-500 p-2 rounded-md",children:(0,s.jsxs)("div",{className:"flex",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(p.bcx,{className:"h-5 w-5 text-red-500"})}),s.jsx("div",{className:"ml-3",children:s.jsx("p",{className:"text-sm text-red-700",children:v})})]})}),N&&s.jsx("div",{className:"mb-3 bg-green-50 border-l-4 border-green-500 p-2 rounded-md",children:(0,s.jsxs)("div",{className:"flex",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(p._rq,{className:"h-5 w-5 text-green-500"})}),s.jsx("div",{className:"ml-3",children:s.jsx("p",{className:"text-sm text-green-700",children:"Property request updated successfully! Redirecting..."})})]})}),_?s.jsx(d.Z,{children:s.jsx("div",{className:"flex justify-center items-center h-40",children:(0,s.jsxs)("div",{className:"relative h-10 w-10",children:[s.jsx("div",{className:"absolute top-0 left-0 right-0 bottom-0 border-t-3 border-primary-500 border-solid rounded-full animate-spin"}),s.jsx("div",{className:"absolute top-0 left-0 right-0 bottom-0 border-t-3 border-primary-200 border-solid rounded-full opacity-20"})]})})}):s.jsx("form",{onSubmit:handleSubmit,children:(0,s.jsxs)(d.Z,{children:[(0,s.jsxs)("div",{className:"flex items-center mb-3",children:[s.jsx(p.j4u,{className:"h-5 w-5 text-primary-500 mr-2"}),s.jsx("h2",{className:"text-base font-medium text-gray-900",children:"Property Request Details"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(m.Z,{label:"Request Title",htmlFor:"title",required:!0,span:"full",children:s.jsx(c.Z,{id:"title",name:"title",type:"text",placeholder:"E.g., 3 Bedroom Apartment in New Cairo",value:P.title,onChange:handleChange,leftIcon:s.jsx(p.j4u,{}),required:!0})}),s.jsx(m.Z,{label:"Property Type",htmlFor:"property_type",required:!0,children:(0,s.jsxs)("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(p.m6D,{className:"h-4 w-4 text-gray-400"})}),(0,s.jsxs)("select",{id:"property_type",name:"property_type",value:P.property_type,onChange:handleChange,className:"block w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500",required:!0,children:[s.jsx("option",{value:"",children:"Select Property Type"}),x.map(e=>s.jsx("option",{value:e,children:e},e))]})]})}),s.jsx(m.Z,{label:"Location",htmlFor:"location",required:!0,children:s.jsx(c.Z,{id:"location",name:"location",type:"text",placeholder:"E.g., New Cairo, Maadi, etc.",value:P.location,onChange:handleChange,leftIcon:s.jsx(p.i63,{}),required:!0})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 col-span-full md:col-span-1",children:[s.jsx(m.Z,{label:"Minimum Price (EGP)",htmlFor:"min_price",required:!0,children:s.jsx(c.Z,{id:"min_price",name:"min_price",type:"number",placeholder:"Min price",value:P.min_price,onChange:handleChange,leftIcon:s.jsx(p.oQC,{}),min:"0",step:"1000",required:!0})}),s.jsx(m.Z,{label:"Maximum Price (EGP)",htmlFor:"max_price",required:!0,children:s.jsx(c.Z,{id:"max_price",name:"max_price",type:"number",placeholder:"Max price",value:P.max_price,onChange:handleChange,leftIcon:s.jsx(p.oQC,{}),min:"0",step:"1000",required:!0})})]}),s.jsx(m.Z,{label:"Bedrooms",htmlFor:"bedrooms",children:(0,s.jsxs)("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(p.m6D,{className:"h-4 w-4 text-gray-400"})}),(0,s.jsxs)("select",{id:"bedrooms",name:"bedrooms",value:P.bedrooms,onChange:handleChange,className:"block w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500",children:[s.jsx("option",{value:"",children:"Select Bedrooms"}),f.map(e=>s.jsx("option",{value:e,children:e},e))]})]})}),s.jsx(m.Z,{label:"Bathrooms",htmlFor:"bathrooms",children:(0,s.jsxs)("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(p.m6D,{className:"h-4 w-4 text-gray-400"})}),(0,s.jsxs)("select",{id:"bathrooms",name:"bathrooms",value:P.bathrooms,onChange:handleChange,className:"block w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500",children:[s.jsx("option",{value:"",children:"Select Bathrooms"}),b.map(e=>s.jsx("option",{value:e,children:e},e))]})]})}),s.jsx(m.Z,{label:"Area Size (m\xb2)",htmlFor:"area_size",children:s.jsx(c.Z,{id:"area_size",name:"area_size",type:"number",placeholder:"Area in square meters",value:P.area_size,onChange:handleChange,min:"0",step:"1"})}),s.jsx(m.Z,{label:"Additional Features",htmlFor:"additional_features",span:"full",children:s.jsx("textarea",{id:"additional_features",name:"additional_features",value:P.additional_features,onChange:handleChange,rows:3,className:"block w-full rounded-lg border border-gray-300 py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-sm",placeholder:"Describe any additional features or requirements"})})]}),S.length>0&&(0,s.jsxs)("div",{className:"mt-4 border-t border-gray-100 pt-4",children:[(0,s.jsxs)("div",{className:"flex items-center mb-3",children:[s.jsx(p.H33,{className:"h-5 w-5 text-primary-500 mr-2"}),s.jsx("h2",{className:"text-base font-medium text-gray-900",children:"Additional Preferences"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:S.map(e=>s.jsx("div",{className:"full"===e.field_span?"col-span-full":"",children:"checkbox"===e.field_type?(0,s.jsxs)("div",{className:"flex items-start",children:[s.jsx("div",{className:"flex items-center h-5",children:s.jsx("input",{id:`custom_${e.field_name}`,name:`custom_${e.field_name}`,type:"checkbox",checked:P.custom_fields[e.field_name]||!1,onChange:handleChange,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"})}),(0,s.jsxs)("div",{className:"ml-3 text-sm",children:[s.jsx("label",{htmlFor:`custom_${e.field_name}`,className:"font-medium text-gray-700",children:e.field_label}),e.help_text&&s.jsx("p",{className:"text-gray-500",children:e.help_text})]})]}):"select"===e.field_type?s.jsx(m.Z,{label:e.field_label,htmlFor:`custom_${e.field_name}`,required:e.is_required,helpText:e.help_text,children:(0,s.jsxs)("select",{id:`custom_${e.field_name}`,name:`custom_${e.field_name}`,value:P.custom_fields[e.field_name]||"",onChange:handleChange,className:"block w-full rounded-lg border border-gray-300 py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-sm",required:e.is_required,children:[s.jsx("option",{value:"",children:e.placeholder||`Select ${e.field_label}`}),e.options?.split(",").map(e=>s.jsx("option",{value:e.trim(),children:e.trim()},e.trim()))]})}):s.jsx(m.Z,{label:e.field_label,htmlFor:`custom_${e.field_name}`,required:e.is_required,helpText:e.help_text,children:s.jsx(c.Z,{id:`custom_${e.field_name}`,name:`custom_${e.field_name}`,type:"number"===e.field_type?"number":"text",placeholder:e.placeholder,value:P.custom_fields[e.field_name]||"",onChange:handleChange,required:e.is_required,min:"number"===e.field_type?e.min_value:void 0,max:"number"===e.field_type?e.max_value:void 0})})},e.id))})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4",children:[s.jsx(n.Z,{variant:"light",size:"sm",leftIcon:s.jsx(p.q5L,{}),onClick:()=>{r.back()},type:"button",children:"Cancel"}),s.jsx(n.Z,{variant:"primary",size:"sm",leftIcon:s.jsx(p.mW3,{}),type:"submit",loading:g,children:g?"Saving...":"Save Changes"})]})]})})]})}},6405:(e,r,t)=>{"use strict";t.d(r,{$:()=>useSupabase}),t(784);let useSupabase=()=>{throw Error("useSupabase has been deprecated. Use the backend API endpoints instead.")}},3418:(e,r,t)=>{"use strict";t.r(r),t.d(r,{$$typeof:()=>l,__esModule:()=>i,default:()=>d});var s=t(5153);let a=(0,s.createProxy)(String.raw`E:\bigdealegy\bigdealegy\frontend\src\app\dashboard\property-requests\[id]\edit\page.tsx`),{__esModule:i,$$typeof:l}=a,o=a.default,d=o}};var r=require("../../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[657,4043,2076,1332,1407,2070,549,5846,2522,3431,9494,2770,1414],()=>__webpack_exec__(9146));module.exports=t})();