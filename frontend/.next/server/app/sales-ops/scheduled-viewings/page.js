(()=>{var e={};e.id=6120,e.ids=[6120],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},1888:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d});var a=t(7096),r=t(6132),i=t(7284),l=t.n(i),n=t(2564),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(s,o);let d=["",{children:["sales-ops",{children:["scheduled-viewings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,5454)),"E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\sales-ops\\scheduled-viewings\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,2776)),"E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\sales-ops\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,9851)),"E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],c=["E:\\bigdealegy\\bigdealegy\\frontend\\src\\app\\sales-ops\\scheduled-viewings\\page.tsx"],m="/sales-ops/scheduled-viewings/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/sales-ops/scheduled-viewings/page",pathname:"/sales-ops/scheduled-viewings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},8408:(e,s,t)=>{Promise.resolve().then(t.bind(t,4e3))},4e3:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ScheduledViewings});var a=t(784),r=t(9885),i=t(647),l=t(2308),n=t(345),o=t(3500),d=t(1440),c=t.n(d),m=t(5105),x=t(2522),u=t(7686),p=t(1332);function ProposeViewingSlotsModal({isOpen:e,onClose:s,viewingId:t,propertyTitle:n}){let{user:o,session:d}=(0,i.a)(),[c,h]=(0,r.useState)(!1),[g,f]=(0,r.useState)(!1),[y,j]=(0,r.useState)(null),[v,w]=(0,r.useState)([""]),[b,N]=(0,r.useState)([""]),[_,S]=(0,r.useState)(""),resetForm=()=>{w([""]),N([""]),S(""),f(!1),j(null)},addDate=()=>{w([...v,""])},removeDate=e=>{if(1===v.length)return;let s=[...v];s.splice(e,1),w(s)},updateDate=(e,s)=>{let t=[...v];t[e]=s,w(t)},addTime=()=>{N([...b,""])},removeTime=e=>{if(1===b.length)return;let s=[...b];s.splice(e,1),N(s)},updateTime=(e,s)=>{let t=[...b];t[e]=s,N(t)},validateForm=()=>v.some(e=>!e.trim())?(j("All date fields must be filled"),!1):b.some(e=>!e.trim())?(j("All time fields must be filled"),!1):new Set(v).size!==v.length?(j("Please remove duplicate dates"),!1):new Set(b).size===b.length||(j("Please remove duplicate times"),!1),handleSubmit=async()=>{if(!d?.access_token){j("Authentication error. Please try logging in again.");return}if(validateForm())try{h(!0),j(null),await l.ZP.proposeViewingSlots(d.access_token,t,{proposed_dates:v,proposed_times:b,private_notes:_}),f(!0)}catch(e){console.error("Error proposing viewing slots:",e),j("Failed to propose viewing slots. Please try again.")}finally{h(!1)}};return a.jsx(u.M,{children:e&&a.jsx(p.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 overflow-y-auto",children:(0,a.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4 text-center sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:s}),(0,a.jsxs)(p.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:[(0,a.jsxs)("div",{className:"bg-primary-50 px-4 py-3 sm:px-6 flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-medium text-primary-900",children:"Propose Viewing Slots"}),a.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-500",onClick:()=>{s(),setTimeout(resetForm,300)},children:a.jsx(m.q5L,{className:"h-6 w-6"})})]}),a.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:g?(0,a.jsxs)("div",{className:"text-center py-6",children:[a.jsx("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100",children:a.jsx(m.UgA,{className:"h-6 w-6 text-green-600"})}),a.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"Viewing Slots Proposed"}),(0,a.jsxs)("p",{className:"mt-2 text-sm text-gray-500",children:["You have successfully proposed viewing slots for ",n,". The customer will be notified and can now select their preferred slot."]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:["Propose viewing slots for ",n]}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Suggest multiple dates and times for the customer to choose from."}),(0,a.jsxs)("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Available Dates"}),v.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsxs)("div",{className:"relative flex-grow rounded-md shadow-sm",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(m.vlc,{className:"text-gray-400"})}),a.jsx("input",{type:"date",className:"block w-full pl-10 sm:text-sm border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500",value:e,onChange:e=>updateDate(s,e.target.value),min:new Date().toISOString().split("T")[0]})]}),v.length>1&&a.jsx("button",{type:"button",className:"ml-2 p-2 text-gray-400 hover:text-red-500",onClick:()=>removeDate(s),children:a.jsx(m.ego,{})}),s===v.length-1&&a.jsx("button",{type:"button",className:"ml-2 p-2 text-gray-400 hover:text-green-500",onClick:addDate,children:a.jsx(m.OvN,{})})]},s))]}),(0,a.jsxs)("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Available Times"}),b.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsxs)("div",{className:"relative flex-grow rounded-md shadow-sm",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(m.TCC,{className:"text-gray-400"})}),a.jsx("input",{type:"time",className:"block w-full pl-10 sm:text-sm border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500",value:e,onChange:e=>updateTime(s,e.target.value)})]}),b.length>1&&a.jsx("button",{type:"button",className:"ml-2 p-2 text-gray-400 hover:text-red-500",onClick:()=>removeTime(s),children:a.jsx(m.ego,{})}),s===b.length-1&&a.jsx("button",{type:"button",className:"ml-2 p-2 text-gray-400 hover:text-green-500",onClick:addTime,children:a.jsx(m.OvN,{})})]},s))]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Private Notes (optional)"}),(0,a.jsxs)("div",{className:"relative rounded-md shadow-sm",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(m.IC0,{className:"text-gray-400"})}),a.jsx("textarea",{rows:3,className:"block w-full pl-10 sm:text-sm border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500",placeholder:"Notes for internal use only (not shown to customer)...",value:_,onChange:e=>S(e.target.value)})]})]})]}),y&&a.jsx("div",{className:"mt-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:y})]})}),a.jsx("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:g?a.jsx(x.Z,{variant:"primary",onClick:()=>{s(),setTimeout(resetForm,300)},children:"Done"}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(x.Z,{variant:"primary",onClick:handleSubmit,loading:c,children:"Send to Customer"}),a.jsx(x.Z,{variant:"light",onClick:s,className:"mr-2",children:"Cancel"})]})})]})]})})})}function ScheduledViewings(){let{session:e}=(0,i.a)(),[s,t]=(0,r.useState)([]),[d,m]=(0,r.useState)(!0),[x,u]=(0,r.useState)(""),[p,h]=(0,r.useState)("all"),[g,f]=(0,r.useState)("all"),[y,j]=(0,r.useState)(null),[v,w]=(0,r.useState)(!1),[b,N]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let fetchViewings=async()=>{try{if(m(!0),!e?.access_token){console.error("No access token available");return}let s=await (0,l.U4)(e.access_token,{viewAll:!0,sortBy:"viewing_date",sortDirection:"asc"});console.log("Scheduled viewings response:",s),t(s.viewings||[])}catch(e){console.error("Error fetching viewings:",e),n.toast.error("Failed to load scheduled viewings")}finally{m(!1)}};fetchViewings()},[e]);let openViewingModal=e=>{j(e),w(!0)},openProposeModal=e=>{j(e),N(!0)},updateViewingStatus=async(a,r)=>{try{if(!e?.access_token)throw Error("No access token available");"confirmed"===r?await (0,l.G9)(e.access_token,a,{}):"completed"===r?await (0,l.Jt)(e.access_token,a):"cancelled"===r?await (0,l.G)(e.access_token,a):await (0,l.pz)(e.access_token,a,{status:r}),t(s.map(e=>e.id===a?{...e,status:r}:e)),y?.id===a&&j({...y,status:r}),n.toast.success(`Viewing status updated to ${r}`)}catch(e){console.error("Error updating viewing status:",e),n.toast.error("Failed to update viewing status")}},formatDate=e=>{let s=new Date(e);return s.toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})},formatTime=e=>{let s=new Date(e);return s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})},getStatusBadge=e=>{switch(e){case"requested":return(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[a.jsx(o.qyc,{className:"mr-1 h-3 w-3"}),"Requested"]});case"options_sent":return(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[a.jsx(o.qyc,{className:"mr-1 h-3 w-3"}),"Options Sent"]});case"slot_selected":return(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[a.jsx(o.qyc,{className:"mr-1 h-3 w-3"}),"Slot Selected"]});case"confirmed":return(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[a.jsx(o.l_A,{className:"mr-1 h-3 w-3"}),"Confirmed"]});case"completed":return(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[a.jsx(o.iCz,{className:"mr-1 h-3 w-3"}),"Completed"]});case"cancelled":return(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[a.jsx(o.j5f,{className:"mr-1 h-3 w-3"}),"Cancelled"]});default:return a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e})}},isToday=e=>{let s=new Date,t=new Date(e);return t.toDateString()===s.toDateString()},isPast=e=>{let s=new Date,t=new Date(e);return t<s},_=s.filter(e=>{if("all"!==p&&e.status!==p)return!1;if("all"!==g){let s=new Date,t=new Date(e.viewing_date);if("today"===g){if(t.toDateString()!==s.toDateString())return!1}else if("upcoming"===g){if(t<s)return!1}else if("past"===g&&t>s)return!1}if(x){let s=x.toLowerCase();return e.property.title.toLowerCase().includes(s)||e.property.location.toLowerCase().includes(s)||e.profile.name.toLowerCase().includes(s)}return!0});return(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:(0,a.jsxs)("div",{className:"p-6 flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[a.jsx(o.IiJ,{className:"mr-3 text-primary"}),"Scheduled Viewings"]}),a.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Manage and track property viewing appointments"})]}),a.jsx("div",{children:(0,a.jsxs)(c(),{href:"/sales-ops/schedule-viewing",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:[a.jsx(o.IiJ,{className:"mr-2 -ml-1 h-4 w-4"}),"New Viewing"]})})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:a.jsx("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4",children:[(0,a.jsxs)("div",{className:"relative flex-grow",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(o.U41,{className:"h-4 w-4 text-gray-400"})}),a.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",placeholder:"Search property, location, or customer...",value:x,onChange:e=>u(e.target.value)})]}),(0,a.jsxs)("div",{className:"relative w-full md:w-48",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(o.ulB,{className:"h-4 w-4 text-gray-400"})}),(0,a.jsxs)("select",{className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",value:p,onChange:e=>h(e.target.value),children:[a.jsx("option",{value:"all",children:"All Statuses"}),a.jsx("option",{value:"requested",children:"Requested"}),a.jsx("option",{value:"options_sent",children:"Options Sent"}),a.jsx("option",{value:"slot_selected",children:"Slot Selected"}),a.jsx("option",{value:"confirmed",children:"Confirmed"}),a.jsx("option",{value:"completed",children:"Completed"}),a.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,a.jsxs)("div",{className:"relative w-full md:w-48",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(o.IiJ,{className:"h-4 w-4 text-gray-400"})}),(0,a.jsxs)("select",{className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",value:g,onChange:e=>f(e.target.value),children:[a.jsx("option",{value:"all",children:"All Dates"}),a.jsx("option",{value:"today",children:"Today"}),a.jsx("option",{value:"upcoming",children:"Upcoming"}),a.jsx("option",{value:"past",children:"Past"})]})]})]})})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:d?a.jsx("div",{className:"flex justify-center items-center p-12",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):0===_.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center p-12 text-center",children:[a.jsx("div",{className:"text-gray-400 text-4xl mb-4",children:"\uD83D\uDDD3️"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No viewings found"}),a.jsx("p",{className:"text-gray-500 text-sm",children:x||"all"!==p||"all"!==g?"Try adjusting your search or filters":"No property viewings have been scheduled yet"})]}):a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Property"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date & Time"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_.map(e=>(0,a.jsxs)("tr",{className:`hover:bg-gray-50 ${isToday(e.viewing_date)?"bg-blue-50":""}`,children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:a.jsx("img",{className:"h-10 w-10 rounded-md object-cover",src:e.property?.featured_image||"https://via.placeholder.com/100?text=No+Image",alt:""})}),(0,a.jsxs)("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.property?.title||"Unnamed Property"}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[a.jsx(o.Nh4,{className:"mr-1 h-3 w-3"}),e.property?.location||"No location"]})]})]})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.profile?.name||"Unknown User"}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[a.jsx(o.SRX,{className:"mr-1 h-3 w-3"}),e.profile?.email||"No email"]}),e.profile?.phone&&(0,a.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[a.jsx(o.I7T,{className:"mr-1 h-3 w-3"}),e.profile.phone]})]}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm text-gray-900",children:formatDate(e.viewing_date)}),a.jsx("div",{className:"text-sm text-gray-500",children:formatTime(e.viewing_date)}),isToday(e.viewing_date)&&a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Today"}),isPast(e.viewing_date)&&!isToday(e.viewing_date)&&a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Past"})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:getStatusBadge(e.status)}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[a.jsx("button",{onClick:()=>openViewingModal(e),className:"text-primary hover:text-primary/80 mr-2",title:"View Details",children:a.jsx(o.dSq,{className:"h-5 w-5"})}),"requested"===e.status&&a.jsx("button",{onClick:()=>openProposeModal(e),className:"text-blue-600 hover:text-blue-900 mr-2",title:"Propose Times",children:a.jsx(o.qyc,{className:"h-5 w-5"})}),"slot_selected"===e.status&&a.jsx("button",{onClick:()=>updateViewingStatus(e.id,"confirmed"),className:"text-green-600 hover:text-green-900 mr-2",title:"Confirm Viewing",children:a.jsx(o.l_A,{className:"h-5 w-5"})}),a.jsx("button",{onClick:()=>"confirmed"===e.status?updateViewingStatus(e.id,"completed"):null,className:`${"confirmed"===e.status?"text-blue-600 hover:text-blue-900":"text-gray-300"} mr-2`,disabled:"confirmed"!==e.status,title:"Mark Completed",children:a.jsx(o.iCz,{className:"h-5 w-5"})}),a.jsx("button",{onClick:()=>["requested","options_sent","slot_selected","confirmed"].includes(e.status)?updateViewingStatus(e.id,"cancelled"):null,className:`${["requested","options_sent","slot_selected","confirmed"].includes(e.status)?"text-red-600 hover:text-red-900":"text-gray-300"}`,disabled:!["requested","options_sent","slot_selected","confirmed"].includes(e.status),title:"Cancel Viewing",children:a.jsx(o.aHS,{className:"h-5 w-5"})})]})]},e.id))})]})})}),v&&y&&a.jsx("div",{className:"fixed inset-0 overflow-y-auto z-50",children:(0,a.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[a.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",onClick:()=>w(!1),children:a.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),a.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,a.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[a.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:a.jsx("div",{className:"sm:flex sm:items-start",children:(0,a.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[a.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Viewing Details"}),(0,a.jsxs)("div",{className:"mt-4 border-t border-gray-200 pt-4",children:[a.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Property Information"}),(0,a.jsxs)("div",{className:"mt-2 flex items-center",children:[a.jsx("div",{className:"flex-shrink-0 h-14 w-14",children:a.jsx("img",{className:"h-14 w-14 rounded-md object-cover",src:y.property?.featured_image||"https://via.placeholder.com/100?text=No+Image",alt:""})}),(0,a.jsxs)("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:y.property?.title||"Unnamed Property"}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[a.jsx(o.Nh4,{className:"mr-1 h-3 w-3"}),y.property?.location||"No location"]}),a.jsx("div",{className:"mt-1",children:a.jsx("a",{href:`/properties/${y.property_id}`,className:"text-xs text-primary hover:text-primary/80",target:"_blank",rel:"noopener noreferrer",children:"View Property"})})]})]})]}),(0,a.jsxs)("div",{className:"mt-4 border-t border-gray-200 pt-4",children:[a.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Customer Information"}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900 flex items-center",children:[a.jsx(o.Xws,{className:"mr-2 h-4 w-4 text-gray-400"}),y.profile?.name||"Unknown User"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 flex items-center mt-1",children:[a.jsx(o.SRX,{className:"mr-2 h-4 w-4 text-gray-400"}),y.profile?.email||"No email"]}),y.profile?.phone&&(0,a.jsxs)("div",{className:"text-sm text-gray-500 flex items-center mt-1",children:[a.jsx(o.I7T,{className:"mr-2 h-4 w-4 text-gray-400"}),y.profile.phone]})]})]}),(0,a.jsxs)("div",{className:"mt-4 border-t border-gray-200 pt-4",children:[a.jsx("h4",{className:"text-md font-medium text-gray-900",children:"Appointment Details"}),(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Date"}),a.jsx("div",{className:"text-sm text-gray-900",children:formatDate(y.viewing_date)})]}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Time"}),a.jsx("div",{className:"text-sm text-gray-900",children:formatTime(y.viewing_date)})]}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Status"}),a.jsx("div",{className:"text-sm text-gray-900",children:getStatusBadge(y.status)})]})]}),"options_sent"===y.status&&y.proposed_dates&&y.proposed_times&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 rounded-md",children:[a.jsx("h5",{className:"text-sm font-medium text-blue-800 mb-2",children:"Proposed Times"}),(0,a.jsxs)("div",{className:"text-sm text-blue-700",children:[(0,a.jsxs)("p",{className:"mb-1",children:[a.jsx("span",{className:"font-medium",children:"Dates:"})," ",Array.isArray(y.proposed_dates)&&y.proposed_dates.map(e=>new Date(e).toLocaleDateString()).join(", ")]}),(0,a.jsxs)("p",{children:[a.jsx("span",{className:"font-medium",children:"Times:"})," ",Array.isArray(y.proposed_times)&&y.proposed_times.join(", ")]})]})]}),"slot_selected"===y.status&&y.selected_date&&y.selected_time&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-purple-50 rounded-md",children:[a.jsx("h5",{className:"text-sm font-medium text-purple-800 mb-2",children:"Selected Time"}),(0,a.jsxs)("div",{className:"text-sm text-purple-700",children:[(0,a.jsxs)("p",{className:"mb-1",children:[a.jsx("span",{className:"font-medium",children:"Date:"})," ",new Date(y.selected_date).toLocaleDateString()]}),(0,a.jsxs)("p",{children:[a.jsx("span",{className:"font-medium",children:"Time:"})," ",y.selected_time]})]})]}),y.notes&&(0,a.jsxs)("div",{className:"mt-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Notes"}),a.jsx("div",{className:"text-sm text-gray-900 mt-1 bg-gray-50 p-2 rounded",children:y.notes})]})]})]})})}),(0,a.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[a.jsx("button",{type:"button",onClick:()=>w(!1),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Close"}),"requested"===y.status&&(0,a.jsxs)("button",{type:"button",onClick:()=>{w(!1),openProposeModal(y)},className:"ml-3 w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:[a.jsx(o.qyc,{className:"mr-2 h-4 w-4"}),"Propose Times"]}),"slot_selected"===y.status&&(0,a.jsxs)("button",{type:"button",onClick:()=>{updateViewingStatus(y.id,"confirmed"),w(!1)},className:"ml-3 w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:ml-3 sm:w-auto sm:text-sm",children:[a.jsx(o.l_A,{className:"mr-2 h-4 w-4"}),"Confirm Viewing"]}),"confirmed"===y.status&&(0,a.jsxs)("button",{type:"button",onClick:()=>{updateViewingStatus(y.id,"completed"),w(!1)},className:"ml-3 w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:[a.jsx(o.iCz,{className:"mr-2 h-4 w-4"}),"Mark Completed"]}),["requested","options_sent","slot_selected","confirmed"].includes(y.status)&&(0,a.jsxs)("button",{type:"button",onClick:()=>{updateViewingStatus(y.id,"cancelled"),w(!1)},className:"ml-3 w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",children:[a.jsx(o.aHS,{className:"mr-2 h-4 w-4"}),"Cancel Viewing"]})]})]})]})}),y&&a.jsx(ProposeViewingSlotsModal,{isOpen:b,onClose:()=>N(!1),viewingId:y.id,propertyTitle:y.property?.title||"Property"})]})}},5454:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>l,__esModule:()=>i,default:()=>o});var a=t(5153);let r=(0,a.createProxy)(String.raw`E:\bigdealegy\bigdealegy\frontend\src\app\sales-ops\scheduled-viewings\page.tsx`),{__esModule:i,$$typeof:l}=r,n=r.default,o=n}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[657,4043,2076,1332,3500,7686,1407,2070,549,5846,2522,2718,2308],()=>__webpack_exec__(1888));module.exports=t})();