"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1907],{4734:function(e,r,t){t.d(r,{Z:function(){return Button}});var o=t(7437);t(2265);var n=t(1396),a=t.n(n);function LoadingSpinner(e){let{size:r="medium",color:t="primary",className:n=""}=e;return(0,o.jsx)("div",{className:"flex justify-center items-center ".concat(n),children:(0,o.jsx)("div",{className:"\n          rounded-full\n          animate-spin\n          ".concat({small:"h-4 w-4 border-2",medium:"h-8 w-8 border-2",large:"h-12 w-12 border-3"}[r],"\n          ").concat({primary:"border-primary-300 border-t-primary",white:"border-gray-200 border-t-white",gray:"border-gray-200 border-t-gray-600"}[t],"\n        ")})})}function Button(e){let{children:r,variant:t="primary",size:n="md",fullWidth:i=!1,href:s,loading:c=!1,outline:l=!1,rounded:d=!0,glass:u=!1,animation:h="none",className:g="",leftIcon:w,rightIcon:p,...v}=e,y=v.disabled?"opacity-60 cursor-not-allowed":"transform active:scale-[0.98] transition-transform",m="\n    inline-flex items-center justify-center\n    font-medium\n    transition-all duration-200\n    focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\n    ".concat({primary:l?"border-2 border-primary-500 text-primary-600 hover:bg-primary-50 active:bg-primary-100":"bg-primary-600 hover:bg-primary-700 text-white shadow-sm",secondary:l?"border-2 border-gray-400 text-gray-700 hover:bg-gray-50 active:bg-gray-100":"bg-gray-600 hover:bg-gray-700 text-white shadow-sm",success:l?"border-2 border-green-500 text-green-600 hover:bg-green-50 active:bg-green-100":"bg-green-600 hover:bg-green-700 text-white shadow-sm",danger:l?"border-2 border-red-500 text-red-600 hover:bg-red-50 active:bg-red-100":"bg-red-600 hover:bg-red-700 text-white shadow-sm",warning:l?"border-2 border-amber-500 text-amber-600 hover:bg-amber-50 active:bg-amber-100":"bg-amber-500 hover:bg-amber-600 text-white shadow-sm",info:l?"border-2 border-blue-400 text-blue-500 hover:bg-blue-50 active:bg-blue-100":"bg-blue-500 hover:bg-blue-600 text-white shadow-sm",light:l?"border-2 border-gray-200 text-gray-600 hover:bg-gray-50 active:bg-gray-100":"bg-gray-100 hover:bg-gray-200 text-gray-800",dark:l?"border-2 border-gray-700 text-gray-800 hover:bg-gray-800 hover:text-white":"bg-gray-800 hover:bg-gray-900 text-white shadow-sm",outline:"border-2 border-gray-300 text-gray-700 hover:border-primary-500 hover:text-primary-600 bg-white",gradient:"bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white shadow-sm"}[t],"\n    ").concat({xs:"text-xs px-2.5 py-1.5 gap-1",sm:"text-sm px-3 py-2 gap-1.5",md:"text-base px-4 py-2.5 gap-2",lg:"text-lg px-5 py-3 gap-2",xl:"text-xl px-6 py-3.5 gap-2.5"}[n],"\n    ").concat(i?"w-full":"","\n    ").concat(d?"rounded-full":"rounded-lg","\n    ").concat(u?"backdrop-blur-sm bg-opacity-80 shadow-sm":"","\n    ").concat({none:"",pulse:"animate-pulse",bounce:"animate-bounce"}[h],"\n    ").concat(y,"\n    ").concat(g,"\n  ");return s?(0,o.jsxs)(a(),{href:s,className:m,children:[w&&(0,o.jsx)("span",{className:"flex items-center",children:w}),r,p&&(0,o.jsx)("span",{className:"flex items-center",children:p})]}):(0,o.jsxs)("button",{className:m,disabled:c||v.disabled,...v,children:[c?(0,o.jsx)(LoadingSpinner,{size:"small",color:l?"primary":"white"}):w?(0,o.jsx)("span",{className:"flex items-center",children:w}):null,(0,o.jsx)("span",{children:r}),p&&!c&&(0,o.jsx)("span",{className:"flex items-center",children:p})]})}},5243:function(e,r,t){t.d(r,{a:function(){return useAuth}});var o=t(4523);function useAuth(){var e;let r=(0,o.useAuth)(),t=(null===(e=r.user)||void 0===e?void 0:e.role)||"customer",signIn=async(e,t)=>{try{return await r.signIn(e,t),{error:null}}catch(e){return{error:e}}},signUp=async(e,t,o)=>{try{return await r.signUp(e,t,o),{error:null}}catch(e){return{error:e}}};return{...r,role:t,signIn,signUp}}},2749:function(e,r,t){t.d(r,{G:function(){return cancelScheduledViewing},G9:function(){return confirmScheduledViewing},Jt:function(){return completeScheduledViewing},U4:function(){return getScheduledViewings},pz:function(){return updateScheduledViewing}});let o="bigdealegypt.up.railway.app/api",getScheduledViewings=async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let n=new URLSearchParams;for(let[e,t]of Object.entries(r))null!=t&&(Array.isArray(t)?n.append(e,t.join(",")):n.append(e,t.toString()));n.has("viewAll")||"customer"===r.role?n.has("viewAll")||n.append("viewAll","false"):n.append("viewAll","true"),n.append("_t",Date.now());let a=await fetch("".concat(o,"/scheduled-viewings?").concat(n.toString()),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json","Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}});if(!a.ok){var t;let e=await a.json();throw Error((null===(t=e.error)||void 0===t?void 0:t.message)||"Failed to fetch scheduled viewings")}return await a.json()}catch(e){throw console.error("Get scheduled viewings error:",e),e}},getScheduledViewingById=async(e,r)=>{try{let n=await fetch("".concat(o,"/scheduled-viewings/").concat(r),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},credentials:"include"});if(!n.ok){var t;let e=await n.json();throw Error((null===(t=e.error)||void 0===t?void 0:t.message)||"Failed to fetch scheduled viewing")}return await n.json()}catch(e){throw console.error("Get scheduled viewing by ID error:",e),e}},createScheduledViewing=async(e,r)=>{try{let n=await fetch("".concat(o,"/scheduled-viewings"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(r),credentials:"include"});if(!n.ok){var t;let e=await n.json();throw Error((null===(t=e.error)||void 0===t?void 0:t.message)||"Failed to create scheduled viewing")}return await n.json()}catch(e){throw console.error("Create scheduled viewing error:",e),e}},updateScheduledViewing=async(e,r,t)=>{try{let a=await fetch("".concat(o,"/scheduled-viewings/").concat(r),{method:"PUT",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!a.ok){var n;let e=await a.json();throw Error((null===(n=e.error)||void 0===n?void 0:n.message)||"Failed to update scheduled viewing")}return await a.json()}catch(e){throw console.error("Update scheduled viewing error:",e),e}},deleteScheduledViewing=async(e,r)=>{try{let n=await fetch("".concat(o,"/scheduled-viewings/").concat(r),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},credentials:"include"});if(!n.ok){var t;let e=await n.json();throw Error((null===(t=e.error)||void 0===t?void 0:t.message)||"Failed to delete scheduled viewing")}return await n.json()}catch(e){throw console.error("Delete scheduled viewing error:",e),e}},cancelScheduledViewing=async function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let a=await fetch("".concat(o,"/scheduled-viewings/").concat(r,"/cancel"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!a.ok){var n;let e=await a.json();throw Error((null===(n=e.error)||void 0===n?void 0:n.message)||"Failed to cancel scheduled viewing")}return await a.json()}catch(e){throw console.error("Cancel scheduled viewing error:",e),e}},confirmScheduledViewing=async(e,r,t)=>{try{let a=await fetch("".concat(o,"/scheduled-viewings/").concat(r,"/confirm"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!a.ok){var n;let e=await a.json();throw Error((null===(n=e.error)||void 0===n?void 0:n.message)||"Failed to confirm scheduled viewing")}return await a.json()}catch(e){throw console.error("Confirm scheduled viewing error:",e),e}},completeScheduledViewing=async function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let a=await fetch("".concat(o,"/scheduled-viewings/").concat(r,"/complete"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!a.ok){var n;let e=await a.json();throw Error((null===(n=e.error)||void 0===n?void 0:n.message)||"Failed to complete scheduled viewing")}return await a.json()}catch(e){throw console.error("Complete scheduled viewing error:",e),e}},proposeViewingSlots=async(e,r,t)=>{try{let a=await fetch("".concat(o,"/scheduled-viewings/").concat(r,"/propose-slots"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!a.ok){var n;let e=await a.json();throw Error((null===(n=e.error)||void 0===n?void 0:n.message)||"Failed to propose viewing slots")}return await a.json()}catch(e){throw console.error("Propose viewing slots error:",e),e}},selectViewingSlot=async(e,r,t)=>{try{let a=await fetch("".concat(o,"/scheduled-viewings/").concat(r,"/select-slot"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!a.ok){var n;let e=await a.json();throw Error((null===(n=e.error)||void 0===n?void 0:n.message)||"Failed to select viewing slot")}return await a.json()}catch(e){throw console.error("Select viewing slot error:",e),e}};r.ZP={getScheduledViewings,getScheduledViewingById,createScheduledViewing,updateScheduledViewing,deleteScheduledViewing,cancelScheduledViewing,confirmScheduledViewing,completeScheduledViewing,proposeViewingSlots,selectViewingSlot}},4523:function(e,r,t){t.r(r),t.d(r,{AuthProvider:function(){return AuthProvider},default:function(){return l},useAuth:function(){return useAuth}});var o=t(7437),n=t(2265);let a="bigdealegypt.up.railway.app/api",signIn=async(e,r)=>{try{let o=await fetch("".concat(a,"/auth/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r}),credentials:"include"});if(!o.ok){var t;let e=await o.json();throw Error((null===(t=e.error)||void 0===t?void 0:t.message)||"Authentication failed")}return await o.json()}catch(e){throw console.error("Sign in error:",e),e}},signUp=async(e,r,t)=>{try{let n=await fetch("".concat(a,"/auth/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r,name:t})});if(!n.ok){var o;let e=await n.json();throw Error((null===(o=e.error)||void 0===o?void 0:o.message)||"Registration failed")}return await n.json()}catch(e){throw console.error("Sign up error:",e),e}},signOut=async()=>{try{let r=await fetch("".concat(a,"/auth/signout"),{method:"POST",credentials:"include"});if(!r.ok){var e;let t=await r.json();throw Error((null===(e=t.error)||void 0===e?void 0:e.message)||"Sign out failed")}return await r.json()}catch(e){throw console.error("Sign out error:",e),e}},getSession=async e=>{try{let t=await fetch("".concat(a,"/auth/session"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)},credentials:"include"});if(!t.ok){var r;let e=await t.json();throw Error((null===(r=e.error)||void 0===r?void 0:r.message)||"Failed to retrieve session")}return await t.json()}catch(e){throw console.error("Get session error:",e),e}},refreshToken=async()=>{try{let r=await fetch("".concat(a,"/auth/refresh-token"),{method:"POST",credentials:"include"});if(!r.ok){var e;let t=await r.json();throw Error((null===(e=t.error)||void 0===e?void 0:e.message)||"Failed to refresh token")}return await r.json()}catch(e){throw console.error("Refresh token error:",e),e}},getUserProfile=async(e,r)=>{try{let o=await fetch("".concat(a,"/auth/profile/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(r)}});if(!o.ok){var t;let e=await o.json();throw Error((null===(t=e.error)||void 0===t?void 0:t.message)||"Failed to get user profile")}return await o.json()}catch(e){throw console.error("Get user profile error:",e),e}};var i={signIn,signUp,signOut,getSession,refreshToken,getUserProfile},s=t(4033);let c=(0,n.createContext)(void 0),AuthProvider=e=>{let{children:r}=e,[t,a]=(0,n.useState)(null),[l,d]=(0,n.useState)(null),[u,h]=(0,n.useState)(!0),[g,w]=(0,n.useState)(null),p=(0,s.useRouter)();(0,n.useEffect)(()=>{if(l){let e=new Date(l.expires_at).getTime(),r=Date.now(),t=e-r;if(t<3e5){refreshSession();return}let o=setTimeout(()=>{refreshSession()},t-3e5);return()=>clearTimeout(o)}},[l]),(0,n.useEffect)(()=>{let initAuth=async()=>{h(!0),w(null);try{let e=localStorage.getItem("access_token");if(!e){h(!1);return}let r=await i.getSession(e);(null==r?void 0:r.user)&&(null==r?void 0:r.session)?(a(r.user),d(r.session),localStorage.setItem("access_token",r.session.access_token)):localStorage.removeItem("access_token")}catch(e){console.error("Auth initialization error:",e),localStorage.removeItem("access_token"),w("Authentication error. Please login again.")}finally{h(!1)}};initAuth()},[]);let signIn=async(e,r)=>{h(!0),w(null);try{let t=await i.signIn(e,r);(null==t?void 0:t.user)&&(null==t?void 0:t.session)&&(a(t.user),d(t.session),localStorage.setItem("access_token",t.session.access_token),p.push("/dashboard"))}catch(e){throw console.error("Sign in error:",e),w(e instanceof Error?e.message:"Authentication failed"),e}finally{h(!1)}},signUp=async(e,r,t)=>{h(!0),w(null);try{let o=await i.signUp(e,r,t);(null==o?void 0:o.user)&&p.push("/login?registered=true")}catch(e){throw console.error("Sign up error:",e),w(e instanceof Error?e.message:"Registration failed"),e}finally{h(!1)}},signOut=async()=>{h(!0);try{await i.signOut(),a(null),d(null),localStorage.removeItem("access_token"),p.push("/")}catch(e){console.error("Sign out error:",e),a(null),d(null),localStorage.removeItem("access_token"),p.push("/")}finally{h(!1)}},refreshSession=async()=>{if(!u)try{let e=await i.refreshToken();(null==e?void 0:e.user)&&(null==e?void 0:e.session)?(a(e.user),d(e.session),localStorage.setItem("access_token",e.session.access_token)):(a(null),d(null),localStorage.removeItem("access_token"),p.push("/login"))}catch(e){console.error("Session refresh error:",e),a(null),d(null),localStorage.removeItem("access_token"),p.push("/login")}};return(0,o.jsx)(c.Provider,{value:{user:t,session:l,loading:u,error:g,isAuthenticated:!!t,signIn,signUp,signOut,refreshSession},children:r})},useAuth=()=>{let e=(0,n.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e};var l=c}}]);