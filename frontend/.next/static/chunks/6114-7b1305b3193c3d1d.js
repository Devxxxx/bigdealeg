(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6114],{6114:function(e,t,r){"use strict";r.d(t,{Z:function(){return Navbar}});var s=r(7437),a=r(2265),i=r(1396),n=r.n(i),o=r(4033),l=r(8920),c=r(5243);function Navbar(e){var t,r;let{toggleSidebar:i,isSidebarCollapsed:d}=e,[m,h]=(0,a.useState)(!1),[u,x]=(0,a.useState)(!1),[g,p]=(0,a.useState)(!1),[f,y]=(0,a.useState)([{id:1,message:"New property match found for your request",isRead:!1,time:"2 hours ago"},{id:2,message:"Viewing scheduled for tomorrow at 2:00 PM",isRead:!1,time:"5 hours ago"},{id:3,message:"Price update for your saved property",isRead:!0,time:"Yesterday"}]),b=(0,o.usePathname)(),{user:v,role:w,signOut:j}=(0,c.a)();(0,a.useEffect)(()=>{let handleOutsideClick=e=>{let t=e.target;m&&!t.closest(".user-dropdown")&&h(!1),u&&!t.closest(".notifications-dropdown")&&x(!1)};return document.addEventListener("mousedown",handleOutsideClick),()=>document.removeEventListener("mousedown",handleOutsideClick)},[m,u]),(0,a.useEffect)(()=>{p(!1)},[b]);let N=f.filter(e=>!e.isRead).length,k=b.includes("/dashboard")||b.includes("/admin")||b.includes("/sales-ops"),getCurrentSection=()=>b.startsWith("/dashboard")?"dashboard":b.startsWith("/admin")?"admin":b.startsWith("/sales-ops")?"sales-ops":"",getRoleSpecificText=e=>"newButton"===e?b.startsWith("/admin")||b.startsWith("/sales-ops")?"New Property":"New Request":"section"===e?b.startsWith("/admin")?"Admin":b.startsWith("/sales-ops")?"Sales":"Dashboard":"dashboardLink"===e?"admin"===w?"/admin":"sales_ops"===w?"/sales-ops":"/dashboard":"";return(0,s.jsxs)("header",{className:"bg-white shadow-sm z-10 sticky top-0",children:[(0,s.jsxs)("div",{className:"max-w-screen-2xl mx-auto px-4 sm:px-6 flex h-16 justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("button",{onClick:i,className:"text-gray-500 hover:text-primary-600 transition-colors lg:hidden","aria-label":"Toggle menu",children:(0,s.jsx)(l.cur,{size:22})}),!k&&(0,s.jsxs)(n(),{href:"/",className:"flex items-center lg:hidden",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-primary-500 to-primary-700 rounded-lg flex items-center justify-center text-white font-bold text-base",children:"BD"}),(0,s.jsx)("span",{className:"ml-2 text-lg font-semibold text-gray-900",children:"BigDealEgypt"})]}),k&&(0,s.jsx)("div",{className:"flex items-center lg:hidden",children:(0,s.jsx)("span",{className:"text-base font-medium text-gray-900",children:getRoleSpecificText("section")})}),(0,s.jsxs)("div",{className:"relative max-w-md w-full hidden sm:block",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)(l.jRj,{className:"h-5 w-5 text-gray-400"})}),(0,s.jsx)("input",{type:"text",placeholder:"Search...",className:"block w-full bg-gray-50 border border-gray-200 rounded-lg py-2 pl-10 pr-3 text-sm placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),!k&&(0,s.jsxs)("nav",{className:"hidden lg:flex items-center space-x-1",children:[(0,s.jsx)(n(),{href:"/",className:"px-3 py-2 rounded-lg text-sm font-medium ".concat("/"===b?"text-primary-700":"text-gray-600 hover:text-gray-900"," transition-colors"),children:"Home"}),(0,s.jsx)(n(),{href:"/about",className:"px-3 py-2 rounded-lg text-sm font-medium ".concat("/about"===b?"text-primary-700":"text-gray-600 hover:text-gray-900"," transition-colors"),children:"About"}),(0,s.jsx)(n(),{href:"/contact",className:"px-3 py-2 rounded-lg text-sm font-medium ".concat("/contact"===b?"text-primary-700":"text-gray-600 hover:text-gray-900"," transition-colors"),children:"Contact"})]}),(0,s.jsx)("div",{className:"flex items-center space-x-2 sm:space-x-3",children:v?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"relative notifications-dropdown",children:[(0,s.jsxs)("button",{className:"p-2 text-gray-600 hover:text-primary-600 hover:bg-gray-100 rounded-lg transition-all relative",onClick:()=>{x(!u),h(!1)},"aria-label":"Notifications",children:[(0,s.jsx)(l.vWP,{size:20}),N>0&&(0,s.jsx)("span",{className:"absolute top-0 right-0 bg-primary-600 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full border-2 border-white",children:N})]}),u&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[(0,s.jsxs)("div",{className:"p-3 border-b border-gray-200 flex justify-between items-center",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Notifications"}),(0,s.jsx)("button",{className:"text-xs text-primary-600 hover:text-primary-700",onClick:()=>{y(e=>e.map(e=>({...e,isRead:!0})))},children:"Mark all as read"})]}),(0,s.jsx)("div",{className:"max-h-80 overflow-y-auto",children:f.length>0?f.map(e=>(0,s.jsxs)("div",{className:"p-3 border-b border-gray-100 ".concat(e.isRead?"":"bg-primary-50"),children:[(0,s.jsx)("p",{className:"text-sm ".concat(e.isRead?"text-gray-600":"text-gray-900 font-medium"),children:e.message}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.time})]},e.id)):(0,s.jsx)("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No notifications"})}),(0,s.jsx)("div",{className:"p-3 text-center",children:(0,s.jsx)(n(),{href:"".concat(getRoleSpecificText("dashboardLink"),"/notifications"),className:"text-sm text-primary-600 hover:text-primary-700 font-medium",onClick:()=>x(!1),children:"View all notifications"})})]})]}),k&&(0,s.jsxs)(n(),{href:(()=>{let e=getCurrentSection();return"dashboard"===e?"/dashboard/property-requests/new":"sales-ops"===e?"/sales-ops/properties/new":"admin"===e?"/admin/properties/new":"/dashboard/property-requests/new"})(),className:"bg-primary-600 hover:bg-primary-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition-colors shadow-sm flex items-center",children:[(0,s.jsx)(l.OvN,{className:"mr-1.5"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:getRoleSpecificText("newButton")}),(0,s.jsx)("span",{className:"sm:hidden",children:"New"})]}),(0,s.jsxs)("div",{className:"relative user-dropdown",children:[(0,s.jsxs)("button",{onClick:()=>{h(!m),x(!1)},className:"flex items-center bg-gray-50 hover:bg-gray-100 border border-gray-200 rounded-lg p-1.5 pr-3 transition-colors",children:[(0,s.jsx)("div",{className:"w-7 h-7 bg-primary-100 rounded-lg flex items-center justify-center text-primary-700 font-medium text-sm mr-2",children:(null==v?void 0:null===(t=v.name)||void 0===t?void 0:t.charAt(0).toUpperCase())||"U"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700 hidden sm:block mr-1",children:(null==v?void 0:null===(r=v.name)||void 0===r?void 0:r.split(" ")[0])||"User"}),(0,s.jsx)(l.bTu,{size:16,className:"text-gray-500"})]}),m&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 z-50 overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-4 py-3 border-b border-gray-100",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:(null==v?void 0:v.name)||"User"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:(null==v?void 0:v.email)||"user@example.com"})]}),(0,s.jsxs)("div",{className:"py-1",children:[(0,s.jsxs)(n(),{href:getRoleSpecificText("dashboardLink"),className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>h(!1),children:[(0,s.jsx)(l.fzv,{className:"mr-3 h-4 w-4 text-gray-500"}),"Dashboard"]}),(0,s.jsxs)(n(),{href:"".concat(getRoleSpecificText("dashboardLink"),"/settings"),className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>h(!1),children:[(0,s.jsx)(l.nbt,{className:"mr-3 h-4 w-4 text-gray-500"}),"Settings"]}),(0,s.jsxs)(n(),{href:"/help",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>h(!1),children:[(0,s.jsx)(l.bax,{className:"mr-3 h-4 w-4 text-gray-500"}),"Help & Support"]})]}),(0,s.jsx)("div",{className:"py-1 border-t border-gray-100",children:(0,s.jsxs)("button",{className:"flex w-full items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50",onClick:async()=>{h(!1),Object.keys(localStorage).forEach(e=>{(e.includes("supabase")||e.includes("sb-"))&&localStorage.removeItem(e)});try{await j()}catch(e){console.error("Navbar logout error:",e),window.location.href="/"}},children:[(0,s.jsx)(l.xqh,{className:"mr-3 h-4 w-4 text-red-500"}),"Sign out"]})})]})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{className:"lg:hidden p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100",onClick:()=>p(!g),"aria-label":"Menu",children:(0,s.jsx)(l.cur,{size:22})}),(0,s.jsx)("div",{className:"hidden sm:flex items-center space-x-2",children:(0,s.jsx)(n(),{href:"/register",className:"bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors shadow-sm",children:"Get Started"})})]})})]}),g&&!v&&(0,s.jsxs)("div",{className:"lg:hidden",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:()=>p(!1)}),(0,s.jsxs)("div",{className:"fixed inset-y-0 right-0 max-w-xs w-full bg-white shadow-xl z-50 overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-primary-500 to-primary-700 rounded-lg flex items-center justify-center text-white font-bold text-base",children:"BD"}),(0,s.jsx)("span",{className:"ml-2 text-lg font-semibold text-gray-900",children:"BigDealEgypt"})]}),(0,s.jsx)("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-gray-900","aria-label":"Close menu",children:(0,s.jsx)(l.q5L,{size:24})})]}),(0,s.jsxs)("div",{className:"py-2",children:[(0,s.jsxs)(n(),{href:"/",className:"flex items-center px-4 py-3 text-base font-medium ".concat("/"===b?"text-primary-700":"text-gray-900"),onClick:()=>p(!1),children:[(0,s.jsx)(l.m6D,{className:"mr-3 h-5 w-5"}),"Home"]}),(0,s.jsxs)(n(),{href:"/properties",className:"flex items-center px-4 py-3 text-base font-medium ".concat(b.startsWith("/properties")?"text-primary-700":"text-gray-900"),onClick:()=>p(!1),children:[(0,s.jsx)(l.m6D,{className:"mr-3 h-5 w-5"}),"Properties"]}),(0,s.jsxs)(n(),{href:"/about",className:"flex items-center px-4 py-3 text-base font-medium ".concat("/about"===b?"text-primary-700":"text-gray-900"),onClick:()=>p(!1),children:[(0,s.jsx)(l.H33,{className:"mr-3 h-5 w-5"}),"About"]}),(0,s.jsxs)(n(),{href:"/contact",className:"flex items-center px-4 py-3 text-base font-medium ".concat("/contact"===b?"text-primary-700":"text-gray-900"),onClick:()=>p(!1),children:[(0,s.jsx)(l.IC0,{className:"mr-3 h-5 w-5"}),"Contact"]})]}),(0,s.jsx)("div",{className:"mt-4 px-4 py-3 border-t border-gray-200",children:(0,s.jsx)(n(),{href:"/register",className:"w-full flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-primary-600 hover:bg-primary-700",onClick:()=>p(!1),children:"Get Started"})})]})]})]})}},5243:function(e,t,r){"use strict";r.d(t,{a:function(){return useAuth}});var s=r(4523);function useAuth(){var e;let t=(0,s.useAuth)(),r=(null===(e=t.user)||void 0===e?void 0:e.role)||"customer",signIn=async(e,r)=>{try{return await t.signIn(e,r),{error:null}}catch(e){return{error:e}}},signUp=async(e,r,s)=>{try{return await t.signUp(e,r,s),{error:null}}catch(e){return{error:e}}};return{...t,role:r,signIn,signUp}}},4523:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return AuthProvider},default:function(){return c},useAuth:function(){return useAuth}});var s=r(7437),a=r(2265);let i="bigdealegypt.up.railway.app/api",signIn=async(e,t)=>{try{let s=await fetch("".concat(i,"/auth/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t}),credentials:"include"});if(!s.ok){var r;let e=await s.json();throw Error((null===(r=e.error)||void 0===r?void 0:r.message)||"Authentication failed")}return await s.json()}catch(e){throw console.error("Sign in error:",e),e}},signUp=async(e,t,r)=>{try{let a=await fetch("".concat(i,"/auth/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,name:r})});if(!a.ok){var s;let e=await a.json();throw Error((null===(s=e.error)||void 0===s?void 0:s.message)||"Registration failed")}return await a.json()}catch(e){throw console.error("Sign up error:",e),e}},signOut=async()=>{try{let t=await fetch("".concat(i,"/auth/signout"),{method:"POST",credentials:"include"});if(!t.ok){var e;let r=await t.json();throw Error((null===(e=r.error)||void 0===e?void 0:e.message)||"Sign out failed")}return await t.json()}catch(e){throw console.error("Sign out error:",e),e}},getSession=async e=>{try{let r=await fetch("".concat(i,"/auth/session"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)},credentials:"include"});if(!r.ok){var t;let e=await r.json();throw Error((null===(t=e.error)||void 0===t?void 0:t.message)||"Failed to retrieve session")}return await r.json()}catch(e){throw console.error("Get session error:",e),e}},refreshToken=async()=>{try{let t=await fetch("".concat(i,"/auth/refresh-token"),{method:"POST",credentials:"include"});if(!t.ok){var e;let r=await t.json();throw Error((null===(e=r.error)||void 0===e?void 0:e.message)||"Failed to refresh token")}return await t.json()}catch(e){throw console.error("Refresh token error:",e),e}},getUserProfile=async(e,t)=>{try{let s=await fetch("".concat(i,"/auth/profile/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});if(!s.ok){var r;let e=await s.json();throw Error((null===(r=e.error)||void 0===r?void 0:r.message)||"Failed to get user profile")}return await s.json()}catch(e){throw console.error("Get user profile error:",e),e}};var n={signIn,signUp,signOut,getSession,refreshToken,getUserProfile},o=r(4033);let l=(0,a.createContext)(void 0),AuthProvider=e=>{let{children:t}=e,[r,i]=(0,a.useState)(null),[c,d]=(0,a.useState)(null),[m,h]=(0,a.useState)(!0),[u,x]=(0,a.useState)(null),g=(0,o.useRouter)();(0,a.useEffect)(()=>{if(c){let e=new Date(c.expires_at).getTime(),t=Date.now(),r=e-t;if(r<3e5){refreshSession();return}let s=setTimeout(()=>{refreshSession()},r-3e5);return()=>clearTimeout(s)}},[c]),(0,a.useEffect)(()=>{let initAuth=async()=>{h(!0),x(null);try{let e=localStorage.getItem("access_token");if(!e){h(!1);return}let t=await n.getSession(e);(null==t?void 0:t.user)&&(null==t?void 0:t.session)?(i(t.user),d(t.session),localStorage.setItem("access_token",t.session.access_token)):localStorage.removeItem("access_token")}catch(e){console.error("Auth initialization error:",e),localStorage.removeItem("access_token"),x("Authentication error. Please login again.")}finally{h(!1)}};initAuth()},[]);let signIn=async(e,t)=>{h(!0),x(null);try{let r=await n.signIn(e,t);(null==r?void 0:r.user)&&(null==r?void 0:r.session)&&(i(r.user),d(r.session),localStorage.setItem("access_token",r.session.access_token),g.push("/dashboard"))}catch(e){throw console.error("Sign in error:",e),x(e instanceof Error?e.message:"Authentication failed"),e}finally{h(!1)}},signUp=async(e,t,r)=>{h(!0),x(null);try{let s=await n.signUp(e,t,r);(null==s?void 0:s.user)&&g.push("/login?registered=true")}catch(e){throw console.error("Sign up error:",e),x(e instanceof Error?e.message:"Registration failed"),e}finally{h(!1)}},signOut=async()=>{h(!0);try{await n.signOut(),i(null),d(null),localStorage.removeItem("access_token"),g.push("/")}catch(e){console.error("Sign out error:",e),i(null),d(null),localStorage.removeItem("access_token"),g.push("/")}finally{h(!1)}},refreshSession=async()=>{if(!m)try{let e=await n.refreshToken();(null==e?void 0:e.user)&&(null==e?void 0:e.session)?(i(e.user),d(e.session),localStorage.setItem("access_token",e.session.access_token)):(i(null),d(null),localStorage.removeItem("access_token"),g.push("/login"))}catch(e){console.error("Session refresh error:",e),i(null),d(null),localStorage.removeItem("access_token"),g.push("/login")}};return(0,s.jsx)(l.Provider,{value:{user:r,session:c,loading:m,error:u,isAuthenticated:!!r,signIn,signUp,signOut,refreshSession},children:t})},useAuth=()=>{let e=(0,a.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e};var c=l},4033:function(e,t,r){e.exports=r(94)}}]);