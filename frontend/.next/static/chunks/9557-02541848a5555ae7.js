"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9557],{9557:function(e,s,t){t.d(s,{Z:function(){return Sidebar}});var i=t(7437),r=t(2265),a=t(1396),o=t.n(a),n=t(4033),l=t(8920),c=t(5243);let getSidebarNotifications=async e=>{try{let t=Date.now(),i=await fetch("".concat("bigdealegypt.up.railway.app/api","/notifications/sidebar?_t=").concat(t),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"},credentials:"include"});if(!i.ok){var s;let e=await i.json();throw Error((null===(s=e.error)||void 0===s?void 0:s.message)||"Failed to fetch notifications")}let r=await i.json();return r.notifications}catch(e){return console.error("Get sidebar notifications error:",e),{propertyRequests:0,scheduledViewings:0,savedProperties:0,messages:0}}};var d={getSidebarNotifications};function useSidebarNotifications(){let[e,s]=(0,r.useState)({propertyRequests:0,scheduledViewings:0,savedProperties:0,messages:0}),[t,i]=(0,r.useState)(!0),{user:a,session:o}=(0,c.a)();return(0,r.useEffect)(()=>{let fetchNotifications=async()=>{if(!a||!(null==o?void 0:o.access_token)){i(!1);return}i(!0);try{let e=await d.getSidebarNotifications(o.access_token);s(e)}catch(e){console.error("Error fetching notification counts:",e),s({propertyRequests:0,scheduledViewings:0,savedProperties:0,messages:0})}finally{i(!1)}};fetchNotifications();let e=setInterval(fetchNotifications,12e4);return()=>{clearInterval(e)}},[a,o]),{notifications:e,loading:t}}let MenuItem=e=>{let{href:s,icon:t,label:r,isActive:a,isCollapsed:n,hasNotification:l,notificationCount:c}=e;return(0,i.jsxs)(o(),{href:s,className:"\n      flex items-center py-2.5 px-3 rounded-lg text-sm font-medium\n      ".concat(a?"bg-primary-50 text-primary-700":"text-gray-600 hover:bg-gray-100 hover:text-gray-900","\n      ").concat(n?"justify-center":"","\n      transition-all duration-200\n    "),children:[(0,i.jsxs)("div",{className:"".concat(a?"text-primary-600":"text-gray-500"," relative"),children:[t,l&&!n&&(0,i.jsx)("span",{className:"absolute -top-1.5 -right-1.5 bg-primary-600 text-white text-xs w-4 h-4 flex items-center justify-center rounded-full",children:c||""}),l&&n&&(0,i.jsx)("span",{className:"absolute -top-1 -right-1 bg-primary-600 w-2 h-2 rounded-full"})]}),!n&&(0,i.jsx)("span",{className:"ml-3",children:r}),!n&&l&&c&&(0,i.jsx)("span",{className:"ml-auto bg-primary-100 text-primary-700 text-xs px-1.5 py-0.5 rounded-full",children:c})]})},h=[{href:"/admin",icon:(0,i.jsx)(l.m6D,{size:20}),label:"Dashboard",role:"admin"},{href:"/admin/users",icon:(0,i.jsx)(l.WY8,{size:20}),label:"Users",role:"admin"},{href:"/admin/properties",icon:(0,i.jsx)(l.MIl,{size:20}),label:"Properties",role:"admin"},{href:"/admin/fields",icon:(0,i.jsx)(l.vPQ,{size:20}),label:"Form Fields",role:"admin"},{href:"/admin/analytics",icon:(0,i.jsx)(l.orK,{size:20}),label:"Analytics",role:"admin"}],m=[{href:"/sales-ops",icon:(0,i.jsx)(l.m6D,{size:20}),label:"Dashboard",role:"sales_ops"},{href:"/sales-ops/properties",icon:(0,i.jsx)(l.MIl,{size:20}),label:"Properties",role:"sales_ops"},{href:"/sales-ops/requests",icon:(0,i.jsx)(l.SnF,{size:20}),label:"Customer Requests",role:"sales_ops",hasNotification:!0},{href:"/sales-ops/scheduled-viewings",icon:(0,i.jsx)(l.vlc,{size:20}),label:"Viewings",role:"sales_ops",hasNotification:!0},{href:"/sales-ops/messages",icon:(0,i.jsx)(l.EQ9,{size:20}),label:"Messages",role:"sales_ops",hasNotification:!0}],u=[{href:"/dashboard",icon:(0,i.jsx)(l.m6D,{size:20}),label:"Dashboard",role:"customer"},{href:"/dashboard/property-requests",icon:(0,i.jsx)(l.SnF,{size:20}),label:"Property Requests",role:"customer",hasNotification:!0},{href:"/dashboard/scheduled-viewings",icon:(0,i.jsx)(l.vlc,{size:20}),label:"Scheduled Viewings",role:"customer",hasNotification:!0},{href:"/dashboard/saved-properties",icon:(0,i.jsx)(l.l1M,{size:20}),label:"Saved Properties",role:"customer",hasNotification:!0},{href:"/dashboard/activity",icon:(0,i.jsx)(l.TCC,{size:20}),label:"Activity History",role:"customer"}],f=[{href:"/",icon:(0,i.jsx)(l.m6D,{size:20}),label:"Home",role:""},{href:"/properties",icon:(0,i.jsx)(l.m6D,{size:20}),label:"Properties",role:""},{href:"/about",icon:(0,i.jsx)(l.H33,{size:20}),label:"About",role:""},{href:"/contact",icon:(0,i.jsx)(l.EQ9,{size:20}),label:"Contact",role:""}];function Sidebar(e){var s,t;let r;let{isCollapsed:a,toggleSidebar:d,sidebarType:p="customer"}=e,x=(0,n.usePathname)(),{user:b,role:g,signOut:y}=(0,c.a)(),{notifications:j,loading:v}=useSidebarNotifications(),N=(r=[],"admin"===g?r=h:"sales_ops"===g?r=m:"customer"===g&&(r=u),r.concat(f.filter(e=>!x.startsWith("/admin")&&!x.startsWith("/sales-ops")&&!x.startsWith("/dashboard")))),w=(()=>{let e="admin"===g?{href:"/admin/settings",icon:(0,i.jsx)(l.nbt,{size:20}),label:"Settings",role:"admin"}:"sales_ops"===g?{href:"/sales-ops/settings",icon:(0,i.jsx)(l.nbt,{size:20}),label:"Settings",role:"sales_ops"}:{href:"/dashboard/settings",icon:(0,i.jsx)(l.nbt,{size:20}),label:"Settings",role:"customer"},s={href:"/help",icon:(0,i.jsx)(l.bax,{size:20}),label:"Help & Support",role:""};return[e,s]})(),z=N.map(e=>{if(!e.hasNotification)return e;let s=0;return e.href.includes("property-requests")||e.href.includes("requests")?s=j.propertyRequests||0:e.href.includes("scheduled-viewings")||e.href.includes("viewings")?s=j.scheduledViewings||0:e.href.includes("saved-properties")?s=j.savedProperties||0:e.href.includes("messages")&&(s=j.messages||0),{...e,hasNotification:s>0,notificationCount:s}});return(0,i.jsxs)("div",{className:"h-full bg-white overflow-y-auto overflow-x-hidden border-r border-gray-200 shadow-sm",children:[(0,i.jsxs)("div",{className:"flex items-center ".concat(a?"justify-center":"px-4"," h-16 border-b border-gray-200"),children:[!a&&(0,i.jsxs)(o(),{href:"/",className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-primary-500 to-primary-700 rounded-lg flex items-center justify-center text-white font-bold text-xl shadow-sm",children:"BD"}),(0,i.jsx)("span",{className:"ml-2 text-xl font-semibold text-gray-900 transition-opacity",children:"BigDealEgypt"})]}),(0,i.jsx)("button",{onClick:d,className:"\n            p-1.5 rounded-lg bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors\n            ".concat(a?"ml-0 mt-2":"ml-auto","\n          "),"aria-label":a?"Expand sidebar":"Collapse sidebar",children:a?(0,i.jsx)(l.Tfp,{size:16}):(0,i.jsx)(l.YFh,{size:16})})]}),(0,i.jsx)("div",{className:"border-b border-gray-200 flex ".concat(a?"justify-center py-4":"px-4 py-3"),children:a?(0,i.jsx)("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center text-primary-700 font-medium text-lg",children:(null==b?void 0:null===(s=b.name)||void 0===s?void 0:s.charAt(0).toUpperCase())||"U"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center text-primary-700 font-medium text-lg",children:(null==b?void 0:null===(t=b.name)||void 0===t?void 0:t.charAt(0).toUpperCase())||"U"}),(0,i.jsxs)("div",{className:"ml-3 overflow-hidden",children:[(0,i.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:(null==b?void 0:b.name)||"User Account"}),(0,i.jsx)("p",{className:"text-xs text-gray-500 truncate",children:"admin"===g?"Administrator":"sales_ops"===g?"Sales Agent":"Customer"})]})]})}),(0,i.jsx)("div",{className:"flex-1 overflow-y-auto py-4 ".concat(a?"px-2":"px-3"),children:(0,i.jsx)("nav",{className:"space-y-1",children:z.map(e=>(0,i.jsx)(MenuItem,{href:e.href,icon:e.icon,label:e.label,isActive:x===e.href||x.startsWith("".concat(e.href,"/")),isCollapsed:a,hasNotification:e.hasNotification,notificationCount:e.notificationCount},e.href))})}),(0,i.jsx)("div",{className:"border-t border-gray-200 py-4 ".concat(a?"px-2":"px-3"),children:(0,i.jsxs)("nav",{className:"space-y-1",children:[w.map(e=>(0,i.jsx)(MenuItem,{href:e.href,icon:e.icon,label:e.label,isActive:x===e.href,isCollapsed:a,hasNotification:!1,notificationCount:0},e.href)),(0,i.jsxs)("button",{onClick:async e=>{e.preventDefault(),e.stopPropagation(),console.log("Logout button clicked in Sidebar");try{await y()}catch(e){console.error("Sidebar logout error:",e),window.location.href="/"}},className:"\n              w-full flex items-center py-2.5 px-3 rounded-lg text-sm font-medium\n              text-red-600 hover:bg-red-50\n              ".concat(a?"justify-center":"","\n              transition-all duration-200\n            "),children:[(0,i.jsx)(l.xqh,{size:20,className:"text-red-500"}),!a&&(0,i.jsx)("span",{className:"ml-3",children:"Sign out"})]})]})})]})}}}]);