(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9105],{4444:function(e,t,r){Promise.resolve().then(r.bind(r,3173))},3173:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ActivityHistory}});var s=r(7437),i=r(2265),a=r(7436),n=r(3159),l=r(8920);function ActivityHistory(){let{supabase:e}=(0,a.$)(),[t,r]=(0,i.useState)(!0),[o,c]=(0,i.useState)([]),[d,u]=(0,i.useState)("all"),[p,m]=(0,i.useState)("");(0,i.useEffect)(()=>{let fetchActivities=async()=>{try{r(!0);let{data:{user:t}}=await e.auth.getUser();if(!t)throw Error("User not authenticated");let{data:s,error:i}=await e.from("user_activity").select("\n            id,\n            user_id,\n            activity_type,\n            property_id,\n            details,\n            created_at,\n            properties:property_id (\n              title,\n              location\n            )\n          ").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(100);if(i)throw i;let a=s.map(e=>{var t,r;return{id:e.id,user_id:e.user_id,activity_type:e.activity_type,property_id:e.property_id,property_title:null===(t=e.properties)||void 0===t?void 0:t.title,property_location:null===(r=e.properties)||void 0===r?void 0:r.location,details:e.details,created_at:e.created_at}});c(a)}catch(e){console.error("Error fetching activity history:",e)}finally{r(!1)}};fetchActivities()},[e]);let y=o.filter(e=>{let t="all"===d||e.activity_type===d,r=""===p||e.property_title&&e.property_title.toLowerCase().includes(p.toLowerCase())||e.property_location&&e.property_location.toLowerCase().includes(p.toLowerCase())||e.details&&e.details.toLowerCase().includes(p.toLowerCase());return t&&r}),formatDate=e=>{let t=new Date(e);return t.toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})},formatTime=e=>{let t=new Date(e);return t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})},getActivityIcon=e=>{switch(e){case"view":return(0,s.jsx)(n.dSq,{className:"h-5 w-5 text-blue-500"});case"save":return(0,s.jsx)(n.W95,{className:"h-5 w-5 text-green-500"});case"favorite":return(0,s.jsx)(n.$0H,{className:"h-5 w-5 text-red-500"});case"message":return(0,s.jsx)(n.DCG,{className:"h-5 w-5 text-purple-500"});case"request":return(0,s.jsx)(n.W95,{className:"h-5 w-5 text-orange-500"});case"viewing":return(0,s.jsx)(n.IiJ,{className:"h-5 w-5 text-teal-500"});default:return(0,s.jsx)(n.ceS,{className:"h-5 w-5 text-gray-500"})}},getActivityDescription=e=>{switch(e.activity_type){case"view":return"You viewed a property: ".concat(e.property_title);case"save":return"You saved a property: ".concat(e.property_title);case"favorite":return"You favorited a property: ".concat(e.property_title);case"message":return"You sent a message regarding: ".concat(e.property_title);case"request":return"You submitted a property request ".concat(e.details?": "+e.details:"");case"viewing":return"You scheduled a viewing for: ".concat(e.property_title);default:return"Activity on property: ".concat(e.property_title)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[(0,s.jsx)(l.vlc,{className:"h-10 w-10 text-primary-500"}),"Activity History"]}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"Track your recent activities and interactions"})]})}),(0,s.jsxs)("div",{className:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-4",children:[(0,s.jsxs)("div",{className:"relative flex-grow",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)(n.U41,{className:"h-4 w-4 text-gray-400"})}),(0,s.jsx)("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",placeholder:"Search activities...",value:p,onChange:e=>m(e.target.value)})]}),(0,s.jsxs)("div",{className:"relative w-full md:w-56",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)(n.ulB,{className:"h-4 w-4 text-gray-400"})}),(0,s.jsxs)("select",{className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white focus:outline-none focus:ring-primary focus:border-primary sm:text-sm",value:d,onChange:e=>u(e.target.value),children:[(0,s.jsx)("option",{value:"all",children:"All Activities"}),(0,s.jsx)("option",{value:"view",children:"Property Views"}),(0,s.jsx)("option",{value:"save",children:"Saved Properties"}),(0,s.jsx)("option",{value:"favorite",children:"Favorited Properties"}),(0,s.jsx)("option",{value:"message",children:"Messages"}),(0,s.jsx)("option",{value:"request",children:"Property Requests"}),(0,s.jsx)("option",{value:"viewing",children:"Scheduled Viewings"})]})]})]}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsxs)("h2",{className:"text-lg font-medium text-gray-900",children:["Your Recent Activities",(0,s.jsx)("span",{className:"ml-2 bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded-full",children:y.length})]})}),t?(0,s.jsxs)("div",{className:"flex justify-center items-center p-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"}),(0,s.jsx)("span",{className:"ml-3 text-sm text-gray-500",children:"Loading activities..."})]}):0===y.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center p-12 text-center",children:[(0,s.jsx)(l.vlc,{className:"h-10 w-10 text-primary-500"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No activities found"}),(0,s.jsx)("p",{className:"text-gray-500 text-sm mb-4",children:p||"all"!==d?"Try adjusting your search or filter":"Your activity history will appear here as you interact with properties"}),(0,s.jsxs)("a",{href:"/properties",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:[(0,s.jsx)(n.U41,{className:"mr-2 h-4 w-4"}),"Browse Properties"]})]}):(0,s.jsx)("div",{className:"mt-6 flow-root",children:(0,s.jsx)("ul",{className:"-mb-8",children:y.map((e,t)=>(0,s.jsx)("li",{children:(0,s.jsxs)("div",{className:"relative pb-8",children:[t!==y.length-1?(0,s.jsx)("span",{className:"absolute top-5 left-5 -ml-px h-full w-0.5 bg-gray-200","aria-hidden":"true"}):null,(0,s.jsxs)("div",{className:"relative flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-100 flex items-center justify-center ring-8 ring-white",children:getActivityIcon(e.activity_type)})}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm",children:(0,s.jsx)("p",{className:"font-medium text-gray-900",children:getActivityDescription(e)})}),(0,s.jsx)("div",{className:"mt-1 text-sm text-gray-500",children:(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("time",{dateTime:e.created_at,children:[formatDate(e.created_at)," at ",formatTime(e.created_at)]})})}),e.property_location&&(0,s.jsx)("div",{className:"mt-1 text-sm text-gray-500",children:(0,s.jsxs)("span",{children:["Location: ",e.property_location]})})]}),e.property_id&&(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsxs)("a",{href:"/properties/".concat(e.property_id),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:[(0,s.jsx)(n.dSq,{className:"mr-1 h-3 w-3"}),"View Property"]})})]})]})]})},e.id))})})]})})]})}},7436:function(e,t,r){"use strict";r.d(t,{$:function(){return useSupabase}}),r(7437);let useSupabase=()=>{throw Error("useSupabase has been deprecated. Use the backend API endpoints instead.")}},622:function(e,t,r){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s=r(2265),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,l=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,r){var s,a={},c=null,d=null;for(s in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)n.call(t,s)&&!o.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===a[s]&&(a[s]=t[s]);return{$$typeof:i,type:e,key:c,ref:d,props:a,_owner:l.current}}t.Fragment=a,t.jsx=q,t.jsxs=q},7437:function(e,t,r){"use strict";e.exports=r(622)},1172:function(e,t,r){"use strict";r.d(t,{w_:function(){return GenIcon}});var s=r(2265),i={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},a=s.createContext&&s.createContext(i),__assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},__rest=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,s=Object.getOwnPropertySymbols(e);i<s.length;i++)0>t.indexOf(s[i])&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(r[s[i]]=e[s[i]]);return r};function Tree2Element(e){return e&&e.map(function(e,t){return s.createElement(e.tag,__assign({key:t},e.attr),Tree2Element(e.child))})}function GenIcon(e){return function(t){return s.createElement(IconBase,__assign({attr:__assign({},e.attr)},t),Tree2Element(e.child))}}function IconBase(e){var elem=function(t){var r,i=e.attr,a=e.size,n=e.title,l=__rest(e,["attr","size","title"]),o=a||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),s.createElement("svg",__assign({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,l,{className:r,style:__assign(__assign({color:e.color||t.color},t.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),n&&s.createElement("title",null,n),e.children)};return void 0!==a?s.createElement(a.Consumer,null,function(e){return elem(e)}):elem(i)}}},function(e){e.O(0,[2420,8920,2971,2472,1744],function(){return e(e.s=4444)}),_N_E=e.O()}]);