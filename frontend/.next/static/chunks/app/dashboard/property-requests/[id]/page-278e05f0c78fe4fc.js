(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3867],{2834:function(e,t,s){Promise.resolve().then(s.bind(s,6169))},6169:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return PropertyRequestDetail}});var r=s(7437),a=s(2265),n=s(4033),i=s(1396),l=s.n(i),o=s(8611),c=s(1393),d=s(5243),m=s(6081),x=s(8920),u=s(2595),h=s(4734);function PropertyRequestDetail(e){var t,s;let{params:i}=e,{id:p}=i,{user:g}=(0,d.a)(),y=(0,n.useRouter)(),{currentRequest:f,loading:b,fetchRequestById:j}=(0,m.m)(),[v,N]=(0,a.useState)([]),[w,_]=(0,a.useState)("details");(0,a.useEffect)(()=>{p&&j(p)},[p,j]),(0,a.useEffect)(()=>{if(f&&f.property_matches){let e=[...f.property_matches].filter(e=>e.properties).sort((e,t)=>t.match_score-e.match_score).map(e=>({...e.properties,matchPercentage:e.match_score}));N(e)}},[f]);let handleScheduleViewing=async e=>{y.push("/dashboard/schedule-viewing/".concat(e,"?request_id=").concat(p))},formatDate=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return b?(0,r.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,r.jsxs)("div",{className:"relative h-10 w-10",children:[(0,r.jsx)("div",{className:"absolute top-0 left-0 right-0 bottom-0 border-t-3 border-primary-500 border-solid rounded-full animate-spin"}),(0,r.jsx)("div",{className:"absolute top-0 left-0 right-0 bottom-0 border-t-3 border-primary-200 border-solid rounded-full opacity-20"})]})}):f?(0,r.jsxs)(o.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 gap-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(l(),{href:"/dashboard/property-requests",className:"inline-flex items-center text-xs text-gray-500 hover:text-primary mb-1",children:[(0,r.jsx)(x.Ao2,{className:"mr-1 h-3 w-3"}),"Back to requests"]}),(0,r.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:f.title||"Request #".concat(f.id.substring(0,8))}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(e=>{switch(e){case"pending":return(0,r.jsxs)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:[(0,r.jsx)(x.bcx,{className:"mr-1 h-3 w-3"}),"Pending"]});case"active":return(0,r.jsxs)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[(0,r.jsx)(x._rq,{className:"mr-1 h-3 w-3"}),"Active"]});case"closed":return(0,r.jsxs)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[(0,r.jsx)(x.$Rx,{className:"mr-1 h-3 w-3"}),"Closed"]});default:return(0,r.jsxs)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[(0,r.jsx)(x.H33,{className:"mr-1 h-3 w-3"}),e?e.charAt(0).toUpperCase()+e.slice(1):"Unknown"]})}})(f.status),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:["Created ",formatDate(f.created_at)]})]})]}),(0,r.jsx)(h.Z,{variant:"outline",href:"/dashboard/property-requests/".concat(p,"/edit"),leftIcon:(0,r.jsx)(x.vPQ,{}),size:"sm",children:"Edit"})]}),(0,r.jsxs)("div",{className:"flex border-b border-gray-200 mb-3",children:[(0,r.jsxs)("button",{onClick:()=>_("details"),className:"flex items-center px-3 py-2 text-xs font-medium -mb-px ".concat("details"===w?"text-primary-600 border-b-2 border-primary-500":"text-gray-500 hover:text-gray-700 hover:border-gray-300 border-b-2 border-transparent"),children:[(0,r.jsx)(x.j4u,{className:"mr-1.5 h-3.5 w-3.5"}),"Request Details"]}),(0,r.jsxs)("button",{onClick:()=>_("matches"),className:"flex items-center px-3 py-2 text-xs font-medium -mb-px ".concat("matches"===w?"text-primary-600 border-b-2 border-primary-500":"text-gray-500 hover:text-gray-700 hover:border-gray-300 border-b-2 border-transparent"),children:[(0,r.jsx)(x.fsB,{className:"mr-1.5 h-3.5 w-3.5"}),"Matches ",v.length>0&&"(".concat(v.length,")")]}),f.status_history&&f.status_history.length>0&&(0,r.jsxs)("button",{onClick:()=>_("history"),className:"flex items-center px-3 py-2 text-xs font-medium -mb-px ".concat("history"===w?"text-primary-600 border-b-2 border-primary-500":"text-gray-500 hover:text-gray-700 hover:border-gray-300 border-b-2 border-transparent"),children:[(0,r.jsx)(x.TCC,{className:"mr-1.5 h-3.5 w-3.5"}),"History"]})]}),(0,r.jsxs)(c.M,{mode:"wait",children:["details"===w&&(0,r.jsx)(o.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:(0,r.jsxs)(u.Z,{className:"overflow-hidden",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 p-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center mb-1",children:[(0,r.jsx)(x.m6D,{className:"text-primary-500 mr-1 h-3.5 w-3.5"}),(0,r.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Property Type"})]}),(0,r.jsx)("p",{className:"text-sm font-medium",children:f.property_type})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center mb-1",children:[(0,r.jsx)(x.i63,{className:"text-primary-500 mr-1 h-3.5 w-3.5"}),(0,r.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Location"})]}),(0,r.jsx)("p",{className:"text-sm font-medium",children:f.location})]}),(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsxs)("div",{className:"flex items-center mb-1",children:[(0,r.jsx)(x.oQC,{className:"text-primary-500 mr-1 h-3.5 w-3.5"}),(0,r.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Price Range"})]}),(0,r.jsxs)("p",{className:"text-sm font-medium",children:[null===(t=f.min_price)||void 0===t?void 0:t.toLocaleString()," - ",null===(s=f.max_price)||void 0===s?void 0:s.toLocaleString()," EGP"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center mb-1",children:[(0,r.jsx)(x.ERY,{className:"text-primary-500 mr-1 h-3.5 w-3.5"}),(0,r.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Bedrooms"})]}),(0,r.jsx)("p",{className:"text-sm font-medium",children:f.bedrooms})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center mb-1",children:[(0,r.jsx)(x.ERY,{className:"text-primary-500 mr-1 h-3.5 w-3.5"}),(0,r.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Bathrooms"})]}),(0,r.jsx)("p",{className:"text-sm font-medium",children:f.bathrooms})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center mb-1",children:[(0,r.jsx)(x.D7o,{className:"text-primary-500 mr-1 h-3.5 w-3.5"}),(0,r.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Area Size"})]}),(0,r.jsxs)("p",{className:"text-sm font-medium",children:[f.area_size," m\xb2"]})]}),f.custom_fields&&Object.keys(f.custom_fields).length>0&&(0,r.jsxs)("div",{className:"col-span-2 sm:col-span-4 border-t border-gray-100 pt-3 mt-1",children:[(0,r.jsx)("div",{className:"flex items-center mb-2",children:(0,r.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Additional Features"})}),(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:Object.entries(f.custom_fields).map(e=>{let[t,s]=e;return(0,r.jsx)("div",{className:"flex items-center",children:"boolean"==typeof s?(0,r.jsxs)("span",{className:"inline-flex items-center text-xs ".concat(s?"text-green-600":"text-gray-400"),children:[s?(0,r.jsx)(x._rq,{className:"mr-1 h-3 w-3"}):(0,r.jsx)(x.$Rx,{className:"mr-1 h-3 w-3"}),t.replace(/_/g," ")]}):(0,r.jsxs)("span",{className:"text-xs",children:[(0,r.jsxs)("span",{className:"font-medium",children:[t.replace(/_/g," "),":"]})," ",s.toString()]})},t)})})]}),f.additional_features&&(0,r.jsxs)("div",{className:"col-span-2 sm:col-span-4 border-t border-gray-100 pt-3 mt-1",children:[(0,r.jsx)("div",{className:"flex items-center mb-1",children:(0,r.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Additional Requirements"})}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:f.additional_features})]})]}),v.length>0&&(0,r.jsxs)("div",{className:"border-t border-gray-100 px-4 py-3 bg-gray-50 flex justify-between items-center",children:[(0,r.jsx)("div",{children:(0,r.jsxs)("span",{className:"text-xs font-medium text-gray-600",children:[v.length," matching ",1===v.length?"property":"properties"," found"]})}),(0,r.jsx)(h.Z,{variant:"light",size:"xs",rightIcon:(0,r.jsx)(x.Tfp,{}),onClick:()=>_("matches"),children:"View Matches"})]})]})},"details"),"matches"===w&&(0,r.jsx)(o.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:v.length>0?(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:v.map(e=>{var t;return(0,r.jsxs)(u.Z,{padding:"none",hover:!0,className:"overflow-hidden",children:[(0,r.jsxs)("div",{className:"relative h-32 bg-gray-100",children:[e.featured_image?(0,r.jsx)("img",{src:e.featured_image,alt:e.title,className:"h-full w-full object-cover"}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full w-full bg-gray-100",children:(0,r.jsx)(x.m6D,{className:"h-8 w-8 text-gray-300"})}),(0,r.jsxs)("div",{className:"absolute top-2 right-2 bg-primary-600 text-white text-xs font-bold px-2 py-1 rounded shadow",children:[e.matchPercentage,"% Match"]})]}),(0,r.jsxs)("div",{className:"p-3",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-1",children:e.title}),(0,r.jsxs)("div",{className:"flex items-center text-xs text-gray-500 mb-1.5",children:[(0,r.jsx)(x.i63,{className:"h-3 w-3 text-gray-400 mr-1"}),e.location]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("p",{className:"text-sm font-bold text-primary-600",children:[null===(t=e.price)||void 0===t?void 0:t.toLocaleString()," EGP"]}),(0,r.jsxs)("div",{className:"flex items-center text-xs text-gray-500",children:[e.bedrooms&&(0,r.jsxs)("span",{className:"mr-2",children:[e.bedrooms," Beds"]}),e.bathrooms&&(0,r.jsxs)("span",{className:"mr-2",children:[e.bathrooms," Baths"]}),(0,r.jsxs)("span",{children:[e.area_size," m\xb2"]})]})]}),(0,r.jsxs)("div",{className:"flex gap-1 mt-3",children:[(0,r.jsx)(h.Z,{variant:"outline",leftIcon:(0,r.jsx)(x.rDJ,{}),size:"xs",href:"/properties/".concat(e.id),className:"flex-1",children:"View"}),(0,r.jsx)(h.Z,{variant:"primary",leftIcon:(0,r.jsx)(x.vlc,{}),size:"xs",onClick:()=>handleScheduleViewing(e.id),className:"flex-1",children:"Schedule"})]})]})]},e.id)})}):(0,r.jsxs)(u.Z,{className:"py-4 text-center",children:[(0,r.jsx)("div",{className:"mx-auto h-10 w-10 rounded-full bg-gray-100 flex items-center justify-center mb-2",children:(0,r.jsx)(x.H33,{className:"h-5 w-5 text-gray-400"})}),(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-1",children:"No matching properties"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 max-w-md mx-auto mb-3",children:"We couldn't find any properties matching your requirements."}),(0,r.jsx)("p",{className:"text-xs text-gray-500 max-w-md mx-auto",children:"Try adjusting your requirements or check back later."})]})},"matches"),"history"===w&&f.status_history&&f.status_history.length>0&&(0,r.jsx)(o.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:(0,r.jsx)(u.Z,{children:(0,r.jsx)("div",{className:"divide-y divide-gray-100",children:f.status_history.map(e=>(0,r.jsx)("div",{className:"px-3 py-2",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("div",{className:"h-8 w-8 rounded-full bg-gray-100 flex items-center justify-center mr-2",children:["active"===e.new_status&&(0,r.jsx)(x._rq,{className:"h-4 w-4 text-green-500"}),"pending"===e.new_status&&(0,r.jsx)(x.bcx,{className:"h-4 w-4 text-amber-500"}),"closed"===e.new_status&&(0,r.jsx)(x.$Rx,{className:"h-4 w-4 text-gray-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-xs font-medium text-gray-900",children:["Status changed to ",(0,r.jsx)("span",{className:"font-bold",children:e.new_status}),e.old_status&&(0,r.jsxs)("span",{className:"text-gray-500",children:[" from ",e.old_status]})]}),e.notes&&(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:e.notes})]})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 ml-2",children:formatDate(e.created_at)})]})},e.id))})})},"history")]})]}):(0,r.jsxs)(u.Z,{className:"py-6 text-center",children:[(0,r.jsx)("div",{className:"mx-auto h-12 w-12 rounded-full bg-primary-50 flex items-center justify-center mb-3",children:(0,r.jsx)(x.H33,{className:"h-6 w-6 text-primary-500"})}),(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-1",children:"Request not found"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 max-w-md mx-auto mb-4",children:"The property request you're looking for doesn't exist or you don't have access to it."}),(0,r.jsx)(h.Z,{variant:"primary",href:"/dashboard/property-requests",leftIcon:(0,r.jsx)(x.Ao2,{}),size:"sm",children:"Back to Requests"})]})}},4734:function(e,t,s){"use strict";s.d(t,{Z:function(){return Button}});var r=s(7437);s(2265);var a=s(1396),n=s.n(a);function LoadingSpinner(e){let{size:t="medium",color:s="primary",className:a=""}=e;return(0,r.jsx)("div",{className:"flex justify-center items-center ".concat(a),children:(0,r.jsx)("div",{className:"\n          rounded-full\n          animate-spin\n          ".concat({small:"h-4 w-4 border-2",medium:"h-8 w-8 border-2",large:"h-12 w-12 border-3"}[t],"\n          ").concat({primary:"border-primary-300 border-t-primary",white:"border-gray-200 border-t-white",gray:"border-gray-200 border-t-gray-600"}[s],"\n        ")})})}function Button(e){let{children:t,variant:s="primary",size:a="md",fullWidth:i=!1,href:l,loading:o=!1,outline:c=!1,rounded:d=!0,glass:m=!1,animation:x="none",className:u="",leftIcon:h,rightIcon:p,...g}=e,y=g.disabled?"opacity-60 cursor-not-allowed":"transform active:scale-[0.98] transition-transform",f="\n    inline-flex items-center justify-center\n    font-medium\n    transition-all duration-200\n    focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\n    ".concat({primary:c?"border-2 border-primary-500 text-primary-600 hover:bg-primary-50 active:bg-primary-100":"bg-primary-600 hover:bg-primary-700 text-white shadow-sm",secondary:c?"border-2 border-gray-400 text-gray-700 hover:bg-gray-50 active:bg-gray-100":"bg-gray-600 hover:bg-gray-700 text-white shadow-sm",success:c?"border-2 border-green-500 text-green-600 hover:bg-green-50 active:bg-green-100":"bg-green-600 hover:bg-green-700 text-white shadow-sm",danger:c?"border-2 border-red-500 text-red-600 hover:bg-red-50 active:bg-red-100":"bg-red-600 hover:bg-red-700 text-white shadow-sm",warning:c?"border-2 border-amber-500 text-amber-600 hover:bg-amber-50 active:bg-amber-100":"bg-amber-500 hover:bg-amber-600 text-white shadow-sm",info:c?"border-2 border-blue-400 text-blue-500 hover:bg-blue-50 active:bg-blue-100":"bg-blue-500 hover:bg-blue-600 text-white shadow-sm",light:c?"border-2 border-gray-200 text-gray-600 hover:bg-gray-50 active:bg-gray-100":"bg-gray-100 hover:bg-gray-200 text-gray-800",dark:c?"border-2 border-gray-700 text-gray-800 hover:bg-gray-800 hover:text-white":"bg-gray-800 hover:bg-gray-900 text-white shadow-sm",outline:"border-2 border-gray-300 text-gray-700 hover:border-primary-500 hover:text-primary-600 bg-white",gradient:"bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white shadow-sm"}[s],"\n    ").concat({xs:"text-xs px-2.5 py-1.5 gap-1",sm:"text-sm px-3 py-2 gap-1.5",md:"text-base px-4 py-2.5 gap-2",lg:"text-lg px-5 py-3 gap-2",xl:"text-xl px-6 py-3.5 gap-2.5"}[a],"\n    ").concat(i?"w-full":"","\n    ").concat(d?"rounded-full":"rounded-lg","\n    ").concat(m?"backdrop-blur-sm bg-opacity-80 shadow-sm":"","\n    ").concat({none:"",pulse:"animate-pulse",bounce:"animate-bounce"}[x],"\n    ").concat(y,"\n    ").concat(u,"\n  ");return l?(0,r.jsxs)(n(),{href:l,className:f,children:[h&&(0,r.jsx)("span",{className:"flex items-center",children:h}),t,p&&(0,r.jsx)("span",{className:"flex items-center",children:p})]}):(0,r.jsxs)("button",{className:f,disabled:o||g.disabled,...g,children:[o?(0,r.jsx)(LoadingSpinner,{size:"small",color:c?"primary":"white"}):h?(0,r.jsx)("span",{className:"flex items-center",children:h}):null,(0,r.jsx)("span",{children:t}),p&&!o&&(0,r.jsx)("span",{className:"flex items-center",children:p})]})}},2595:function(e,t,s){"use strict";s.d(t,{Z:function(){return Card}});var r=s(7437);function Card(e){let{children:t,className:s="",padding:a="small",shadow:n="small",rounded:i="medium",border:l=!1,hover:o=!1,clickable:c=!1}=e;return(0,r.jsx)("div",{className:"\n        bg-white\n        ".concat({none:"p-0",xs:"p-2",small:"p-3",medium:"p-4",large:"p-5"}[a],"\n        ").concat({none:"",small:"shadow-sm",medium:"shadow",large:"shadow-lg"}[n],"\n        ").concat({none:"rounded-none",small:"rounded-md",medium:"rounded-lg",large:"rounded-xl"}[i],"\n        ").concat(l?"border border-gray-100":"","\n        ").concat(o?"transition-all duration-200 hover:shadow-md hover:translate-y-[-1px]":"","\n        ").concat(c?"cursor-pointer active:scale-[0.99] active:shadow-inner transition-transform":"","\n        ").concat(s,"\n      "),children:t})}s(2265)},6081:function(e,t,s){"use strict";s.d(t,{m:function(){return usePropertyRequests}});var r=s(2265),a=s(5243),n=s(4389);function usePropertyRequests(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,s]=(0,r.useState)([]),[i,l]=(0,r.useState)(null),[o,c]=(0,r.useState)(!1),[d,m]=(0,r.useState)(null),[x,u]=(0,r.useState)(e.filters||{}),[h,p]=(0,r.useState)({page:1,limit:10,totalPages:1,totalCount:0}),[g,y]=(0,r.useState)([]),{user:f,session:b}=(0,a.a)(),j=(0,r.useCallback)(async()=>{if(f&&(null==b?void 0:b.access_token)){c(!0),m(null);try{let e=await n.ZP.getPropertyRequests(b.access_token,{...x,page:h.page,limit:h.limit,role:null==f?void 0:f.role});console.log("Property requests result:",e),s(e.requests||[]),p({...h,totalPages:e.totalPages||1,totalCount:e.totalCount||0})}catch(e){console.error("Error fetching property requests:",e),m(e.message||"Failed to fetch property requests")}finally{c(!1)}}},[f,b,x,h.page,h.limit]),v=(0,r.useCallback)(async e=>{if(f&&(null==b?void 0:b.access_token)&&e){c(!0),m(null);try{let t=await n.ZP.getPropertyRequestById(b.access_token,e);return l(t),t}catch(e){return console.error("Error fetching property request:",e),m(e.message||"Failed to fetch property request"),null}finally{c(!1)}}},[f,b]),N=(0,r.useCallback)(async e=>{if(!f||!(null==b?void 0:b.access_token))return null;c(!0),m(null);try{let t=await n.ZP.createPropertyRequest(b.access_token,e);return t}catch(e){return console.error("Error creating property request:",e),m(e.message||"Failed to create property request"),null}finally{c(!1)}},[f,b]),w=(0,r.useCallback)(async(e,t)=>{if(!f||!(null==b?void 0:b.access_token)||!e)return null;c(!0),m(null);try{let r=await n.ZP.updatePropertyRequest(b.access_token,e,t);return i&&i.id===e&&l(r),s(t=>t.map(t=>t.id===e?{...t,...r}:t)),r}catch(e){return console.error("Error updating property request:",e),m(e.message||"Failed to update property request"),null}finally{c(!1)}},[f,b,i]),_=(0,r.useCallback)(async e=>{if(!f||!(null==b?void 0:b.access_token)||!e)return!1;c(!0),m(null);try{return await n.ZP.deletePropertyRequest(b.access_token,e),s(t=>t.filter(t=>t.id!==e)),i&&i.id===e&&l(null),!0}catch(e){return console.error("Error deleting property request:",e),m(e.message||"Failed to delete property request"),!1}finally{c(!1)}},[f,b,i]),C=(0,r.useCallback)(async()=>{if(f&&(null==b?void 0:b.access_token)){c(!0),m(null);try{let e=await n.ZP.getPropertyRequestFields(b.access_token);return y(e||[]),e}catch(e){return console.error("Error fetching property request fields:",e),m(e.message||"Failed to fetch property request fields"),[]}finally{c(!1)}}},[f,b]),P=(0,r.useCallback)(async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!f||!(null==b?void 0:b.access_token)||!e||!t)return null;c(!0),m(null);try{let a=await n.ZP.assignPropertyRequest(b.access_token,e,t,r);return i&&i.id===e&&l({...i,assigned_to:t,assigned_to_profile:a.assigned_to_profile}),s(s=>s.map(s=>s.id===e?{...s,assigned_to:t,assigned_to_profile:a.assigned_to_profile}:s)),a}catch(e){return console.error("Error assigning property request:",e),m(e.message||"Failed to assign property request"),null}finally{c(!1)}},[f,b,i]),q=(0,r.useCallback)(async(e,t)=>{if(!f||!(null==b?void 0:b.access_token)||!e||!t.status)return null;c(!0),m(null);try{let r=await n.ZP.addStatusUpdate(b.access_token,e,t);return i&&i.id===e&&l({...i,status:t.status,status_history:[r.history,...i.status_history||[]]}),s(s=>s.map(s=>s.id===e?{...s,status:t.status}:s)),r}catch(e){return console.error("Error updating property request status:",e),m(e.message||"Failed to update property request status"),null}finally{c(!1)}},[f,b,i]),k=(0,r.useCallback)(e=>{u(t=>({...t,...e})),p(e=>({...e,page:1}))},[]),E=(0,r.useCallback)(e=>{p(t=>({...t,...e}))},[]);return(0,r.useEffect)(()=>{e.loadOnMount&&j()},[e.loadOnMount,j]),(0,r.useEffect)(()=>{C()},[C]),{requests:t,currentRequest:i,loading:o,error:d,filters:x,pagination:h,fields:g,fetchRequests:j,fetchRequestById:v,createRequest:N,updateRequest:w,deleteRequest:_,fetchFields:C,assignRequest:P,addStatusUpdate:q,updateFilters:k,updatePagination:E,setCurrentRequest:l}}},4033:function(e,t,s){e.exports=s(94)},1393:function(e,t,s){"use strict";s.d(t,{M:function(){return AnimatePresence}});var r=s(7437),a=s(2265),n=s(781),i=s(961),l=s(538),o=s(8243),c=s(5968);let PopChildMeasure=class PopChildMeasure extends a.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,s=e instanceof HTMLElement&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=s-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}};function PopChild({children:e,isPresent:t,anchorX:s}){let n=(0,a.useId)(),i=(0,a.useRef)(null),l=(0,a.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=(0,a.useContext)(c._);return(0,a.useInsertionEffect)(()=>{let{width:e,height:r,top:a,left:c,right:d}=l.current;if(t||!i.current||!e||!r)return;let m="left"===s?`left: ${c}`:`right: ${d}`;i.current.dataset.motionPopId=n;let x=document.createElement("style");return o&&(x.nonce=o),document.head.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${r}px !important;
            ${m}px !important;
            top: ${a}px !important;
          }
        `),()=>{document.head.removeChild(x)}},[t]),(0,r.jsx)(PopChildMeasure,{isPresent:t,childRef:i,sizeRef:l,children:a.cloneElement(e,{ref:i})})}let PresenceChild=({children:e,initial:t,isPresent:s,onExitComplete:n,custom:l,presenceAffectsLayout:c,mode:d,anchorX:m})=>{let x=(0,i.h)(newChildrenMap),u=(0,a.useId)(),h=!0,p=(0,a.useMemo)(()=>(h=!1,{id:u,initial:t,isPresent:s,custom:l,onExitComplete:e=>{for(let t of(x.set(e,!0),x.values()))if(!t)return;n&&n()},register:e=>(x.set(e,!1),()=>x.delete(e))}),[s,x,n]);return c&&h&&(p={...p}),(0,a.useMemo)(()=>{x.forEach((e,t)=>x.set(t,!1))},[s]),a.useEffect(()=>{s||x.size||!n||n()},[s]),"popLayout"===d&&(e=(0,r.jsx)(PopChild,{isPresent:s,anchorX:m,children:e})),(0,r.jsx)(o.O.Provider,{value:p,children:e})};function newChildrenMap(){return new Map}var d=s(7196);let getChildKey=e=>e.key||"";function onlyElements(e){let t=[];return a.Children.forEach(e,e=>{(0,a.isValidElement)(e)&&t.push(e)}),t}let AnimatePresence=({children:e,custom:t,initial:s=!0,onExitComplete:o,presenceAffectsLayout:c=!0,mode:m="sync",propagate:x=!1,anchorX:u="left"})=>{let[h,p]=(0,d.oO)(x),g=(0,a.useMemo)(()=>onlyElements(e),[e]),y=x&&!h?[]:g.map(getChildKey),f=(0,a.useRef)(!0),b=(0,a.useRef)(g),j=(0,i.h)(()=>new Map),[v,N]=(0,a.useState)(g),[w,_]=(0,a.useState)(g);(0,l.L)(()=>{f.current=!1,b.current=g;for(let e=0;e<w.length;e++){let t=getChildKey(w[e]);y.includes(t)?j.delete(t):!0!==j.get(t)&&j.set(t,!1)}},[w,y.length,y.join("-")]);let C=[];if(g!==v){let e=[...g];for(let t=0;t<w.length;t++){let s=w[t],r=getChildKey(s);y.includes(r)||(e.splice(t,0,s),C.push(s))}return"wait"===m&&C.length&&(e=C),_(onlyElements(e)),N(g),null}let{forceRender:P}=(0,a.useContext)(n.p);return(0,r.jsx)(r.Fragment,{children:w.map(e=>{let a=getChildKey(e),n=(!x||!!h)&&(g===w||y.includes(a));return(0,r.jsx)(PresenceChild,{isPresent:n,initial:(!f.current||!!s)&&void 0,custom:t,presenceAffectsLayout:c,mode:m,onExitComplete:n?void 0:()=>{if(!j.has(a))return;j.set(a,!0);let e=!0;j.forEach(t=>{t||(e=!1)}),e&&(P?.(),_(b.current),x&&p?.(),o&&o())},anchorX:u,children:e},a)})})}}},function(e){e.O(0,[2438,8920,8611,6453,2971,2472,1744],function(){return e(e.s=2834)}),_N_E=e.O()}]);