(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1585],{1486:function(e,r,t){Promise.resolve().then(t.bind(t,3704))},3704:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return EditPropertyRequest}});var a=t(7437),s=t(2265),n=t(4033),o=t(5243),i=t(7436),l=t(2595),c=t(4734),d=t(654),u=t(6814),m=t(8920),h=t(1396),p=t.n(h);let g=["Apartment","Villa","Townhouse","Penthouse","Chalet","Duplex","Office","Shop","Land"],x=["Studio","1","2","3","4","5","6+"],f=["1","2","3","4","5+"];function EditPropertyRequest(){let{id:e}=(0,n.useParams)(),r=(0,n.useRouter)(),{user:t}=(0,o.a)(),{supabase:h}=(0,i.$)(),[b,y]=(0,s.useState)(!0),[v,j]=(0,s.useState)(!1),[_,w]=(0,s.useState)(""),[N,S]=(0,s.useState)(!1),[k,C]=(0,s.useState)({title:"",property_type:"",location:"",min_price:"",max_price:"",bedrooms:"",bathrooms:"",area_size:"",additional_features:"",custom_fields:{}}),[q,F]=(0,s.useState)([]);(0,s.useEffect)(()=>{let fetchData=async()=>{if(t&&e){y(!0);try{var r,a,s;let{data:n,error:o}=await h.from("property_requests").select("*").eq("id",e).eq("user_id",t.id).single();if(o)throw o;if(!n){w("Property request not found or you do not have permission to edit it."),y(!1);return}let{data:i,error:l}=await h.from("property_request_fields").select("*").order("order",{ascending:!0});if(l)throw l;F(i||[]),C({title:n.title||"",property_type:n.property_type||"",location:n.location||"",min_price:(null===(r=n.min_price)||void 0===r?void 0:r.toString())||"",max_price:(null===(a=n.max_price)||void 0===a?void 0:a.toString())||"",bedrooms:n.bedrooms||"",bathrooms:n.bathrooms||"",area_size:(null===(s=n.area_size)||void 0===s?void 0:s.toString())||"",additional_features:n.additional_features||"",custom_fields:n.custom_fields||{}})}catch(e){console.error("Error fetching property request:",e),w("Failed to load property request. Please try again.")}finally{y(!1)}}};fetchData()},[h,t,e]);let handleChange=e=>{let{name:r,value:t,type:a,checked:s}=e.target;if("checkbox"===a){if(r.startsWith("custom_")){let e=r.replace("custom_","");C({...k,custom_fields:{...k.custom_fields,[e]:s}})}}else if(r.startsWith("custom_")){let e=r.replace("custom_","");C({...k,custom_fields:{...k.custom_fields,[e]:t}})}else C({...k,[r]:t})},handleSubmit=async a=>{if(a.preventDefault(),!t||!e)return;if(!k.title||!k.property_type||!k.location){w("Please fill out all required fields.");return}let s=parseFloat(k.min_price),n=parseFloat(k.max_price);if(s>=n){w("Minimum price must be less than maximum price.");return}j(!0),w("");try{let a={title:k.title,property_type:k.property_type,location:k.location,min_price:s,max_price:n,bedrooms:k.bedrooms,bathrooms:k.bathrooms,area_size:k.area_size?parseFloat(k.area_size):null,additional_features:k.additional_features,custom_fields:k.custom_fields,updated_at:new Date().toISOString()},{error:o}=await h.from("property_requests").update(a).eq("id",e).eq("user_id",t.id);if(o)throw o;S(!0),setTimeout(()=>{r.push("/dashboard/property-requests/".concat(e))},1500)}catch(e){console.error("Error updating property request:",e),w("Failed to update property request. Please try again.")}finally{j(!1)}};return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center mb-3",children:[(0,a.jsx)(p(),{href:"/dashboard/property-requests/".concat(e),className:"text-gray-500 hover:text-gray-700 mr-2",children:(0,a.jsx)(m.Ao2,{className:"h-4 w-4"})}),(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Edit Property Request"})]}),_&&(0,a.jsx)("div",{className:"mb-3 bg-red-50 border-l-4 border-red-500 p-2 rounded-md",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(m.bcx,{className:"h-5 w-5 text-red-500"})}),(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("p",{className:"text-sm text-red-700",children:_})})]})}),N&&(0,a.jsx)("div",{className:"mb-3 bg-green-50 border-l-4 border-green-500 p-2 rounded-md",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(m._rq,{className:"h-5 w-5 text-green-500"})}),(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("p",{className:"text-sm text-green-700",children:"Property request updated successfully! Redirecting..."})})]})}),b?(0,a.jsx)(l.Z,{children:(0,a.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,a.jsxs)("div",{className:"relative h-10 w-10",children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 right-0 bottom-0 border-t-3 border-primary-500 border-solid rounded-full animate-spin"}),(0,a.jsx)("div",{className:"absolute top-0 left-0 right-0 bottom-0 border-t-3 border-primary-200 border-solid rounded-full opacity-20"})]})})}):(0,a.jsx)("form",{onSubmit:handleSubmit,children:(0,a.jsxs)(l.Z,{children:[(0,a.jsxs)("div",{className:"flex items-center mb-3",children:[(0,a.jsx)(m.j4u,{className:"h-5 w-5 text-primary-500 mr-2"}),(0,a.jsx)("h2",{className:"text-base font-medium text-gray-900",children:"Property Request Details"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(u.Z,{label:"Request Title",htmlFor:"title",required:!0,span:"full",children:(0,a.jsx)(d.Z,{id:"title",name:"title",type:"text",placeholder:"E.g., 3 Bedroom Apartment in New Cairo",value:k.title,onChange:handleChange,leftIcon:(0,a.jsx)(m.j4u,{}),required:!0})}),(0,a.jsx)(u.Z,{label:"Property Type",htmlFor:"property_type",required:!0,children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(m.m6D,{className:"h-4 w-4 text-gray-400"})}),(0,a.jsxs)("select",{id:"property_type",name:"property_type",value:k.property_type,onChange:handleChange,className:"block w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select Property Type"}),g.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]})}),(0,a.jsx)(u.Z,{label:"Location",htmlFor:"location",required:!0,children:(0,a.jsx)(d.Z,{id:"location",name:"location",type:"text",placeholder:"E.g., New Cairo, Maadi, etc.",value:k.location,onChange:handleChange,leftIcon:(0,a.jsx)(m.i63,{}),required:!0})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 col-span-full md:col-span-1",children:[(0,a.jsx)(u.Z,{label:"Minimum Price (EGP)",htmlFor:"min_price",required:!0,children:(0,a.jsx)(d.Z,{id:"min_price",name:"min_price",type:"number",placeholder:"Min price",value:k.min_price,onChange:handleChange,leftIcon:(0,a.jsx)(m.oQC,{}),min:"0",step:"1000",required:!0})}),(0,a.jsx)(u.Z,{label:"Maximum Price (EGP)",htmlFor:"max_price",required:!0,children:(0,a.jsx)(d.Z,{id:"max_price",name:"max_price",type:"number",placeholder:"Max price",value:k.max_price,onChange:handleChange,leftIcon:(0,a.jsx)(m.oQC,{}),min:"0",step:"1000",required:!0})})]}),(0,a.jsx)(u.Z,{label:"Bedrooms",htmlFor:"bedrooms",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(m.m6D,{className:"h-4 w-4 text-gray-400"})}),(0,a.jsxs)("select",{id:"bedrooms",name:"bedrooms",value:k.bedrooms,onChange:handleChange,className:"block w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500",children:[(0,a.jsx)("option",{value:"",children:"Select Bedrooms"}),x.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]})}),(0,a.jsx)(u.Z,{label:"Bathrooms",htmlFor:"bathrooms",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(m.m6D,{className:"h-4 w-4 text-gray-400"})}),(0,a.jsxs)("select",{id:"bathrooms",name:"bathrooms",value:k.bathrooms,onChange:handleChange,className:"block w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500",children:[(0,a.jsx)("option",{value:"",children:"Select Bathrooms"}),f.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]})}),(0,a.jsx)(u.Z,{label:"Area Size (m\xb2)",htmlFor:"area_size",children:(0,a.jsx)(d.Z,{id:"area_size",name:"area_size",type:"number",placeholder:"Area in square meters",value:k.area_size,onChange:handleChange,min:"0",step:"1"})}),(0,a.jsx)(u.Z,{label:"Additional Features",htmlFor:"additional_features",span:"full",children:(0,a.jsx)("textarea",{id:"additional_features",name:"additional_features",value:k.additional_features,onChange:handleChange,rows:3,className:"block w-full rounded-lg border border-gray-300 py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-sm",placeholder:"Describe any additional features or requirements"})})]}),q.length>0&&(0,a.jsxs)("div",{className:"mt-4 border-t border-gray-100 pt-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-3",children:[(0,a.jsx)(m.H33,{className:"h-5 w-5 text-primary-500 mr-2"}),(0,a.jsx)("h2",{className:"text-base font-medium text-gray-900",children:"Additional Preferences"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:q.map(e=>{var r;return(0,a.jsx)("div",{className:"full"===e.field_span?"col-span-full":"",children:"checkbox"===e.field_type?(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"flex items-center h-5",children:(0,a.jsx)("input",{id:"custom_".concat(e.field_name),name:"custom_".concat(e.field_name),type:"checkbox",checked:k.custom_fields[e.field_name]||!1,onChange:handleChange,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"})}),(0,a.jsxs)("div",{className:"ml-3 text-sm",children:[(0,a.jsx)("label",{htmlFor:"custom_".concat(e.field_name),className:"font-medium text-gray-700",children:e.field_label}),e.help_text&&(0,a.jsx)("p",{className:"text-gray-500",children:e.help_text})]})]}):"select"===e.field_type?(0,a.jsx)(u.Z,{label:e.field_label,htmlFor:"custom_".concat(e.field_name),required:e.is_required,helpText:e.help_text,children:(0,a.jsxs)("select",{id:"custom_".concat(e.field_name),name:"custom_".concat(e.field_name),value:k.custom_fields[e.field_name]||"",onChange:handleChange,className:"block w-full rounded-lg border border-gray-300 py-2 px-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-sm",required:e.is_required,children:[(0,a.jsx)("option",{value:"",children:e.placeholder||"Select ".concat(e.field_label)}),null===(r=e.options)||void 0===r?void 0:r.split(",").map(e=>(0,a.jsx)("option",{value:e.trim(),children:e.trim()},e.trim()))]})}):(0,a.jsx)(u.Z,{label:e.field_label,htmlFor:"custom_".concat(e.field_name),required:e.is_required,helpText:e.help_text,children:(0,a.jsx)(d.Z,{id:"custom_".concat(e.field_name),name:"custom_".concat(e.field_name),type:"number"===e.field_type?"number":"text",placeholder:e.placeholder,value:k.custom_fields[e.field_name]||"",onChange:handleChange,required:e.is_required,min:"number"===e.field_type?e.min_value:void 0,max:"number"===e.field_type?e.max_value:void 0})})},e.id)})})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-6 border-t border-gray-100 pt-4",children:[(0,a.jsx)(c.Z,{variant:"light",size:"sm",leftIcon:(0,a.jsx)(m.q5L,{}),onClick:()=>{r.back()},type:"button",children:"Cancel"}),(0,a.jsx)(c.Z,{variant:"primary",size:"sm",leftIcon:(0,a.jsx)(m.mW3,{}),type:"submit",loading:v,children:v?"Saving...":"Save Changes"})]})]})})]})}},4734:function(e,r,t){"use strict";t.d(r,{Z:function(){return Button}});var a=t(7437);t(2265);var s=t(1396),n=t.n(s);function LoadingSpinner(e){let{size:r="medium",color:t="primary",className:s=""}=e;return(0,a.jsx)("div",{className:"flex justify-center items-center ".concat(s),children:(0,a.jsx)("div",{className:"\n          rounded-full\n          animate-spin\n          ".concat({small:"h-4 w-4 border-2",medium:"h-8 w-8 border-2",large:"h-12 w-12 border-3"}[r],"\n          ").concat({primary:"border-primary-300 border-t-primary",white:"border-gray-200 border-t-white",gray:"border-gray-200 border-t-gray-600"}[t],"\n        ")})})}function Button(e){let{children:r,variant:t="primary",size:s="md",fullWidth:o=!1,href:i,loading:l=!1,outline:c=!1,rounded:d=!0,glass:u=!1,animation:m="none",className:h="",leftIcon:p,rightIcon:g,...x}=e,f=x.disabled?"opacity-60 cursor-not-allowed":"transform active:scale-[0.98] transition-transform",b="\n    inline-flex items-center justify-center\n    font-medium\n    transition-all duration-200\n    focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\n    ".concat({primary:c?"border-2 border-primary-500 text-primary-600 hover:bg-primary-50 active:bg-primary-100":"bg-primary-600 hover:bg-primary-700 text-white shadow-sm",secondary:c?"border-2 border-gray-400 text-gray-700 hover:bg-gray-50 active:bg-gray-100":"bg-gray-600 hover:bg-gray-700 text-white shadow-sm",success:c?"border-2 border-green-500 text-green-600 hover:bg-green-50 active:bg-green-100":"bg-green-600 hover:bg-green-700 text-white shadow-sm",danger:c?"border-2 border-red-500 text-red-600 hover:bg-red-50 active:bg-red-100":"bg-red-600 hover:bg-red-700 text-white shadow-sm",warning:c?"border-2 border-amber-500 text-amber-600 hover:bg-amber-50 active:bg-amber-100":"bg-amber-500 hover:bg-amber-600 text-white shadow-sm",info:c?"border-2 border-blue-400 text-blue-500 hover:bg-blue-50 active:bg-blue-100":"bg-blue-500 hover:bg-blue-600 text-white shadow-sm",light:c?"border-2 border-gray-200 text-gray-600 hover:bg-gray-50 active:bg-gray-100":"bg-gray-100 hover:bg-gray-200 text-gray-800",dark:c?"border-2 border-gray-700 text-gray-800 hover:bg-gray-800 hover:text-white":"bg-gray-800 hover:bg-gray-900 text-white shadow-sm",outline:"border-2 border-gray-300 text-gray-700 hover:border-primary-500 hover:text-primary-600 bg-white",gradient:"bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white shadow-sm"}[t],"\n    ").concat({xs:"text-xs px-2.5 py-1.5 gap-1",sm:"text-sm px-3 py-2 gap-1.5",md:"text-base px-4 py-2.5 gap-2",lg:"text-lg px-5 py-3 gap-2",xl:"text-xl px-6 py-3.5 gap-2.5"}[s],"\n    ").concat(o?"w-full":"","\n    ").concat(d?"rounded-full":"rounded-lg","\n    ").concat(u?"backdrop-blur-sm bg-opacity-80 shadow-sm":"","\n    ").concat({none:"",pulse:"animate-pulse",bounce:"animate-bounce"}[m],"\n    ").concat(f,"\n    ").concat(h,"\n  ");return i?(0,a.jsxs)(n(),{href:i,className:b,children:[p&&(0,a.jsx)("span",{className:"flex items-center",children:p}),r,g&&(0,a.jsx)("span",{className:"flex items-center",children:g})]}):(0,a.jsxs)("button",{className:b,disabled:l||x.disabled,...x,children:[l?(0,a.jsx)(LoadingSpinner,{size:"small",color:c?"primary":"white"}):p?(0,a.jsx)("span",{className:"flex items-center",children:p}):null,(0,a.jsx)("span",{children:r}),g&&!l&&(0,a.jsx)("span",{className:"flex items-center",children:g})]})}},2595:function(e,r,t){"use strict";t.d(r,{Z:function(){return Card}});var a=t(7437);function Card(e){let{children:r,className:t="",padding:s="small",shadow:n="small",rounded:o="medium",border:i=!1,hover:l=!1,clickable:c=!1}=e;return(0,a.jsx)("div",{className:"\n        bg-white\n        ".concat({none:"p-0",xs:"p-2",small:"p-3",medium:"p-4",large:"p-5"}[s],"\n        ").concat({none:"",small:"shadow-sm",medium:"shadow",large:"shadow-lg"}[n],"\n        ").concat({none:"rounded-none",small:"rounded-md",medium:"rounded-lg",large:"rounded-xl"}[o],"\n        ").concat(i?"border border-gray-100":"","\n        ").concat(l?"transition-all duration-200 hover:shadow-md hover:translate-y-[-1px]":"","\n        ").concat(c?"cursor-pointer active:scale-[0.99] active:shadow-inner transition-transform":"","\n        ").concat(t,"\n      "),children:r})}t(2265)},6814:function(e,r,t){"use strict";t.d(r,{Z:function(){return FormField}});var a=t(7437),s=t(2265),n=t(8611);function FormField(e){let{children:r,label:t,htmlFor:o,error:i,hint:l,className:c="",required:d=!1,span:u="full",helpText:m,showHelpIcon:h=!1,animate:p=!1}=e,[g,x]=s.useState(!1),f={full:"col-span-12",half:"col-span-12 md:col-span-6",third:"col-span-12 md:col-span-4",quarter:"col-span-12 md:col-span-3"},FieldContent=()=>(0,a.jsxs)(a.Fragment,{children:[t&&(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1.5",children:[(0,a.jsxs)("label",{htmlFor:o,className:"block text-sm font-medium text-gray-700",children:[t,d&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),h&&m&&(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{type:"button",className:"text-gray-400 hover:text-gray-600 focus:outline-none",onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),onClick:()=>x(!g),children:(0,a.jsx)("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})})}),g&&(0,a.jsx)("div",{className:"absolute z-10 right-0 mt-2 w-64 bg-white rounded-lg shadow-lg p-3 text-xs text-gray-600 border border-gray-200",children:m})]})]}),r,l&&!i&&(0,a.jsx)("p",{className:"mt-1.5 text-xs text-gray-500",children:l}),i&&(0,a.jsxs)(n.E.p,{initial:p?{opacity:0,y:-10}:void 0,animate:p?{opacity:1,y:0}:void 0,className:"mt-1.5 text-xs text-red-600 flex items-center",children:[(0,a.jsx)("svg",{className:"h-3 w-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),i]}),m&&!h&&(0,a.jsx)("p",{className:"mt-1.5 text-xs text-gray-500",children:m})]});return p?(0,a.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"mb-4 ".concat(f[u]," ").concat(c),children:(0,a.jsx)(FieldContent,{})}):(0,a.jsx)("div",{className:"mb-4 ".concat(f[u]," ").concat(c),children:(0,a.jsx)(FieldContent,{})})}},654:function(e,r,t){"use strict";var a=t(7437),s=t(2265);let n=(0,s.forwardRef)((e,r)=>{let{error:t=!1,errorMessage:n,leftIcon:o,rightIcon:i,className:l="",containerClassName:c="",clickableRightIcon:d=!1,onRightIconClick:u,label:m,helperText:h,variant:p="default",size:g="md",isRequired:x=!1,...f}=e,[b,y]=(0,s.useState)(!1),v="underlined"===p?"py-2 ".concat(i?"pr-6":""):"".concat(o?"pl-10":"pl-4"," ").concat(i?"pr-10":"pr-4"," ").concat({xs:"py-1 text-xs",sm:"py-1.5 text-sm",md:"py-2 text-sm",lg:"py-3 text-base"}[g]);return(0,a.jsxs)("div",{className:"relative ".concat(c),children:[m&&(0,a.jsxs)("label",{htmlFor:f.id,className:"block text-sm font-medium text-gray-700 mb-1 flex items-center",children:[m,x&&(0,a.jsx)("span",{className:"ml-1 text-danger-500",children:"*"})]}),(0,a.jsxs)("div",{className:"relative rounded-md",children:[o&&(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)("span",{className:"".concat(t?"text-danger-500":"text-gray-500"," sm:text-sm"),children:o})}),(0,a.jsx)("input",{ref:r,className:"\n            block w-full border rounded-lg \n            transition-all duration-200\n            focus:outline-none\n            ".concat(t?"border-danger-300 text-danger-900 placeholder-danger-300 focus:ring-danger-500 focus:border-danger-500":({default:"border-gray-300 ".concat(b?"border-primary-500 ring-2 ring-primary-50":"hover:border-gray-400"," bg-white shadow-sm"),filled:"bg-gray-50 border-transparent ".concat(b?"border-primary-500 ring-2 ring-primary-50":"hover:bg-gray-100"),outline:"bg-transparent border-gray-300 ".concat(b?"border-primary-500 ring-2 ring-primary-50":"hover:border-gray-400"),underlined:"border-t-0 border-l-0 border-r-0 border-b-2 rounded-none px-0 ".concat(b?"border-primary-500":"border-gray-300 hover:border-gray-400"),glass:"backdrop-blur-sm bg-white bg-opacity-70 border-white border-opacity-20 shadow-sm ".concat(b?"ring-2 ring-white ring-opacity-50":"hover:bg-opacity-80")})[p],"\n            ").concat(v,"\n            ").concat(f.disabled?"bg-gray-100 cursor-not-allowed opacity-70":"","\n            ").concat(l,"\n          "),onFocus:e=>{y(!0),f.onFocus&&f.onFocus(e)},onBlur:e=>{y(!1),f.onBlur&&f.onBlur(e)},...f}),i&&(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center ".concat(d?"cursor-pointer":"pointer-events-none"),onClick:d&&u?u:void 0,children:(0,a.jsx)("span",{className:"".concat(t?"text-danger-500":"text-gray-500"," sm:text-sm transition-colors ").concat(d?"hover:text-primary-500 active:text-primary-600":""),children:i})})]}),(h||n)&&(0,a.jsx)("p",{className:"mt-1 text-xs ".concat(t?"text-danger-600":"text-gray-500"),children:t?n:h})]})});n.displayName="Input",r.Z=n},7436:function(e,r,t){"use strict";t.d(r,{$:function(){return useSupabase}}),t(7437);let useSupabase=()=>{throw Error("useSupabase has been deprecated. Use the backend API endpoints instead.")}},5243:function(e,r,t){"use strict";t.d(r,{a:function(){return useAuth}});var a=t(4523);function useAuth(){var e;let r=(0,a.useAuth)(),t=(null===(e=r.user)||void 0===e?void 0:e.role)||"customer",signIn=async(e,t)=>{try{return await r.signIn(e,t),{error:null}}catch(e){return{error:e}}},signUp=async(e,t,a)=>{try{return await r.signUp(e,t,a),{error:null}}catch(e){return{error:e}}};return{...r,role:t,signIn,signUp}}},4523:function(e,r,t){"use strict";t.r(r),t.d(r,{AuthProvider:function(){return AuthProvider},default:function(){return c},useAuth:function(){return useAuth}});var a=t(7437),s=t(2265);let n="bigdealegypt.up.railway.app/api",signIn=async(e,r)=>{try{let a=await fetch("".concat(n,"/auth/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r}),credentials:"include"});if(!a.ok){var t;let e=await a.json();throw Error((null===(t=e.error)||void 0===t?void 0:t.message)||"Authentication failed")}return await a.json()}catch(e){throw console.error("Sign in error:",e),e}},signUp=async(e,r,t)=>{try{let s=await fetch("".concat(n,"/auth/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r,name:t})});if(!s.ok){var a;let e=await s.json();throw Error((null===(a=e.error)||void 0===a?void 0:a.message)||"Registration failed")}return await s.json()}catch(e){throw console.error("Sign up error:",e),e}},signOut=async()=>{try{let r=await fetch("".concat(n,"/auth/signout"),{method:"POST",credentials:"include"});if(!r.ok){var e;let t=await r.json();throw Error((null===(e=t.error)||void 0===e?void 0:e.message)||"Sign out failed")}return await r.json()}catch(e){throw console.error("Sign out error:",e),e}},getSession=async e=>{try{let t=await fetch("".concat(n,"/auth/session"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)},credentials:"include"});if(!t.ok){var r;let e=await t.json();throw Error((null===(r=e.error)||void 0===r?void 0:r.message)||"Failed to retrieve session")}return await t.json()}catch(e){throw console.error("Get session error:",e),e}},refreshToken=async()=>{try{let r=await fetch("".concat(n,"/auth/refresh-token"),{method:"POST",credentials:"include"});if(!r.ok){var e;let t=await r.json();throw Error((null===(e=t.error)||void 0===e?void 0:e.message)||"Failed to refresh token")}return await r.json()}catch(e){throw console.error("Refresh token error:",e),e}},getUserProfile=async(e,r)=>{try{let a=await fetch("".concat(n,"/auth/profile/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(r)}});if(!a.ok){var t;let e=await a.json();throw Error((null===(t=e.error)||void 0===t?void 0:t.message)||"Failed to get user profile")}return await a.json()}catch(e){throw console.error("Get user profile error:",e),e}};var o={signIn,signUp,signOut,getSession,refreshToken,getUserProfile},i=t(4033);let l=(0,s.createContext)(void 0),AuthProvider=e=>{let{children:r}=e,[t,n]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[u,m]=(0,s.useState)(!0),[h,p]=(0,s.useState)(null),g=(0,i.useRouter)();(0,s.useEffect)(()=>{if(c){let e=new Date(c.expires_at).getTime(),r=Date.now(),t=e-r;if(t<3e5){refreshSession();return}let a=setTimeout(()=>{refreshSession()},t-3e5);return()=>clearTimeout(a)}},[c]),(0,s.useEffect)(()=>{let initAuth=async()=>{m(!0),p(null);try{let e=localStorage.getItem("access_token");if(!e){m(!1);return}let r=await o.getSession(e);(null==r?void 0:r.user)&&(null==r?void 0:r.session)?(n(r.user),d(r.session),localStorage.setItem("access_token",r.session.access_token)):localStorage.removeItem("access_token")}catch(e){console.error("Auth initialization error:",e),localStorage.removeItem("access_token"),p("Authentication error. Please login again.")}finally{m(!1)}};initAuth()},[]);let signIn=async(e,r)=>{m(!0),p(null);try{let t=await o.signIn(e,r);(null==t?void 0:t.user)&&(null==t?void 0:t.session)&&(n(t.user),d(t.session),localStorage.setItem("access_token",t.session.access_token),g.push("/dashboard"))}catch(e){throw console.error("Sign in error:",e),p(e instanceof Error?e.message:"Authentication failed"),e}finally{m(!1)}},signUp=async(e,r,t)=>{m(!0),p(null);try{let a=await o.signUp(e,r,t);(null==a?void 0:a.user)&&g.push("/login?registered=true")}catch(e){throw console.error("Sign up error:",e),p(e instanceof Error?e.message:"Registration failed"),e}finally{m(!1)}},signOut=async()=>{m(!0);try{await o.signOut(),n(null),d(null),localStorage.removeItem("access_token"),g.push("/")}catch(e){console.error("Sign out error:",e),n(null),d(null),localStorage.removeItem("access_token"),g.push("/")}finally{m(!1)}},refreshSession=async()=>{if(!u)try{let e=await o.refreshToken();(null==e?void 0:e.user)&&(null==e?void 0:e.session)?(n(e.user),d(e.session),localStorage.setItem("access_token",e.session.access_token)):(n(null),d(null),localStorage.removeItem("access_token"),g.push("/login"))}catch(e){console.error("Session refresh error:",e),n(null),d(null),localStorage.removeItem("access_token"),g.push("/login")}};return(0,a.jsx)(l.Provider,{value:{user:t,session:c,loading:u,error:h,isAuthenticated:!!t,signIn,signUp,signOut,refreshSession},children:r})},useAuth=()=>{let e=(0,s.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e};var c=l},4033:function(e,r,t){e.exports=t(94)}},function(e){e.O(0,[2438,8920,8611,2971,2472,1744],function(){return e(e.s=1486)}),_N_E=e.O()}]);