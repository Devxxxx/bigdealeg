(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2673],{7624:function(e,r,t){Promise.resolve().then(t.bind(t,7191))},7191:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return NewPropertyRequest}});var a=t(7437),s=t(2265),n=t(4033),i=t(1396),l=t.n(i),o=t(8611),d=t(5243),c=t(6081),u=t(1865),m=t(8920),p=t(2595),x=t(4734),h=t(654);function NewPropertyRequest(){let{user:e}=(0,d.a)(),r=(0,n.useRouter)(),{createRequest:t,fields:i,loading:b}=(0,c.m)(),[y,g]=(0,s.useState)(!1),[f,v]=(0,s.useState)(1),[j,w]=(0,s.useState)(0),{register:N,handleSubmit:_,watch:q,formState:{errors:k,isValid:P,touchedFields:C,dirtyFields:S}}=(0,u.cI)({mode:"onChange",defaultValues:{title:"",property_type:"",location:"",min_price:"",max_price:"",bedrooms:"",bathrooms:"",area_size:"",additional_features:""}}),E=q();(0,s.useEffect)(()=>{if(b)return;let e=i.filter(e=>e.is_required).map(e=>e.field_name),r=["title","property_type","location","min_price","max_price","bedrooms","bathrooms","area_size",...e],t=r.filter(e=>{let r=E[e];return null!=r&&""!==r}).length,a=Math.min(Math.round(t/r.length*100),100);w(a)},[E,i,b]);let onSubmit=async a=>{if(e){g(!0);try{let e={};i.forEach(r=>{void 0!==a[r.field_name]&&(e[r.field_name]=a[r.field_name],delete a[r.field_name])});let s={title:a.title,property_type:a.property_type,location:a.location,min_price:Number(a.min_price),max_price:Number(a.max_price),bedrooms:a.bedrooms,bathrooms:a.bathrooms,area_size:Number(a.area_size),additional_features:a.additional_features,custom_fields:e},n=await t(s);n&&r.push("/dashboard/property-requests/".concat(n.id))}catch(e){console.error("Error creating property request:",e),alert("Failed to create property request. Please try again.")}finally{g(!1)}}},F=i.length>0?3:2,R=1===f?[{id:"title",name:"title",label:"Request Title",type:"text",span:"full",required:!0,icon:m.NOg},{id:"property_type",name:"property_type",label:"Property Type",type:"select",span:"half",required:!0,icon:m.m6D},{id:"location",name:"location",label:"Location",type:"text",span:"half",required:!0,icon:m.i63},{id:"min_price",name:"min_price",label:"Minimum Price (EGP)",type:"number",span:"half",required:!0,icon:m.oQC},{id:"max_price",name:"max_price",label:"Maximum Price (EGP)",type:"number",span:"half",required:!0,icon:m.oQC}]:2===f?[{id:"bedrooms",name:"bedrooms",label:"Bedrooms",type:"select",span:"third",required:!0,icon:m.D7o},{id:"bathrooms",name:"bathrooms",label:"Bathrooms",type:"select",span:"third",required:!0,icon:m.D7o},{id:"area_size",name:"area_size",label:"Area Size (m\xb2)",type:"number",span:"third",required:!0,icon:m.D7o},{id:"additional_features",name:"additional_features",label:"Additional Features & Requirements",type:"textarea",span:"full",required:!1,icon:null}]:3===f?i.map(e=>({id:e.field_name,name:e.field_name,label:e.field_label,type:e.field_type,span:e.field_span,required:e.is_required,help:e.help_text,icon:null,options:e.options})):[];return b?(0,a.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,a.jsxs)("div",{className:"relative h-10 w-10",children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 right-0 bottom-0 border-t-3 border-primary-500 border-solid rounded-full animate-spin"}),(0,a.jsx)("div",{className:"absolute top-0 left-0 right-0 bottom-0 border-t-3 border-primary-200 border-solid rounded-full opacity-20"})]})}):(0,a.jsxs)(o.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[(0,a.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 gap-2",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)(l(),{href:"/dashboard/property-requests",className:"inline-flex items-center text-xs text-gray-500 hover:text-primary mb-1",children:[(0,a.jsx)(m.Ao2,{className:"mr-1 h-3 w-3"}),"Back to requests"]}),(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"New Property Request"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Tell us what you're looking for and we'll find matching properties"})]})}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-gray-700",children:"Form Progress"}),(0,a.jsxs)("span",{className:"text-xs font-medium text-gray-700",children:[j,"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,a.jsx)("div",{className:"bg-primary-500 h-1.5 rounded-full transition-all duration-300",style:{width:"".concat(j,"%")}})})]}),(0,a.jsx)("div",{className:"flex mb-3",children:Array.from({length:F}).map((e,r)=>(0,a.jsxs)("div",{className:"flex-1 flex items-center",onClick:()=>r<f&&v(r+1),children:[(0,a.jsx)("div",{className:"h-6 w-6 rounded-full flex items-center justify-center text-xs font-medium ".concat(r+1<f?"bg-primary-500 text-white":r+1===f?"bg-primary-100 text-primary-700 border border-primary-500":"bg-gray-100 text-gray-500 border border-gray-300"),children:r+1<f?(0,a.jsx)(m.UgA,{className:"h-3 w-3"}):r+1}),r<F-1&&(0,a.jsx)("div",{className:"flex-1 h-0.5 ".concat(r+1<f?"bg-primary-500":"bg-gray-200")})]},r))}),(0,a.jsx)(p.Z,{children:(0,a.jsxs)("form",{onSubmit:_(onSubmit),children:[(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-6",children:R.map(e=>{var r;return(0,a.jsx)("div",{className:"".concat("checkbox"===e.type?"flex items-start space-x-2":""," ").concat("full"===e.span?"sm:col-span-6":"half"===e.span?"sm:col-span-3":(e.span,"sm:col-span-2")),children:"checkbox"===e.type?(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"flex items-center h-5",children:(0,a.jsx)("input",{id:e.id,type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-500",...N(e.name,{required:e.required})})}),(0,a.jsxs)("div",{className:"ml-2",children:[(0,a.jsxs)("label",{htmlFor:e.id,className:"text-xs font-medium text-gray-700",children:[e.label,e.required&&(0,a.jsx)("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.help&&(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:e.help})]})]}):"select"===e.type?(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:e.id,className:"flex items-center text-xs font-medium text-gray-700 mb-1",children:[e.icon&&(0,a.jsx)(e.icon,{className:"mr-1 h-3 w-3 text-gray-400"}),e.label,e.required&&(0,a.jsx)("span",{className:"text-red-500 ml-0.5",children:"*"})]}),"property_type"===e.name?(0,a.jsxs)("select",{id:e.id,className:"block w-full rounded-lg border ".concat(k[e.name]?"border-red-300":"border-gray-300"," py-1.5 px-3 text-sm bg-white focus:outline-none focus:ring-primary-500 focus:border-primary-500"),defaultValue:"",...N(e.name,{required:e.required}),children:[(0,a.jsx)("option",{value:"",disabled:!0,children:"Select a property type"}),(0,a.jsx)("option",{value:"Apartment",children:"Apartment"}),(0,a.jsx)("option",{value:"Villa",children:"Villa"}),(0,a.jsx)("option",{value:"Townhouse",children:"Townhouse"}),(0,a.jsx)("option",{value:"Penthouse",children:"Penthouse"}),(0,a.jsx)("option",{value:"Chalet",children:"Chalet"}),(0,a.jsx)("option",{value:"Duplex",children:"Duplex"}),(0,a.jsx)("option",{value:"Office",children:"Office"}),(0,a.jsx)("option",{value:"Shop",children:"Shop"}),(0,a.jsx)("option",{value:"Land",children:"Land"})]}):"bedrooms"===e.name?(0,a.jsxs)("select",{id:e.id,className:"block w-full rounded-lg border ".concat(k[e.name]?"border-red-300":"border-gray-300"," py-1.5 px-3 text-sm bg-white focus:outline-none focus:ring-primary-500 focus:border-primary-500"),defaultValue:"",...N(e.name,{required:e.required}),children:[(0,a.jsx)("option",{value:"",disabled:!0,children:"Select bedrooms"}),(0,a.jsx)("option",{value:"Studio",children:"Studio"}),(0,a.jsx)("option",{value:"1",children:"1"}),(0,a.jsx)("option",{value:"2",children:"2"}),(0,a.jsx)("option",{value:"3",children:"3"}),(0,a.jsx)("option",{value:"4",children:"4"}),(0,a.jsx)("option",{value:"5",children:"5"}),(0,a.jsx)("option",{value:"6+",children:"6+"})]}):"bathrooms"===e.name?(0,a.jsxs)("select",{id:e.id,className:"block w-full rounded-lg border ".concat(k[e.name]?"border-red-300":"border-gray-300"," py-1.5 px-3 text-sm bg-white focus:outline-none focus:ring-primary-500 focus:border-primary-500"),defaultValue:"",...N(e.name,{required:e.required}),children:[(0,a.jsx)("option",{value:"",disabled:!0,children:"Select bathrooms"}),(0,a.jsx)("option",{value:"1",children:"1"}),(0,a.jsx)("option",{value:"2",children:"2"}),(0,a.jsx)("option",{value:"3",children:"3"}),(0,a.jsx)("option",{value:"4",children:"4"}),(0,a.jsx)("option",{value:"5+",children:"5+"})]}):e.options?(0,a.jsxs)("select",{id:e.id,className:"block w-full rounded-lg border ".concat(k[e.name]?"border-red-300":"border-gray-300"," py-1.5 px-3 text-sm bg-white focus:outline-none focus:ring-primary-500 focus:border-primary-500"),defaultValue:"",...N(e.name,{required:e.required}),children:[(0,a.jsx)("option",{value:"",disabled:!0,children:e.placeholder||"Select an option"}),null===(r=e.options)||void 0===r?void 0:r.split(",").map(e=>(0,a.jsx)("option",{value:e.trim(),children:e.trim()},e.trim()))]}):(0,a.jsx)("select",{id:e.id,className:"block w-full rounded-lg border ".concat(k[e.name]?"border-red-300":"border-gray-300"," py-1.5 px-3 text-sm bg-white focus:outline-none focus:ring-primary-500 focus:border-primary-500"),defaultValue:"",...N(e.name,{required:e.required}),children:(0,a.jsx)("option",{value:"",disabled:!0,children:e.placeholder||"Select an option"})}),k[e.name]&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-600",children:"This field is required"}),e.help&&(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:e.help})]}):"textarea"===e.type?(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:e.id,className:"flex items-center text-xs font-medium text-gray-700 mb-1",children:[e.icon&&(0,a.jsx)(e.icon,{className:"mr-1 h-3 w-3 text-gray-400"}),e.label,e.required&&(0,a.jsx)("span",{className:"text-red-500 ml-0.5",children:"*"})]}),(0,a.jsx)("textarea",{id:e.id,rows:3,className:"block w-full rounded-lg border ".concat(k[e.name]?"border-red-300":"border-gray-300"," shadow-sm text-sm py-1.5 px-3 focus:border-primary-500 focus:ring focus:ring-primary-500 focus:ring-opacity-50"),placeholder:e.placeholder||"Enter ".concat(e.label.toLowerCase()),...N(e.name,{required:e.required})}),k[e.name]&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-600",children:"This field is required"}),e.help&&(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:e.help})]}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:e.id,className:"flex items-center text-xs font-medium text-gray-700 mb-1",children:[e.icon&&(0,a.jsx)(e.icon,{className:"mr-1 h-3 w-3 text-gray-400"}),e.label,e.required&&(0,a.jsx)("span",{className:"text-red-500 ml-0.5",children:"*"})]}),(0,a.jsx)(h.Z,{id:e.id,type:"number"===e.type?"number":"text",placeholder:e.placeholder||"Enter ".concat(e.label.toLowerCase()),...N(e.name,{required:e.required,min:"number"===e.type?0:void 0}),error:!!k[e.name],size:"sm"}),k[e.name]&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-600",children:"This field is required"}),e.help&&(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:e.help})]})},e.id)})})}),(0,a.jsxs)("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-100 flex justify-between",children:[(0,a.jsx)("div",{children:f>1&&(0,a.jsx)(x.Z,{type:"button",variant:"light",size:"sm",onClick:()=>{v(e=>Math.max(e-1,1))},children:"Previous"})}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(x.Z,{type:"button",variant:"outline",size:"sm",onClick:()=>r.push("/dashboard/property-requests"),children:"Cancel"}),f<F?(0,a.jsx)(x.Z,{type:"button",variant:"primary",size:"sm",onClick:()=>{v(e=>Math.min(e+1,F))},children:"Next"}):(0,a.jsx)(x.Z,{type:"submit",variant:"gradient",leftIcon:(0,a.jsx)(m.mW3,{}),size:"sm",loading:y,children:y?"Creating...":"Create Request"})]})]})]})}),1===f&&(0,a.jsx)(p.Z,{className:"mt-3 bg-blue-50 border-blue-100",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"flex-shrink-0 pt-0.5",children:(0,a.jsx)(m.H33,{className:"h-5 w-5 text-blue-500"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"Property Request Tips"}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-blue-700 space-y-1",children:[(0,a.jsx)("p",{children:"• A descriptive title helps us understand your needs better"}),(0,a.jsx)("p",{children:"• Be specific about your preferred location(s)"}),(0,a.jsx)("p",{children:"• Set a realistic price range based on your budget"})]})]})]})})]})}},4734:function(e,r,t){"use strict";t.d(r,{Z:function(){return Button}});var a=t(7437);t(2265);var s=t(1396),n=t.n(s);function LoadingSpinner(e){let{size:r="medium",color:t="primary",className:s=""}=e;return(0,a.jsx)("div",{className:"flex justify-center items-center ".concat(s),children:(0,a.jsx)("div",{className:"\n          rounded-full\n          animate-spin\n          ".concat({small:"h-4 w-4 border-2",medium:"h-8 w-8 border-2",large:"h-12 w-12 border-3"}[r],"\n          ").concat({primary:"border-primary-300 border-t-primary",white:"border-gray-200 border-t-white",gray:"border-gray-200 border-t-gray-600"}[t],"\n        ")})})}function Button(e){let{children:r,variant:t="primary",size:s="md",fullWidth:i=!1,href:l,loading:o=!1,outline:d=!1,rounded:c=!0,glass:u=!1,animation:m="none",className:p="",leftIcon:x,rightIcon:h,...b}=e,y=b.disabled?"opacity-60 cursor-not-allowed":"transform active:scale-[0.98] transition-transform",g="\n    inline-flex items-center justify-center\n    font-medium\n    transition-all duration-200\n    focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\n    ".concat({primary:d?"border-2 border-primary-500 text-primary-600 hover:bg-primary-50 active:bg-primary-100":"bg-primary-600 hover:bg-primary-700 text-white shadow-sm",secondary:d?"border-2 border-gray-400 text-gray-700 hover:bg-gray-50 active:bg-gray-100":"bg-gray-600 hover:bg-gray-700 text-white shadow-sm",success:d?"border-2 border-green-500 text-green-600 hover:bg-green-50 active:bg-green-100":"bg-green-600 hover:bg-green-700 text-white shadow-sm",danger:d?"border-2 border-red-500 text-red-600 hover:bg-red-50 active:bg-red-100":"bg-red-600 hover:bg-red-700 text-white shadow-sm",warning:d?"border-2 border-amber-500 text-amber-600 hover:bg-amber-50 active:bg-amber-100":"bg-amber-500 hover:bg-amber-600 text-white shadow-sm",info:d?"border-2 border-blue-400 text-blue-500 hover:bg-blue-50 active:bg-blue-100":"bg-blue-500 hover:bg-blue-600 text-white shadow-sm",light:d?"border-2 border-gray-200 text-gray-600 hover:bg-gray-50 active:bg-gray-100":"bg-gray-100 hover:bg-gray-200 text-gray-800",dark:d?"border-2 border-gray-700 text-gray-800 hover:bg-gray-800 hover:text-white":"bg-gray-800 hover:bg-gray-900 text-white shadow-sm",outline:"border-2 border-gray-300 text-gray-700 hover:border-primary-500 hover:text-primary-600 bg-white",gradient:"bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-white shadow-sm"}[t],"\n    ").concat({xs:"text-xs px-2.5 py-1.5 gap-1",sm:"text-sm px-3 py-2 gap-1.5",md:"text-base px-4 py-2.5 gap-2",lg:"text-lg px-5 py-3 gap-2",xl:"text-xl px-6 py-3.5 gap-2.5"}[s],"\n    ").concat(i?"w-full":"","\n    ").concat(c?"rounded-full":"rounded-lg","\n    ").concat(u?"backdrop-blur-sm bg-opacity-80 shadow-sm":"","\n    ").concat({none:"",pulse:"animate-pulse",bounce:"animate-bounce"}[m],"\n    ").concat(y,"\n    ").concat(p,"\n  ");return l?(0,a.jsxs)(n(),{href:l,className:g,children:[x&&(0,a.jsx)("span",{className:"flex items-center",children:x}),r,h&&(0,a.jsx)("span",{className:"flex items-center",children:h})]}):(0,a.jsxs)("button",{className:g,disabled:o||b.disabled,...b,children:[o?(0,a.jsx)(LoadingSpinner,{size:"small",color:d?"primary":"white"}):x?(0,a.jsx)("span",{className:"flex items-center",children:x}):null,(0,a.jsx)("span",{children:r}),h&&!o&&(0,a.jsx)("span",{className:"flex items-center",children:h})]})}},2595:function(e,r,t){"use strict";t.d(r,{Z:function(){return Card}});var a=t(7437);function Card(e){let{children:r,className:t="",padding:s="small",shadow:n="small",rounded:i="medium",border:l=!1,hover:o=!1,clickable:d=!1}=e;return(0,a.jsx)("div",{className:"\n        bg-white\n        ".concat({none:"p-0",xs:"p-2",small:"p-3",medium:"p-4",large:"p-5"}[s],"\n        ").concat({none:"",small:"shadow-sm",medium:"shadow",large:"shadow-lg"}[n],"\n        ").concat({none:"rounded-none",small:"rounded-md",medium:"rounded-lg",large:"rounded-xl"}[i],"\n        ").concat(l?"border border-gray-100":"","\n        ").concat(o?"transition-all duration-200 hover:shadow-md hover:translate-y-[-1px]":"","\n        ").concat(d?"cursor-pointer active:scale-[0.99] active:shadow-inner transition-transform":"","\n        ").concat(t,"\n      "),children:r})}t(2265)},654:function(e,r,t){"use strict";var a=t(7437),s=t(2265);let n=(0,s.forwardRef)((e,r)=>{let{error:t=!1,errorMessage:n,leftIcon:i,rightIcon:l,className:o="",containerClassName:d="",clickableRightIcon:c=!1,onRightIconClick:u,label:m,helperText:p,variant:x="default",size:h="md",isRequired:b=!1,...y}=e,[g,f]=(0,s.useState)(!1),v="underlined"===x?"py-2 ".concat(l?"pr-6":""):"".concat(i?"pl-10":"pl-4"," ").concat(l?"pr-10":"pr-4"," ").concat({xs:"py-1 text-xs",sm:"py-1.5 text-sm",md:"py-2 text-sm",lg:"py-3 text-base"}[h]);return(0,a.jsxs)("div",{className:"relative ".concat(d),children:[m&&(0,a.jsxs)("label",{htmlFor:y.id,className:"block text-sm font-medium text-gray-700 mb-1 flex items-center",children:[m,b&&(0,a.jsx)("span",{className:"ml-1 text-danger-500",children:"*"})]}),(0,a.jsxs)("div",{className:"relative rounded-md",children:[i&&(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)("span",{className:"".concat(t?"text-danger-500":"text-gray-500"," sm:text-sm"),children:i})}),(0,a.jsx)("input",{ref:r,className:"\n            block w-full border rounded-lg \n            transition-all duration-200\n            focus:outline-none\n            ".concat(t?"border-danger-300 text-danger-900 placeholder-danger-300 focus:ring-danger-500 focus:border-danger-500":({default:"border-gray-300 ".concat(g?"border-primary-500 ring-2 ring-primary-50":"hover:border-gray-400"," bg-white shadow-sm"),filled:"bg-gray-50 border-transparent ".concat(g?"border-primary-500 ring-2 ring-primary-50":"hover:bg-gray-100"),outline:"bg-transparent border-gray-300 ".concat(g?"border-primary-500 ring-2 ring-primary-50":"hover:border-gray-400"),underlined:"border-t-0 border-l-0 border-r-0 border-b-2 rounded-none px-0 ".concat(g?"border-primary-500":"border-gray-300 hover:border-gray-400"),glass:"backdrop-blur-sm bg-white bg-opacity-70 border-white border-opacity-20 shadow-sm ".concat(g?"ring-2 ring-white ring-opacity-50":"hover:bg-opacity-80")})[x],"\n            ").concat(v,"\n            ").concat(y.disabled?"bg-gray-100 cursor-not-allowed opacity-70":"","\n            ").concat(o,"\n          "),onFocus:e=>{f(!0),y.onFocus&&y.onFocus(e)},onBlur:e=>{f(!1),y.onBlur&&y.onBlur(e)},...y}),l&&(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center ".concat(c?"cursor-pointer":"pointer-events-none"),onClick:c&&u?u:void 0,children:(0,a.jsx)("span",{className:"".concat(t?"text-danger-500":"text-gray-500"," sm:text-sm transition-colors ").concat(c?"hover:text-primary-500 active:text-primary-600":""),children:l})})]}),(p||n)&&(0,a.jsx)("p",{className:"mt-1 text-xs ".concat(t?"text-danger-600":"text-gray-500"),children:t?n:p})]})});n.displayName="Input",r.Z=n},6081:function(e,r,t){"use strict";t.d(r,{m:function(){return usePropertyRequests}});var a=t(2265),s=t(5243),n=t(4389);function usePropertyRequests(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[r,t]=(0,a.useState)([]),[i,l]=(0,a.useState)(null),[o,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(null),[m,p]=(0,a.useState)(e.filters||{}),[x,h]=(0,a.useState)({page:1,limit:10,totalPages:1,totalCount:0}),[b,y]=(0,a.useState)([]),{user:g,session:f}=(0,s.a)(),v=(0,a.useCallback)(async()=>{if(g&&(null==f?void 0:f.access_token)){d(!0),u(null);try{let e=await n.ZP.getPropertyRequests(f.access_token,{...m,page:x.page,limit:x.limit,role:null==g?void 0:g.role});console.log("Property requests result:",e),t(e.requests||[]),h({...x,totalPages:e.totalPages||1,totalCount:e.totalCount||0})}catch(e){console.error("Error fetching property requests:",e),u(e.message||"Failed to fetch property requests")}finally{d(!1)}}},[g,f,m,x.page,x.limit]),j=(0,a.useCallback)(async e=>{if(g&&(null==f?void 0:f.access_token)&&e){d(!0),u(null);try{let r=await n.ZP.getPropertyRequestById(f.access_token,e);return l(r),r}catch(e){return console.error("Error fetching property request:",e),u(e.message||"Failed to fetch property request"),null}finally{d(!1)}}},[g,f]),w=(0,a.useCallback)(async e=>{if(!g||!(null==f?void 0:f.access_token))return null;d(!0),u(null);try{let r=await n.ZP.createPropertyRequest(f.access_token,e);return r}catch(e){return console.error("Error creating property request:",e),u(e.message||"Failed to create property request"),null}finally{d(!1)}},[g,f]),N=(0,a.useCallback)(async(e,r)=>{if(!g||!(null==f?void 0:f.access_token)||!e)return null;d(!0),u(null);try{let a=await n.ZP.updatePropertyRequest(f.access_token,e,r);return i&&i.id===e&&l(a),t(r=>r.map(r=>r.id===e?{...r,...a}:r)),a}catch(e){return console.error("Error updating property request:",e),u(e.message||"Failed to update property request"),null}finally{d(!1)}},[g,f,i]),_=(0,a.useCallback)(async e=>{if(!g||!(null==f?void 0:f.access_token)||!e)return!1;d(!0),u(null);try{return await n.ZP.deletePropertyRequest(f.access_token,e),t(r=>r.filter(r=>r.id!==e)),i&&i.id===e&&l(null),!0}catch(e){return console.error("Error deleting property request:",e),u(e.message||"Failed to delete property request"),!1}finally{d(!1)}},[g,f,i]),q=(0,a.useCallback)(async()=>{if(g&&(null==f?void 0:f.access_token)){d(!0),u(null);try{let e=await n.ZP.getPropertyRequestFields(f.access_token);return y(e||[]),e}catch(e){return console.error("Error fetching property request fields:",e),u(e.message||"Failed to fetch property request fields"),[]}finally{d(!1)}}},[g,f]),k=(0,a.useCallback)(async function(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!g||!(null==f?void 0:f.access_token)||!e||!r)return null;d(!0),u(null);try{let s=await n.ZP.assignPropertyRequest(f.access_token,e,r,a);return i&&i.id===e&&l({...i,assigned_to:r,assigned_to_profile:s.assigned_to_profile}),t(t=>t.map(t=>t.id===e?{...t,assigned_to:r,assigned_to_profile:s.assigned_to_profile}:t)),s}catch(e){return console.error("Error assigning property request:",e),u(e.message||"Failed to assign property request"),null}finally{d(!1)}},[g,f,i]),P=(0,a.useCallback)(async(e,r)=>{if(!g||!(null==f?void 0:f.access_token)||!e||!r.status)return null;d(!0),u(null);try{let a=await n.ZP.addStatusUpdate(f.access_token,e,r);return i&&i.id===e&&l({...i,status:r.status,status_history:[a.history,...i.status_history||[]]}),t(t=>t.map(t=>t.id===e?{...t,status:r.status}:t)),a}catch(e){return console.error("Error updating property request status:",e),u(e.message||"Failed to update property request status"),null}finally{d(!1)}},[g,f,i]),C=(0,a.useCallback)(e=>{p(r=>({...r,...e})),h(e=>({...e,page:1}))},[]),S=(0,a.useCallback)(e=>{h(r=>({...r,...e}))},[]);return(0,a.useEffect)(()=>{e.loadOnMount&&v()},[e.loadOnMount,v]),(0,a.useEffect)(()=>{q()},[q]),{requests:r,currentRequest:i,loading:o,error:c,filters:m,pagination:x,fields:b,fetchRequests:v,fetchRequestById:j,createRequest:w,updateRequest:N,deleteRequest:_,fetchFields:q,assignRequest:k,addStatusUpdate:P,updateFilters:C,updatePagination:S,setCurrentRequest:l}}}},function(e){e.O(0,[2438,8920,8611,9540,6453,2971,2472,1744],function(){return e(e.s=7624)}),_N_E=e.O()}]);