(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6102],{4083:function(e,s,t){Promise.resolve().then(t.bind(t,7658))},7658:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return ViewingDetails}});var a=t(7437),i=t(2265),r=t(4033),n=t(1396),l=t.n(n),c=t(5243),d=t(2749),m=t(8920),o=t(2595),x=t(4734),h=t(907);function ViewingDetails(){var e;let{id:s}=(0,r.useParams)(),t=(0,r.useRouter)(),{user:n,session:u}=(0,c.a)(),[g,p]=(0,i.useState)(null),[j,f]=(0,i.useState)(!0),[v,y]=(0,i.useState)(null),[N,w]=(0,i.useState)(!1);if((0,i.useEffect)(()=>{let fetchViewing=async()=>{if(n&&(null==u?void 0:u.access_token))try{f(!0);let e=await d.ZP.getScheduledViewingById(u.access_token,s);console.log("Raw API response:",e);let t={...e};!t.property&&t.property_id&&(t.property=t.property_id),console.log("Processed data:",t),p(t)}catch(e){console.error("Error fetching viewing details:",e),y("Failed to load viewing details")}finally{f(!1)}};fetchViewing()},[s,n,u]),j)return(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsxs)("div",{className:"relative h-16 w-16",children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 right-0 bottom-0 border-t-4 border-primary-500 border-solid rounded-full animate-spin"}),(0,a.jsx)("div",{className:"absolute top-0 left-0 right-0 bottom-0 border-t-4 border-primary-200 border-solid rounded-full opacity-20"})]})});if(v||!g)return(0,a.jsxs)(o.Z,{className:"p-6 text-center",children:[(0,a.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:(0,a.jsx)(m.bcx,{className:"h-6 w-6 text-red-600"})}),(0,a.jsx)("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"Viewing Not Found"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"The viewing appointment you're looking for doesn't exist or you don't have access to it."}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)(x.Z,{variant:"primary",onClick:()=>t.push("/dashboard/scheduled-viewings"),leftIcon:(0,a.jsx)(m.Ao2,{}),children:"Back to Viewings"})})]});console.log("Viewing object structure:",g),console.log("Property info:",g.property);let isPastDate=e=>{if(!e)return!1;let s=new Date(e),t=new Date;return t.setHours(0,0,0,0),s<t},b="pending"===g.status||"confirmed"===g.status&&!isPastDate(g.viewing_date);return(0,a.jsxs)("div",{className:"opacity-100 transition-opacity duration-500",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)(l(),{href:"/dashboard/scheduled-viewings",className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700",children:[(0,a.jsx)(m.Ao2,{className:"mr-2 h-4 w-4"}),"Back to Scheduled Viewings"]}),(0,a.jsx)("h1",{className:"mt-2 text-2xl font-bold text-gray-900",children:"Viewing Details"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(o.Z,{children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mr-3",children:g.property?g.property.title:"Property Viewing"}),(e=>{switch(e){case"confirmed":return(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-green-100 text-green-800",children:[(0,a.jsx)(m.UgA,{className:"mr-1 h-4 w-4"}),"Confirmed"]});case"pending":return(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800",children:[(0,a.jsx)(m.H33,{className:"mr-1 h-4 w-4"}),"Pending"]});case"cancelled":return(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-red-100 text-red-800",children:[(0,a.jsx)(m.q5L,{className:"mr-1 h-4 w-4"}),"Cancelled"]});case"completed":return(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:[(0,a.jsx)(m._rq,{className:"mr-1 h-4 w-4"}),"Completed"]});default:return(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-gray-100 text-gray-800",children:e})}})(g.status)]}),b&&(0,a.jsx)(x.Z,{variant:"danger",size:"sm",className:"mt-2 sm:mt-0",leftIcon:(0,a.jsx)(m.q5L,{}),onClick:()=>w(!0),children:"Cancel Viewing"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Viewing Details"}),(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(m.vlc,{className:"h-5 w-5 text-primary-500 mt-0.5 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Date"}),(0,a.jsx)("div",{className:"text-gray-700",children:(e=g.viewing_date)?new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"Date pending"})]})]}),(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(m.TCC,{className:"h-5 w-5 text-primary-500 mt-0.5 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Time"}),(0,a.jsx)("div",{className:"text-gray-700",children:g.viewing_time?(e=>{if(!e)return"Time pending";let[s,t]=e.split(":"),a=parseInt(s);return"".concat(a%12||12,":").concat(t," ").concat(a>=12?"PM":"AM")})(g.viewing_time):"Time pending"})]})]}),(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(m.H33,{className:"h-5 w-5 text-primary-500 mt-0.5 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Status"}),(0,a.jsx)("div",{className:"text-gray-700",children:g.status.charAt(0).toUpperCase()+g.status.slice(1)})]})]})]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Property Information"}),(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(m.m6D,{className:"h-5 w-5 text-primary-500 mt-0.5 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Type"}),(0,a.jsx)("div",{className:"text-gray-700",children:g.property?g.property.property_type:"Not specified"})]})]}),(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(m.i63,{className:"h-5 w-5 text-primary-500 mt-0.5 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Location"}),(0,a.jsx)("div",{className:"text-gray-700",children:g.property?g.property.location:"Not specified"})]})]}),(0,a.jsx)("div",{children:(0,a.jsxs)(l(),{href:"/properties/".concat(g.property_id),className:"text-primary-600 hover:text-primary-800 flex items-center",children:["View Property",(0,a.jsx)(m.AlO,{className:"ml-1 h-4 w-4"})]})})]})})]})]}),"pending"===g.status&&!g.viewing_date&&g.preferred_dates&&g.preferred_times&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Your Preferences"}),(0,a.jsx)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(m.vlc,{className:"h-5 w-5 text-yellow-600 mt-0.5 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Preferred Dates"}),(0,a.jsx)("div",{className:"text-gray-700",children:Array.isArray(g.preferred_dates)&&g.preferred_dates.map(e=>new Date(e).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})).join(", ")})]})]}),(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(m.TCC,{className:"h-5 w-5 text-yellow-600 mt-0.5 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Preferred Times"}),(0,a.jsx)("div",{className:"text-gray-700",children:Array.isArray(g.preferred_times)&&g.preferred_times.map(e=>{let[s,t]=e.split(":"),a=parseInt(s);return"".concat(a%12||12,":").concat(t||"00"," ").concat(a>=12?"PM":"AM")}).join(", ")})]})]}),(0,a.jsxs)("div",{className:"text-yellow-700 text-sm",children:[(0,a.jsx)(m.H33,{className:"inline-block mr-1"}),"Our sales team will review your preferred dates and times and confirm your appointment soon."]})]})})]}),"confirmed"===g.status&&!isPastDate(g.viewing_date)&&(0,a.jsx)("div",{className:"bg-green-50 p-4 rounded-lg mb-6",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(m._rq,{className:"h-5 w-5 text-green-500 mt-0.5 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-green-800",children:"Your viewing is confirmed"}),(0,a.jsx)("div",{className:"text-green-700 text-sm",children:"Please arrive on time. If you need to cancel or reschedule, please do so at least 24 hours in advance."})]})]})}),"cancelled"===g.status&&(0,a.jsx)("div",{className:"bg-red-50 p-4 rounded-lg mb-6",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(m.q5L,{className:"h-5 w-5 text-red-500 mt-0.5 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-red-800",children:"This viewing has been cancelled"}),(0,a.jsx)("div",{className:"text-red-700 text-sm",children:"If you'd like to schedule a new viewing, please visit the property page and request a new appointment."})]})]})}),g.notes&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Notes"}),(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,a.jsx)("p",{className:"text-gray-700",children:g.notes})})]})]})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Z,{children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-md font-semibold text-gray-900 mb-4",children:"Contact Information"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(m.tUt,{className:"h-5 w-5 text-gray-400 mt-0.5 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Sales Team"}),(0,a.jsx)("div",{className:"text-gray-600",children:"+20 123 456 7890"})]})]}),(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(m.Imn,{className:"h-5 w-5 text-gray-400 mt-0.5 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Email"}),(0,a.jsx)("div",{className:"text-gray-600",children:"viewings@bigdealegy.com"})]})]}),(0,a.jsx)("div",{className:"border-t border-gray-100 pt-4 mt-4",children:(0,a.jsx)(x.Z,{variant:"primary",fullWidth:!0,leftIcon:(0,a.jsx)(m.tUt,{}),children:"Call Sales Team"})})]})]})}),"confirmed"===g.status&&!isPastDate(g.viewing_date)&&(0,a.jsx)(o.Z,{className:"mt-6",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-md font-semibold text-gray-900 mb-4",children:"What to Bring"}),(0,a.jsxs)("ul",{className:"space-y-2 text-gray-700",children:[(0,a.jsxs)("li",{className:"flex items-start",children:[(0,a.jsx)(m.UgA,{className:"text-green-500 mr-2 mt-1"}),(0,a.jsx)("span",{children:"Photo ID (National ID or Passport)"})]}),(0,a.jsxs)("li",{className:"flex items-start",children:[(0,a.jsx)(m.UgA,{className:"text-green-500 mr-2 mt-1"}),(0,a.jsx)("span",{children:"List of questions you want to ask"})]}),(0,a.jsxs)("li",{className:"flex items-start",children:[(0,a.jsx)(m.UgA,{className:"text-green-500 mr-2 mt-1"}),(0,a.jsx)("span",{children:"Measuring tape if needed"})]}),(0,a.jsxs)("li",{className:"flex items-start",children:[(0,a.jsx)(m.UgA,{className:"text-green-500 mr-2 mt-1"}),(0,a.jsx)("span",{children:"Smartphone for taking photos/videos"})]})]})]})})]})]}),(0,a.jsx)(h.Z,{isOpen:N,onClose:()=>w(!1),viewingId:null==g?void 0:g.id,onSuccess:()=>{p({...g,status:"cancelled"}),w(!1)}})]})}},2595:function(e,s,t){"use strict";t.d(s,{Z:function(){return Card}});var a=t(7437);function Card(e){let{children:s,className:t="",padding:i="small",shadow:r="small",rounded:n="medium",border:l=!1,hover:c=!1,clickable:d=!1}=e;return(0,a.jsx)("div",{className:"\n        bg-white\n        ".concat({none:"p-0",xs:"p-2",small:"p-3",medium:"p-4",large:"p-5"}[i],"\n        ").concat({none:"",small:"shadow-sm",medium:"shadow",large:"shadow-lg"}[r],"\n        ").concat({none:"rounded-none",small:"rounded-md",medium:"rounded-lg",large:"rounded-xl"}[n],"\n        ").concat(l?"border border-gray-100":"","\n        ").concat(c?"transition-all duration-200 hover:shadow-md hover:translate-y-[-1px]":"","\n        ").concat(d?"cursor-pointer active:scale-[0.99] active:shadow-inner transition-transform":"","\n        ").concat(t,"\n      "),children:s})}t(2265)},907:function(e,s,t){"use strict";t.d(s,{Z:function(){return CancelViewingModal}});var a=t(7437),i=t(2265),r=t(8920),n=t(4734),l=t(5243),c=t(2749);function CancelViewingModal(e){let{isOpen:s,onClose:t,viewingId:d,onSuccess:m}=e,[o,x]=(0,i.useState)(!1),[h,u]=(0,i.useState)(null),[g,p]=(0,i.useState)(""),[j,f]=(0,i.useState)(!1),{session:v}=(0,l.a)(),handleCancel=async()=>{if(d&&(null==v?void 0:v.access_token)){x(!0),u(null);try{await c.ZP.cancelScheduledViewing(v.access_token,d,{cancellation_reason:g}),f(!0),setTimeout(()=>{m&&m()},2e3)}catch(e){console.error("Error cancelling viewing:",e),u("Failed to cancel viewing. Please try again.")}finally{x(!1)}}};return s?(0,a.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,a.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4 text-center sm:p-0",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t}),(0,a.jsxs)("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:[(0,a.jsxs)("div",{className:"bg-red-50 px-4 py-3 sm:px-6 flex justify-between items-center",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-red-900 flex items-center",children:[(0,a.jsx)(r.bcx,{className:"mr-2 h-5 w-5 text-red-600"}),"Cancel Viewing Appointment"]}),(0,a.jsx)("button",{type:"button",className:"text-gray-400 hover:text-gray-500",onClick:t,children:(0,a.jsx)(r.q5L,{className:"h-6 w-6"})})]}),(0,a.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:j?(0,a.jsxs)("div",{className:"text-center py-6",children:[(0,a.jsx)("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100",children:(0,a.jsx)(r.UgA,{className:"h-6 w-6 text-green-600"})}),(0,a.jsx)("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"Viewing Cancelled"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Your viewing appointment has been successfully cancelled. If you change your mind, you can always request a new viewing."})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Are you sure you want to cancel this viewing appointment? This action cannot be undone."}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason for cancellation (optional)"}),(0,a.jsx)("textarea",{id:"reason",className:"shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full sm:text-sm border-gray-300 rounded-md",placeholder:"Please let us know why you're cancelling...",rows:3,value:g,onChange:e=>p(e.target.value)})]}),h&&(0,a.jsx)("div",{className:"mt-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:h})]})}),(0,a.jsx)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:j?(0,a.jsx)(n.Z,{variant:"primary",onClick:t,children:"Done"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.Z,{variant:"danger",onClick:handleCancel,loading:o,children:o?"Cancelling...":"Confirm Cancellation"}),(0,a.jsx)(n.Z,{variant:"light",onClick:t,className:"mr-2",children:"Back"})]})})]})]})}):null}},4033:function(e,s,t){e.exports=t(94)}},function(e){e.O(0,[2438,8920,1907,2971,2472,1744],function(){return e(e.s=4083)}),_N_E=e.O()}]);